/**
 *  Copyright 2012 Alma Madsen
 *
 *  BetaCreator is Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
(function() {function i(a){throw a;}var j=void 0,m=!0,n=null,r=!1;function aa(){return function(){}}var s,t=this;function ba(a,b){var c=a.split("."),d=t;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==j?d[e]=b:d=d[e]?d[e]:d[e]={}}
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function da(a){return"array"==ca(a)}function u(a){return"string"==typeof a}function y(a){return"number"==typeof a}function ea(a){var b=typeof a;return"object"==b&&a!=n||"function"==b}function fa(a){return a[ga]||(a[ga]=++ha)}var ga="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ha=0;function ia(a,b,c){return a.call.apply(a.bind,arguments)}
function ja(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ka(a,b,c){ka=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja;return ka.apply(n,arguments)}
function la(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}function A(a,b){function c(){}c.prototype=b.prototype;a.Sb=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ma(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function na(a){if(!oa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(pa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(qa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(ra,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(sa,"&quot;"));return a}var pa=/&/g,qa=/</g,ra=/>/g,sa=/\"/g,oa=/[&<>\"]/;var ta,ua,va,wa,ya;function za(){return t.navigator?t.navigator.userAgent:n}function Aa(){return t.navigator}wa=va=ua=ta=r;var Ba;if(Ba=za()){var Ca=Aa();ta=0==Ba.indexOf("Opera");ua=!ta&&-1!=Ba.indexOf("MSIE");va=!ta&&-1!=Ba.indexOf("WebKit");wa=!ta&&!va&&"Gecko"==Ca.product}var Da=ta,B=ua,Ea=wa,C=va,Fa=Aa();ya=-1!=(Fa&&Fa.platform||"").indexOf("Mac");var Ga=!!Aa()&&-1!=(Aa().appVersion||"").indexOf("X11"),Ha;
a:{var Ia="",Ja;if(Da&&t.opera)var Ka=t.opera.version,Ia="function"==typeof Ka?Ka():Ka;else if(Ea?Ja=/rv\:([^\);]+)(\)|;)/:B?Ja=/MSIE\s+([^\);]+)(\)|;)/:C&&(Ja=/WebKit\/(\S+)/),Ja)var La=Ja.exec(za()),Ia=La?La[1]:"";if(B){var Ma,Na=t.document;Ma=Na?Na.documentMode:j;if(Ma>parseFloat(Ia)){Ha=String(Ma);break a}}Ha=Ia}var Oa={};
function D(a){var b;if(!(b=Oa[a])){b=0;for(var c=ma(String(Ha)).split("."),d=ma(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",k=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var p=k.exec(g)||["","",""],q=l.exec(h)||["","",""];if(0==p[0].length&&0==q[0].length)break;b=((0==p[1].length?0:parseInt(p[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==p[1].length?0:parseInt(p[1],10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==p[2].length)<
(0==q[2].length)?-1:(0==p[2].length)>(0==q[2].length)?1:0)||(p[2]<q[2]?-1:p[2]>q[2]?1:0)}while(0==b)}b=Oa[a]=0<=b}return b}var Pa={};function Qa(a){return Pa[a]||(Pa[a]=B&&!!document.documentMode&&document.documentMode>=a)};function Ra(a,b){for(var c in a)b.call(j,a[c],c,a)}var Sa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ta(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Sa.length;f++)c=Sa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var E=Array.prototype,Ua=E.indexOf?function(a,b,c){return E.indexOf.call(a,b,c)}:function(a,b,c){c=c==n?0:0>c?Math.max(0,a.length+c):c;if(u(a))return!u(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},F=E.forEach?function(a,b,c){E.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=u(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Va=E.filter?function(a,b,c){return E.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=u(a)?a.split(""):
a,h=0;h<d;h++)if(h in g){var k=g[h];b.call(c,k,h,a)&&(e[f++]=k)}return e},Wa=E.some?function(a,b,c){return E.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=u(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return m;return r};function Xa(a,b){var c=Ua(a,b);0<=c&&E.splice.call(a,c,1)}function Ya(a,b,c){return 2>=arguments.length?E.slice.call(a,b):E.slice.call(a,b,c)};function G(a,b){return Math.min(Math.max(a,0),b)};function H(a,b){this.x=a!==j?a:0;this.y=b!==j?b:0}H.prototype.clone=function(){return new H(this.x,this.y)};H.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Za(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};function $a(a,b){this.width=a;this.height=b}s=$a.prototype;s.clone=function(){return new $a(this.width,this.height)};s.toString=function(){return"("+this.width+" x "+this.height+")"};s.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};s.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};s.scale=function(a){this.width*=a;this.height*=a;return this};var ab;function bb(a){a=a.className;return u(a)&&a.match(/\S+/g)||[]}function cb(a,b){for(var c=bb(a),d=Ya(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Ua(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function db(a,b){var c=bb(a),d=Ya(arguments,1),c=Va(c,function(a){return!(0<=Ua(d,a))});a.className=c.join(" ")};var eb=!B||Qa(9),fb=!Ea&&!B||B&&Qa(9)||Ea&&D("1.9.1");B&&D("9");function gb(a){return a?new hb(ib(a)):ab||(ab=new hb)}function jb(a,b){Ra(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in kb?a.setAttribute(kb[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var kb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function lb(a,b,c){var d=arguments,e=document,f=d[0],g=d[1];if(!eb&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',na(g.name),'"');if(g.type){f.push(' type="',na(g.type),'"');var h={};Ta(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=e.createElement(f);g&&(u(g)?f.className=g:da(g)?cb.apply(n,[f].concat(g)):jb(f,g));if(2<d.length)for(var k=e,l=f,e=function(a){a&&l.appendChild(u(a)?k.createTextNode(a):a)},g=2;g<d.length;g++){var p=d[g],h=ca(p);if(("array"==h||"object"==h&&"number"==typeof p.length)&&
!(ea(p)&&0<p.nodeType)){var q;a:{if(p&&"number"==typeof p.length){if(ea(p)){q="function"==typeof p.item||"string"==typeof p.item;break a}if("function"==ca(p)){q="function"==typeof p.item;break a}}q=r}h=F;if(q)if(q=p.length,0<q){for(var v=Array(q),z=0;z<q;z++)v[z]=p[z];p=v}else p=[];h(p,e)}else e(p)}return f}function mb(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ib(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function nb(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(var c;c=a.firstChild;)a.removeChild(c);a.appendChild(ib(a).createTextNode(b))}}function hb(a){this.ua=a||t.document||document}hb.prototype.createElement=function(a){return this.ua.createElement(a)};hb.prototype.createTextNode=function(a){return this.ua.createTextNode(a)};hb.prototype.appendChild=function(a,b){a.appendChild(b)};function ob(a,b,c){a.style[String(c).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})]=b}function pb(a,b){var c;a:{c=ib(a);if(c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,n))){c=c[b]||c.getPropertyValue(b)||"";break a}c=""}return c||(a.currentStyle?a.currentStyle[b]:n)||a.style&&a.style[b]}
function qb(a){var b=a.getBoundingClientRect();B&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function rb(a){if(B&&!Qa(8))return a.offsetParent;for(var b=ib(a),c=pb(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=pb(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return n}
function sb(a){var b,c=ib(a),d=pb(a,"position"),e=Ea&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new H(0,0),g;b=c?ib(c):document;if(g=B)if(g=!Qa(9))g="CSS1Compat"!=gb(b).ua.compatMode;g=g?b.body:b.documentElement;if(a==g)return f;if(a.getBoundingClientRect)b=qb(a),c=gb(c).ua,a=!C&&"CSS1Compat"==c.compatMode?c.documentElement:c.body,c=c.parentWindow||c.defaultView,a=new H(c.pageXOffset||a.scrollLeft,c.pageYOffset||a.scrollTop),
f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(C&&"fixed"==pb(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Da||C&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=rb(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Da||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function tb(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function ub(a){if("none"!=pb(a,"display"))return vb(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=vb(a);b.display=c;b.position=e;b.visibility=d;return a}function vb(a){var b=a.offsetWidth,c=a.offsetHeight,d=C&&!b&&!c;return(b===j||d)&&a.getBoundingClientRect?(a=qb(a),new $a(a.right-a.left,a.bottom-a.top)):new $a(b,c)};function wb(){0!=xb&&(this.jc=Error().stack,fa(this))}var xb=0;function yb(){wb.call(this);this.Z=[];this.Za={}}A(yb,wb);yb.prototype.Kb=1;yb.prototype.Va=0;function zb(a,b,c){var d=a.Za[b];d||(d=a.Za[b]=[]);var e=a.Kb;a.Z[e]=b;a.Z[e+1]=c;a.Z[e+2]=j;a.Kb=e+3;d.push(e)}
yb.prototype.j=function(a,b){var c=this.Za[a];if(c){this.Va++;for(var d=Ya(arguments,1),e=0,f=c.length;e<f;e++){var g=c[e];this.Z[g+1].apply(this.Z[g+2],d)}this.Va--;if(this.Ta&&0==this.Va)for(;c=this.Ta.pop();)if(0!=this.Va)this.Ta||(this.Ta=[]),this.Ta.push(c);else if(d=this.Z[c])(d=this.Za[d])&&Xa(d,c),delete this.Z[c],delete this.Z[c+1],delete this.Z[c+2]}};function Ab(){}var Bb=0;s=Ab.prototype;s.key=0;s.ra=r;s.zb=r;s.R=function(a,b,c,d,e,f){"function"==ca(a)?this.Jb=m:a&&a.handleEvent&&"function"==ca(a.handleEvent)?this.Jb=r:i(Error("Invalid listener argument"));this.Pa=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.Hb=f;this.zb=r;this.key=++Bb;this.ra=r};s.handleEvent=function(a){return this.Jb?this.Pa.call(this.Hb||this.src,a):this.Pa.handleEvent.call(this.Pa,a)};!B||Qa(9);var Cb=!B||Qa(9),Db=B&&!D("9");!C||D("528");Ea&&D("1.9b")||B&&D("8")||Da&&D("9.5")||C&&D("528");Ea&&!D("8")||B&&D("9");function Eb(a,b){this.type=a;this.currentTarget=this.target=b}s=Eb.prototype;s.Ua=r;s.defaultPrevented=r;s.hc=m;s.stopPropagation=function(){this.Ua=m};s.preventDefault=function(){this.defaultPrevented=m;this.hc=r};function Fb(a){Fb[" "](a);return a}Fb[" "]=aa();function Gb(a,b){a&&this.R(a,b)}A(Gb,Eb);s=Gb.prototype;s.target=n;s.relatedTarget=n;s.offsetX=0;s.offsetY=0;s.clientX=0;s.clientY=0;s.screenX=0;s.screenY=0;s.button=0;s.keyCode=0;s.charCode=0;s.ctrlKey=r;s.altKey=r;s.shiftKey=r;s.metaKey=r;s.gc=r;s.va=n;
s.R=function(a,b){var c=this.type=a.type;Eb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ea){var e;a:{try{Fb(d.nodeName);e=m;break a}catch(f){}e=r}e||(d=n)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=C||a.offsetX!==j?a.offsetX:a.layerX;this.offsetY=C||a.offsetY!==j?a.offsetY:a.layerY;this.clientX=a.clientX!==j?a.clientX:a.pageX;this.clientY=a.clientY!==j?a.clientY:a.pageY;this.screenX=a.screenX||
0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.gc=ya?a.metaKey:a.ctrlKey;this.state=a.state;this.va=a;a.defaultPrevented&&this.preventDefault();delete this.Ua};s.stopPropagation=function(){Gb.Sb.stopPropagation.call(this);this.va.stopPropagation?this.va.stopPropagation():this.va.cancelBubble=m};
s.preventDefault=function(){Gb.Sb.preventDefault.call(this);var a=this.va;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,Db)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Hb={},Ib={},Jb={},Kb={};
function I(a,b,c,d,e){if(b){if(da(b)){for(var f=0;f<b.length;f++)I(a,b[f],c,d,e);return n}var d=!!d,g=Ib;b in g||(g[b]={W:0,ma:0});g=g[b];d in g||(g[d]={W:0,ma:0},g.W++);var g=g[d],h=fa(a),k;g.ma++;if(g[h]){k=g[h];for(f=0;f<k.length;f++)if(g=k[f],g.Pa==c&&g.Hb==e){if(g.ra)break;return k[f].key}}else k=g[h]=[],g.W++;var l=Lb,p=Cb?function(a){return l.call(p.src,p.key,a)}:function(a){a=l.call(p.src,p.key,a);if(!a)return a},f=p;f.src=a;g=new Ab;g.R(c,f,a,b,d,e);c=g.key;f.key=c;k.push(g);Hb[c]=g;Jb[h]||
(Jb[h]=[]);Jb[h].push(g);a.addEventListener?(a==t||!a.Zb)&&a.addEventListener(b,f,d):a.attachEvent(b in Kb?Kb[b]:Kb[b]="on"+b,f);return c}i(Error("Invalid event type"))}
function Mb(a){if(Hb[a]){var b=Hb[a];if(!b.ra){var c=b.src,d=b.type,e=b.proxy,f=b.capture;c.removeEventListener?(c==t||!c.Zb)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Kb?Kb[d]:Kb[d]="on"+d,e);c=fa(c);Jb[c]&&(e=Jb[c],Xa(e,b),0==e.length&&delete Jb[c]);b.ra=m;if(b=Ib[d][f][c])b.Mb=m,Nb(d,f,c,b);delete Hb[a]}}}
function Nb(a,b,c,d){if(!d.Qa&&d.Mb){for(var e=0,f=0;e<d.length;e++)d[e].ra?d[e].proxy.src=n:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Mb=r;0==f&&(delete Ib[a][b][c],Ib[a][b].W--,0==Ib[a][b].W&&(delete Ib[a][b],Ib[a].W--),0==Ib[a].W&&delete Ib[a])}}function Ob(a,b,c,d,e){var f=1,b=fa(b);if(a[b]){a.ma--;a=a[b];a.Qa?a.Qa++:a.Qa=1;try{for(var g=a.length,h=0;h<g;h++){var k=a[h];k&&!k.ra&&(f&=Pb(k,e)!==r)}}finally{a.Qa--,Nb(c,d,b,a)}}return Boolean(f)}
function Pb(a,b){a.zb&&Mb(a.key);return a.handleEvent(b)}
function Lb(a,b){if(!Hb[a])return m;var c=Hb[a],d=c.type,e=Ib;if(!(d in e))return m;var e=e[d],f,g;if(!Cb){var h;if(!(h=b))a:{h=["window","event"];for(var k=t;f=h.shift();)if(k[f]!=n)k=k[f];else{h=n;break a}h=k}f=h;h=m in e;k=r in e;if(h){if(0>f.keyCode||f.returnValue!=j)return m;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(p){l=m}if(l||f.returnValue==j)f.returnValue=m}}l=new Gb;l.R(f,this);f=m;try{if(h){for(var q=[],v=l.currentTarget;v;v=v.parentNode)q.push(v);g=e[m];g.ma=g.W;for(var z=
q.length-1;!l.Ua&&0<=z&&g.ma;z--)l.currentTarget=q[z],f&=Ob(g,q[z],d,m,l);if(k){g=e[r];g.ma=g.W;for(z=0;!l.Ua&&z<q.length&&g.ma;z++)l.currentTarget=q[z],f&=Ob(g,q[z],d,r,l)}}else f=Pb(c,l)}finally{q&&(q.length=0)}return f}d=new Gb(b,this);return f=Pb(c,d)};function Qb(a){if(a)return Rb[a]=m,a;a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)});return Rb[a]?Qb():Qb(a)}var Rb={};function Sb(a,b){a=a||{};this.id=Qb(a.id);this.d={};this.d[Tb]=n;this.d[J]=a.scale||b[J];this.d[K]=a.color||b[K];this.d[M]=a.alpha||b[M];this.d[Ub]=a.lineWidth||3;this.d[Vb]=a.x||0;this.d[Wb]=a.y||0;this.d[Xb]=a.f||18;this.d[Yb]=a.m||18;this.d[Zb]=a.text||"";this.type=N(this.d,Tb);this.scale=N(this.d,J);this.color=N(this.d,K);this.alpha=N(this.d,M);this.lineWidth=N(this.d,Ub);this.x=N(this.d,Vb);this.y=N(this.d,Wb);this.f=N(this.d,Xb);this.m=N(this.d,Yb);this.text=N(this.d,Zb);this.ba=[J,K,M,Vb,Wb,
Xb,Yb,Zb];this.offset=new H(0,0)}s=Sb.prototype;s.ab=function(){var a={};a[Vb]=this.x()+this.offset.x;a[Wb]=this.y()+this.offset.y;this.offset.x=0;this.offset.y=0;return a};s.qb=function(a){this.offset.x=a.x;this.offset.y=a.y};s.ob=function(){var a={},b;for(b in this.d)a[b]=this.d[b];return a};s.gb=function(){var a=this,b={};F(this.ba,function(c){b[c]=a.d[c]});return b};s.pb=function(a){var b=this;F(this.ba,function(c){a[c]!==j&&(b.d[c]=a[c])})};function $b(a,b){a=a||{};a.f||(a.f=10);a.m||(a.m=10);Sb.call(this,a,b);this.type(1)}A($b,Sb);$b.prototype.X=function(a,b){var c=this.scale(),d=this.f()*c,e=this.m()*c,c=this.lineWidth()*c/2+6;return ac(new H(a,b),new H(this.x()-d/2,this.y()-e/2),new H(this.x()+d/2,this.y()+e/2))<c||ac(new H(a,b),new H(this.x()+d/2,this.y()-e/2),new H(this.x()-d/2,this.y()+e/2))<c?m:r};function O(a,b){this.canvas=a;this.id=b}s=O.prototype;s.fa=aa();s.ia=aa();s.ja=aa();s.Ka=aa();s.wa=aa();function cc(a,b){O.call(this,a,b);this.A=n}A(cc,O);s=cc.prototype;s.za=function(){this.A=n};s.fa=function(a){var b=this,c=m;this.A&&this.ja(a);this.A=a;dc(this.canvas,function(d){if(d.X(a.x,a.y,b.canvas.selected==d.id))return b.canvas.selected=d.id,P.j(ec),P.j(Q),c=r,m});c&&(this.canvas.selected=n,P.j(ec),P.j(Q))};s.ia=function(a){var b=this;this.A&&(F(fc(this.canvas),function(c){c.qb(new H(a.x-b.A.x,a.y-b.A.y))}),P.j(Q))};
s.ja=function(a){var b=this;if(this.A){var c=a.x-this.A.x,d=a.y-this.A.y;(2<Math.abs(c)||2<Math.abs(d))&&F(fc(this.canvas),function(a){var f=a.ab(new H(c,d));f.id=a.id;R(b.canvas,new S(gc,f))})}this.A=n};
s.Ka=function(a){var b=this;dc(this.canvas,function(c){if(0==c.type()&&c.X(a.x,a.y,b.canvas.selected==c.id))return P.j(T,hc),m;if(4==c.type()&&c.X(a.x,a.y,b.canvas.selected==c.id)){var d=prompt(U("Enter text for the belay:"),c.text());if(d!==n&&d!=c.text()){var e={id:c.id};e[Zb]=d;R(b.canvas,new S(gc,e))}return m}if(5==c.type()&&c.X(a.x,a.y,b.canvas.selected==c.id))return P.j(ic,function(a){if(a!==n&&a!=c.text()){var d={id:c.id};d[Zb]=a;R(b.canvas,new S(gc,d))}},c.text()),m})};function jc(a,b){a=a||{};a.f||(a.f=12);a.m||(a.m=12);Sb.call(this,a,b);this.type(2)}A(jc,Sb);jc.prototype.X=function(a,b){var c=this.lineWidth()*this.scale()/2+1,d=this.f()*this.scale(),e=this.m()*this.scale();if(Math.abs(a-this.x())>d/2+c||Math.abs(b-this.y())>e/2+c)return r;d=this.x()-0.1*d;e=this.y()+0.1*e;return a<d-c||a>d+c&&b>e+c?r:m};function kc(a,b,c,d){this.x=a;this.y=b;this.f=c;this.m=d}function lc(a,b,c,d){if(2==arguments.length)return Math.sqrt(a*a+b*b);var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)}function mc(a,b,c,d,e,f,g){for(var h=0,k=a,l=b,p,q,v,z,g=g||6,w=1;w<=g;w++)p=w/g,v=1-p,q=v*v,v*=2*p,z=p*p,p=q*a+v*c+z*e,q=q*b+v*d+z*f,h+=lc(k,l,p,q),k=p,l=q;return h}function nc(a,b,c,d,e,f,g,h){if(0==g)return oc(a,b,c,d,e,f,h);if(1==h)return pc(a,b,c,d,e,f,g);a=oc(a,b,c,d,e,f,h);a.push(g/h);return pc.apply(n,a)}
function oc(a,b,c,d,e,f,g){g=g||1;1!=g&&(e=c+(e-c)*g,f=d+(f-d)*g,c=a+(c-a)*g,d=b+(d-b)*g,e=c+(e-c)*g,f=d+(f-d)*g);return[a,b,c,d,e,f]}function pc(a,b,c,d,e,f,g){g=g||1;1!=g&&(a+=(c-a)*g,b+=(d-b)*g,c+=(e-c)*g,d+=(f-d)*g,a+=(c-a)*g,b+=(d-b)*g);return[a,b,c,d,e,f]}
function ac(a,b,c){var d=(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y),e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d,d=Math.abs(((b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y))/d)*Math.sqrt(d);0<=e&&1>=e?a=d:(b=(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y),a=(a.x-c.x)*(a.x-c.x)+(a.y-c.y)*(a.y-c.y),a=b<a?Math.sqrt(b):Math.sqrt(a));return a};function qc(a,b,c){this.ha=a;this.Xb=6;this.o=m;this.Ja=this.z=this.t=this.overflow=0;this.n=n;this.z=b;this.t=c;this.Ja=this.z+this.t;this.o=m;this.overflow=0;this.n={x:0,y:0}}s=qc.prototype;s.moveTo=function(a,b){V(this,a,b)};
s.lineTo=function(a,b){var c=a-this.n.x,d=b-this.n.y,e=Math.atan2(d,c),f=Math.cos(e),e=Math.sin(e),c=lc(0,0,c,d);if(this.overflow){if(this.overflow>c){this.o?rc(this,a,b):V(this,a,b);this.overflow-=c;return}this.o?rc(this,this.n.x+f*this.overflow,this.n.y+e*this.overflow):V(this,this.n.x+f*this.overflow,this.n.y+e*this.overflow);c-=this.overflow;this.overflow=0;this.o=!this.o;if(!c)return}if(d=Math.floor(c/this.Ja)){for(var g=f*this.z,h=e*this.z,k=f*this.t,l=e*this.t,p=0;p<d;p++)this.o?(rc(this,this.n.x+
g,this.n.y+h),V(this,this.n.x+k,this.n.y+l)):(V(this,this.n.x+k,this.n.y+l),rc(this,this.n.x+g,this.n.y+h));c-=this.Ja*d}this.o?c>this.z?(rc(this,this.n.x+f*this.z,this.n.y+e*this.z),V(this,a,b),this.overflow=this.t-(c-this.z),this.o=r):(rc(this,a,b),c==this.z?(this.overflow=0,this.o=!this.o):(this.overflow=this.z-c,V(this,a,b))):c>this.t?(V(this,this.n.x+f*this.t,this.n.y+e*this.t),rc(this,a,b),this.overflow=this.z-(c-this.t),this.o=m):(V(this,a,b),c==this.t?(this.overflow=0,this.o=!this.o):this.overflow=
this.t-c)};
s.quadraticCurveTo=function(a,b,c,d){var e=this.n.x,f=this.n.y,g=mc(e,f,a,b,c,d,this.Xb),h=0,k=0,l;if(this.overflow){if(this.overflow>g){this.o?sc(this,a,b,c,d):V(this,c,d);this.overflow-=g;return}h=this.overflow/g;l=oc(e,f,a,b,c,d,h);this.o?sc(this,l[2],l[3],l[4],l[5]):V(this,l[4],l[5]);this.overflow=0;this.o=!this.o;if(!g)return}var p;p=Math.floor((g-g*h)/this.Ja);var q=this.z/g,v=this.t/g;if(p)for(var z=0;z<p;z++)this.o?(k=h+q,l=nc(e,f,a,b,c,d,h,k),sc(this,l[2],l[3],l[4],l[5]),h=k,k=h+v,l=nc(e,
f,a,b,c,d,h,k),V(this,l[4],l[5])):(k=h+v,l=nc(e,f,a,b,c,d,h,k),V(this,l[4],l[5]),h=k,k=h+q,l=nc(e,f,a,b,c,d,h,k),sc(this,l[2],l[3],l[4],l[5])),h=k;p=g-g*h;this.o?p>this.z?(l=nc(e,f,a,b,c,d,h,h+q),sc(this,l[2],l[3],l[4],l[5]),V(this,c,d),this.overflow=this.t-(p-this.z),this.o=r):(l=pc(e,f,a,b,c,d,h),sc(this,l[2],l[3],l[4],l[5]),g==this.z?(this.overflow=0,this.o=!this.o):(this.overflow=this.z-p,V(this,c,d))):p>this.t?(k=h+v,l=nc(e,f,a,b,c,d,h,k),V(this,l[4],l[5]),l=pc(e,f,a,b,c,d,k),sc(this,l[2],l[3],
l[4],l[5]),this.overflow=this.z-(p-this.t),this.o=m):(V(this,c,d),p==this.t?(this.overflow=0,this.o=!this.o):this.overflow=this.t-p)};s.beginPath=function(){this.ha.beginPath()};s.stroke=function(){this.ha.stroke()};s.clearRect=function(a,b,c,d){this.ha.clearRect(a,b,c,d)};s.ta=function(){this.n=this.ha=n};function V(a,b,c){a.n={x:b,y:c};a.ha.moveTo(b,c)}function rc(a,b,c){b==a.n.x&&c==a.n.y||(a.n={x:b,y:c},a.ha.lineTo(b,c))}
function sc(a,b,c,d,e){b==d&&c==e&&d==a.n.x&&e==a.n.y||(a.n={x:d,y:e},a.ha.quadraticCurveTo(b,c,d,e))};function tc(a,b){if(a==n)return n;b==n&&(b=0);if(100<b)return n;var c={};if("object"==typeof a){"undefined"!=typeof a.length&&(c=[]);for(var d in a){var e=typeof a[d];"object"==e?c[d]=a[d]instanceof HTMLElement?a[d]:tc(a[d],b+1):"string"==e?c[d]=a[d]:"number"==e?c[d]=a[d]:"function"==e?c[d]=a[d]:"boolean"==e?a[d]==m?c[d]=m:c[d]=r:"undefined"==e&&(c[d]=j)}}return c}
function uc(a,b){if("object"==typeof a&&"object"==typeof b){if(a==n&&b==n)return m;if(da(a)&&da(b)){if(a.length!=b.length)return r;for(var c=0;c<a.length;c++)if(!uc(a[c],b[c]))return r;return m}if(ea(a)&&ea(b)){for(c in a)if(!(c in(a.__proto__||a.constructor)||"__proto__"==c))if(!(c in b)||!uc(a[c],b[c]))return r;for(c in b)if(!(c in(b.__proto__||b.constructor)||"__proto__"==c)&&!(c in a))return r;return m}return r}return y(a)&&y(b)?1E-9>Math.abs(a-b):a==n&&b==n?m:a===b};function vc(a,b){a=a||{};this.id=Qb(a.id);this.d={};this.d[Tb]=0;this.d[J]=a.scale||b[J];this.d[K]=a.color||b[K];this.d[M]=a.alpha||b[M];this.d[Ub]=a.lineWidth||3;this.d[wc]=a.w||[];this.d[xc]=a.z||b[xc];this.d[W]=y(a.t)?a.t:b[W];this.d[yc]=a.eb||b[yc];this.type=N(this.d,Tb);this.scale=N(this.d,J);this.color=N(this.d,K);this.alpha=N(this.d,M);this.lineWidth=N(this.d,Ub);this.w=N(this.d,wc);this.z=N(this.d,xc);this.t=N(this.d,W);this.eb=N(this.d,yc);this.ba=[J,K,M,Ub,wc,xc,W,yc];this.offset=new H(0,
0);this.ga=[];zc(this)}function Ac(a,b,c,d,e,f){var g=[],h=mc(a,b,c,d,e,f),k=0,l=0,p=Math.floor(h/10),h=10/h;if(p){for(var q=0;q<p;q++)l=k+h,k=nc(a,b,c,d,e,f,k,l),g.push(new H(k[4],k[5])),k=l;g.push(new H(e,f))}return g}s=vc.prototype;s.ab=function(){var a=this,b=[],c={};F(this.w(),function(c){b.push(new H(c.x+a.offset.x,c.y+a.offset.y))});this.offset.x=0;this.offset.y=0;c[wc]=b;return c};s.qb=function(a){this.offset=a};
s.ob=function(){var a={},b;for(b in this.d)a[b]=this.d[b];var c=[];a[wc]&&da(a[wc])&&(F(a[wc],function(a){c.push({x:a.x,y:a.y})}),a[wc]=c);return a};s.gb=function(){var a=this,b={};F(this.ba,function(c){b[c]=a.d[c]});return b};s.pb=function(a){var b=this;F(this.ba,function(c){a[c]!==j&&(b.d[c]=a[c])})};s.X=function(a,b){for(var c=this.ga,d=this.lineWidth()*this.scale()/2+6,e=0,f=c.length-1;e<f;e++)if(ac(new H(a,b),c[e],c[e+1])<d)return m;return r};
function zc(a){var b=[];if(a.eb()){var c=a.w(),d=c.length;F(c,function(a,f){if(0===f)b.push(new H(a.x,a.y));else{var g=c[f-1];1==f?b.push(new H((a.x+g.x)/2,(a.y+g.y)/2)):b=b.concat(Ac(b[b.length-1].x,b[b.length-1].y,g.x,g.y,(a.x+g.x)/2,(a.y+g.y)/2));f==d-1&&b.push(new H(a.x,a.y))}})}else F(a.w(),function(a){b.push(new H(a.x,a.y))});a.ga=b};function Bc(a,b,c){O.call(this,a,b);this.ga=[];this.u=this.xa=n;this.$=c}A(Bc,O);Bc.prototype.fa=function(a){this.u&&this.u.w(Cc(this));this.ga.push(new H(a.x,a.y));this.u?(a={id:this.u.id},a[wc]=Cc(this),R(this.canvas,new S(gc,a))):1<this.ga.length?(this.$.w([new H(0,0)]),a=new S(Dc,{w:Cc(this)}),R(this.canvas,a),this.u=this.canvas.getItem(a.p.id)):(this.xa=new H(a.x,a.y),this.$.w(Cc(this,this.xa)),this.$.z(this.canvas.d[xc]),this.$.t(this.canvas.d[W]),P.j(Q))};
Bc.prototype.ia=function(a){var b=this.u||this.$;b&&(this.xa=new H(a.x,a.y),b.w(Cc(this,this.xa)),zc(b),P.j(Q))};Bc.prototype.wa=function(a){if(a.keyCode==Ec&&this.u)return this.za(),m};Bc.prototype.za=function(){this.u&&(this.u.w(Cc(this)),zc(this.u),P.j(Q));this.ga=[];this.u=this.xa=n;this.$.w([new H(0,0)])};function Cc(a,b){return b?a.ga.concat([b]):a.ga.concat([])};function Fc(a,b){a=a||{};a.lineWidth||(a.lineWidth=2);Sb.call(this,a,b);this.type(4)}A(Fc,Sb);Fc.prototype.X=function(a,b){var c=this.lineWidth()*this.scale()/2+1;return Za(new H(a,b),new H(this.x(),this.y()))<=this.f()*this.scale()/2+c?m:r};function Gc(a,b){a=a||{};this.id=Qb(a.id);this.d={};this.d[Tb]=5;this.d[J]=a.scale||b[J];this.d[K]=a.color||b[K];this.d[M]=a.alpha||b[M];this.d[Vb]=a.x||0;this.d[Wb]=a.y||0;this.d[Zb]=a.text||"";this.d[Hc]=a.textAlign||b[Hc];this.d[Ic]=a.na||b[Ic];this.type=N(this.d,Tb);this.scale=N(this.d,J);this.color=N(this.d,K);this.alpha=N(this.d,M);this.x=N(this.d,Vb);this.y=N(this.d,Wb);this.text=N(this.d,Zb);this.textAlign=N(this.d,Hc);this.na=N(this.d,Ic);this.ba=[J,K,M,Vb,Wb,Zb,Hc,Ic];this.offset=new H(0,
0);this.H=n;this.wb=0;this.C=[]}s=Gc.prototype;s.ab=function(){var a={};a[Vb]=this.x()+this.offset.x;a[Wb]=this.y()+this.offset.y;this.offset.x=0;this.offset.y=0;return a};s.qb=function(a){this.offset.x=a.x;this.offset.y=a.y};s.ob=function(){var a={},b;for(b in this.d)a[b]=this.d[b];return a};s.gb=function(){var a=this,b={};F(this.ba,function(c){b[c]=a.d[c]});return b};s.pb=function(a){var b=this;F(this.ba,function(c){a[c]!==j&&(b.d[c]=a[c])})};
s.X=function(a,b,c){if(!this.H)return r;var d=this.scale(),e=this.textAlign(),f=new kc(this.x(),this.y(),this.H.x*this.scale(),this.H.y*this.scale()),g=this.na()||c?this.wb:0;"c"==e?f.x-=f.f/2:"r"==e&&(f.x-=f.f);if(Math.abs(a-f.x-f.f/2)>f.f/2+g||Math.abs(b-f.y-f.m/2)>f.m/2+g)return r;if(this.na()||c)return m;for(var g=c=0,h=this.C.length;g<h;g++)if(c=this.C[g].width*d,-1<c&&a>=f.x+("c"==e?f.f/2-c/2:"r"==e?f.f-c:0)&&a<=f.x+("c"==e?f.f/2+c/2:"r"==e?f.f:c)&&b>=f.y+this.C[g].top*d&&b<=f.y+(g+1<h?this.C[g+
1].top:this.C[g].top+this.C[g].size)*d)return m;return r};var Dc=2,gc=4;function S(a,b){this.type=a;this.p=b;this.lb=n;this.jb=this.ib=r}S.prototype.copy=function(){return new S(this.type,tc(this.p))};function Jc(a){var b=a.copy();switch(a.type){case 1:b.type=5;break;case Dc:b.type=6;break;case 3:b.type=7;break;case gc:b.p=tc(a.lb);break;case 5:b.type=1;break;case 6:b.type=Dc;break;case 7:b.type=3;break;default:return n}return b};function Kc(a,b){O.call(this,a,b);this.ka=this.O=this.u=this.A=n}A(Kc,O);s=Kc.prototype;s.mb=function(){var a=this;Wa(fc(this.canvas),function(b){return 0==b.type()?(a.u=b,P.j(Q),m):r})};s.za=function(){this.ka=this.O=this.u=this.A=n;P.j(Q)};s.fa=function(a){this.A&&this.ja(a);if(this.u){var b=this;Wa(this.u.w(),function(c){var d=a.x-c.x,e=a.y-c.y;return 100>d*d+e*e?(b.O=c,b.ka=c.clone(),m):r});this.O?this.A=a:P.j(T,Lc)}};
s.ia=function(a){this.A&&(this.u&&this.O)&&(this.O.x=this.ka.x+a.x-this.A.x,this.O.y=this.ka.y+a.y-this.A.y,zc(this.u),P.j(Q))};s.ja=function(a){this.ia(a);if(this.A&&this.u&&this.O){var b=[];F(this.u.w(),function(a){b.push(a.clone())});this.O.x=this.ka.x;this.O.y=this.ka.y;a={id:this.u.id};a[wc]=b;R(this.canvas,new S(gc,a))}this.ka=this.O=this.A=n};s.wa=function(a){if(a.keyCode==Ec)return P.j(T,Lc),m};function Mc(a,b){O.call(this,a,b);this.pa=n}A(Mc,O);Mc.prototype.mb=function(a){this.pa=y(a)?a:n};Mc.prototype.fa=function(a){this.pa!==n&&R(this.canvas,new S(1,{type:this.pa,x:a.x,y:a.y}))};function Nc(a,b){O.call(this,a,b)}A(Nc,O);Nc.prototype.fa=function(a){var b=this;P.j(ic,function(c){c&&R(b.canvas,new S(3,{text:c,x:a.x,y:a.y}))},U("Enter some text"))};function Oc(a,b){a=a||{};a.lineWidth||(a.lineWidth=2);Sb.call(this,a,b);this.type(3)}A(Oc,Sb);Oc.prototype.X=function(a,b){var c=this.lineWidth()*this.scale()/2+1;return Za(new H(a,b),new H(this.x(),this.y()))<=this.f()*this.scale()/2+c?m:r};var Pc=n;function Qc(a,b){var c=Pc;if(c){var d=fc(c);0<d.length?F(d,function(d){d.d[a]!==j&&(d={id:d.id},d[a]=b,R(c,new S(gc,d)))}):c.d[a]=b}}function Rc(a){Pc&&(Pc.Ea++,F(a,function(a){Qc(a[0],a[1])}),Sc(Pc))}function X(a){var b=Pc;if(b){var c=fc(b),d;0<c.length?Wa(c,function(b){return b.d[a]!==j?(d=b.d[a],m):r}):d=b.d[a];return d}}function N(a,b){return function(c){c!==j&&a[b]!==j&&(a[b]=c);return a[b]}}
var Tb="it",K="ic",J="is",M="ia",Ub="lw",Vb="x",Wb="y",Xb="w",Yb="h",Hc="ta",wc="cp",yc="lc",W="fl",xc="nl",Zb="t",Ic="tb";function Tc(a,b){var c=this;this.oa=a;this.$b=b;this.m=b.height;this.f=b.width;this.J=[];this.d={};this.d[J]=1;this.d[K]="#ffff00";this.d[M]=1;this.d[xc]=10;this.d[W]=10;this.d[yc]=r;this.d[Hc]="l";this.d[Ic]=r;this.selected=n;Pc=this;this.$=new vc({w:[new H(0,0)]},this.d);this.J.push(this.$);this.ea={};this.ea[Lc]=new cc(this,Lc);this.ea[Uc]=new Bc(this,Uc,this.$);this.ea[Vc]=new Mc(this,Vc);this.ea[Wc]=new Nc(this,Wc);this.ea[hc]=new Kc(this,hc);var d=n;zb(P,T,function(a,b){if(c.ea[a]){var g=c.mode!=
c.ea[a]||d!=b;g&&(c.mode&&c.mode.za)&&c.mode.za();c.mode=c.ea[a];g&&c.mode.mb&&c.mode.mb(b);d=b}});this.mode=n;this.Fa=[];this.Aa=[];this.Ea=0;this.$a=[];setInterval(function(){Sc(c)},100)}s=Tc.prototype;s.removeItem=function(a){Xa(this.J,a)};function Xc(a,b){var c=b.clientX,d=b.clientY,e=sb(a.oa.La.viewport);return new H(c-e.x,d-e.y)}function Sc(a){a.Ea=Math.max(0,a.Ea-1);0==a.Ea&&0<a.$a.length&&(a.Fa.unshift(a.$a),a.Aa=[],a.$a=[])}
function Yc(a){if(0!==a.Aa.length){var b=[];F(a.Aa[0],function(c){c=Jc(c);c!=n&&(c.ib=m,c.jb=r,b.unshift(c),R(a,c))});a.Aa.shift();a.Fa.unshift(b)}}
function R(a,b){var c;switch(b.type){case 1:switch(b.p.type){case 1:c=new $b(b.p,a.d);break;case 2:c=new jc(b.p,a.d);break;case 3:c=new Oc(b.p,a.d);break;case 4:c=new Fc(b.p,a.d)}if(c)b.p.id=c.id,a.J.push(c);else return;break;case Dc:if(b.p.w&&1<b.p.w.length)c=new vc(b.p,a.d),b.p.id=c.id,a.J.push(c);else return;break;case 3:if(b.p.text)c=new Gc(b.p,a.d),b.p.id=c.id,a.J.push(c);else return;break;case gc:if(c=a.getItem(b.p.id)){if(!b.lb){var d=c.gb(),e={id:b.p.id},f;for(f in b.p)d[f]!==j&&(e[f]=d[f]);
b.lb=e}c.pb(b.p)}else return;break;case 5:case 7:case 6:if(c=a.getItem(b.p.id))a.removeItem(c);else return;break;default:return}a.Ea++;!b.jb&&!b.ib&&a.$a.unshift(b);Sc(a);P.j(Q);P.j(Zc)}function fc(a){return!a.selected?[]:(a=a.getItem(a.selected))?[a]:[]}s.getItem=function(a){var b=this.J,c;a:{c=function(b){return b.id==a};for(var d=b.length,e=u(b)?b.split(""):b,f=0;f<d;f++)if(f in e&&c.call(j,e[f])){c=f;break a}c=-1}return 0>c?n:u(b)?b.charAt(c):b[c]};
function dc(a,b){for(var c=a.J.length-1;0<=c&&b(a.J[c])!==m;c--);}s.fa=function(a){this.mode.fa(Xc(this,a))};s.ia=function(a){this.mode.ia(Xc(this,a))};s.ja=function(a){this.mode.ja(Xc(this,a))};s.Ka=function(a){this.mode.Ka(Xc(this,a))};s.wa=function(a){return this.mode.wa(a)};function Y(a){if(u(a)){var b=lb("SPAN");nb(b,a);return b}a.q=a.q||"DIV";var c=lb(a.q),d={id:a.id,"class":a.e,type:a.type,src:a.src,href:a.href,title:a.title,name:a.name,target:a.target,checked:a.checked,value:a.value},e={},f=r;for(b in d)d[b]!==j&&(e[b]=d[b],f=m);if(a.attr)for(b in a.attr)e[b]=a.attr[b],f=m;f&&jb(c,e);a.html&&(c.innerHTML=a.html);a.text&&nb(c,a.text);if(a.css)for(b in a.css)c.style[b]=a.css[b];if(a.children)for(b=0;b<a.children.length;b++)a.children[b]&&(d=Y(a.children[b]),c.appendChild(d));
a.create&&a.create(c);a.click&&I(c,"click",function(b){a.click(b,c)});a.change&&I(c,"change",function(b){a.change(b,c)});return c};var $c;$c=function(){return m};/*
 Portions of this code are from the Dojo Toolkit, received by
 The Closure Library Authors under the BSD license. All other code is
 Copyright 2005-2009 The Closure Library Authors. All Rights Reserved.

The "New" BSD License:

Copyright (c) 2005-2009, The Dojo Foundation
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

 Redistributions of source code must retain the above copyright notice, this
    list of conditions and the following disclaimer.
 Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.
 Neither the name of the Dojo Foundation nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
function ad(a,b){var c=b||[];a&&c.push(a);return c}var bd=C&&"BackCompat"==document.compatMode,cd=document.firstChild.children?"children":"childNodes",dd=r;
function ed(a){function b(){0<=l&&(x.id=c(l,w).replace(/\\/g,""),l=-1);if(0<=p){var a=p==w?n:c(p,w);0>">~+".indexOf(a)?x.q=a:x.Sa=a;p=-1}0<=k&&(x.e.push(c(k+1,w).replace(/\\/g,"")),k=-1)}function c(b,c){return ma(a.slice(b,c))}for(var a=0<=">~+".indexOf(a.slice(-1))?a+" * ":a+" ",d=[],e=-1,f=-1,g=-1,h=-1,k=-1,l=-1,p=-1,q="",v="",z,w=0,xa=a.length,x=n,L=n;q=v,v=a.charAt(w),w<xa;w++)if("\\"!=q)if(x||(z=w,x={qa:n,la:[],Ia:[],e:[],q:n,Sa:n,id:n,hb:function(){return dd?this.fc:this.q}},p=w),0<=e)if("]"==
v){L.attr?L.kb=c(g||e+1,w):L.attr=c(e+1,w);if((e=L.kb)&&('"'==e.charAt(0)||"'"==e.charAt(0)))L.kb=e.slice(1,-1);x.Ia.push(L);L=n;e=g=-1}else"="==v&&(g=0<="|~^$*".indexOf(q)?q:"",L.type=g+v,L.attr=c(e+1,w-g.length),g=w+1);else 0<=f?")"==v&&(0<=h&&(L.value=c(f+1,w)),h=f=-1):"#"==v?(b(),l=w+1):"."==v?(b(),k=w):":"==v?(b(),h=w):"["==v?(b(),e=w,L={}):"("==v?(0<=h&&(L={name:c(h+1,w),value:n},x.la.push(L)),f=w):" "==v&&q!=v&&(b(),0<=h&&x.la.push({name:c(h+1,w)}),x.Lb=x.la.length||x.Ia.length||x.e.length,
x.lc=x.qa=c(z,w),x.fc=x.q=x.Sa?n:x.q||"*",x.q&&(x.q=x.q.toUpperCase()),d.length&&d[d.length-1].Sa&&(x.Ib=d.pop(),x.qa=x.Ib.qa+" "+x.qa),d.push(x),x=n);return d}function fd(a,b){return!a?b:!b?a:function(){return a.apply(window,arguments)&&b.apply(window,arguments)}}function gd(a){return 1==a.nodeType}function hd(a,b){return!a?"":"class"==b?a.className||"":"for"==b?a.htmlFor||"":"style"==b?a.style.cssText||"":(dd?a.getAttribute(b):a.getAttribute(b,2))||""}
var id={"*=":function(a,b){return function(c){return 0<=hd(c,a).indexOf(b)}},"^=":function(a,b){return function(c){return 0==hd(c,a).indexOf(b)}},"$=":function(a,b){return function(c){c=" "+hd(c,a);return c.lastIndexOf(b)==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+hd(b,a)+" ").indexOf(c)}},"|=":function(a,b){b=" "+b;return function(c){c=" "+hd(c,a);return c==b||0==c.indexOf(b+"-")}},"=":function(a,b){return function(c){return hd(c,a)==b}}},jd="undefined"==
typeof document.firstChild.nextElementSibling,kd=!jd?"nextElementSibling":"nextSibling",ld=!jd?"previousElementSibling":"previousSibling",md=jd?gd:$c;function nd(a){for(;a=a[ld];)if(md(a))return r;return m}function od(a){for(;a=a[kd];)if(md(a))return r;return m}function pd(a){var b=a.parentNode,c=0,d=b[cd],e=a._i||-1,f=b._l||-1;if(!d)return-1;d=d.length;if(f==d&&0<=e&&0<=f)return e;b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[kd])md(b)&&(b._i=++c,a===b&&(e=c));return e}
function qd(a){return!(pd(a)%2)}function rd(a){return pd(a)%2}
var td={checked:function(){return function(a){return a.checked||a.attributes.checked}},"first-child":function(){return nd},"last-child":function(){return od},"only-child":function(){return function(a){return!nd(a)||!od(a)?r:m}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;0<=a;a--){var c=b[a].nodeType;if(1===c||3==c)return r}return m}},contains:function(a,b){var c=b.charAt(0);if('"'==c||"'"==c)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},
not:function(a,b){var c=ed(b)[0],d={P:1};"*"!=c.q&&(d.q=1);c.e.length||(d.e=1);var e=sd(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){if("odd"==b)return rd;if("even"==b)return qd;if(-1!=b.indexOf("n")){var c=b.split("n",2),d=c[0]?"-"==c[0]?-1:parseInt(c[0],10):1,e=c[1]?parseInt(c[1],10):0,f=0,g=-1;0<d?0>e?e=e%d&&d+e%d:0<e&&(e>=d&&(f=e-e%d),e%=d):0>d&&(d*=-1,0<e&&(g=e,e%=d));if(0<d)return function(a){a=pd(a);return a>=f&&(0>g||a<=g)&&a%d==e};b=e}var h=parseInt(b,10);return function(a){return pd(a)==
h}}},ud=B?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return dd?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}};
function sd(a,b){if(!a)return $c;var b=b||{},c=n;b.P||(c=fd(c,gd));b.q||"*"!=a.q&&(c=fd(c,function(b){return b&&b.tagName==a.hb()}));b.e||F(a.e,function(a,b){var f=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");c=fd(c,function(a){return f.test(a.className)});c.count=b});b.la||F(a.la,function(a){var b=a.name;td[b]&&(c=fd(c,td[b](b,a.value)))});b.Ia||F(a.Ia,function(a){var b,f=a.attr;a.type&&id[a.type]?b=id[a.type](f,a.kb):f.length&&(b=ud(f));b&&(c=fd(c,b))});b.id||a.id&&(c=fd(c,function(b){return!!b&&b.id==a.id}));
c||"default"in b||(c=$c);return c}var vd={};
function wd(a){var b=vd[a.qa];if(b)return b;var c=a.Ib,c=c?c.Sa:"",d=sd(a,{P:1}),e="*"==a.q,f=document.getElementsByClassName;if(c)if(f={P:1},e&&(f.q=1),d=sd(a,f),"+"==c)var g=d,b=function(a,b,c){for(;a=a[kd];)if(!jd||gd(a)){(!c||xd(a,c))&&g(a)&&b.push(a);break}return b};else if("~"==c)var h=d,b=function(a,b,c){for(a=a[kd];a;){if(md(a)){if(c&&!xd(a,c))break;h(a)&&b.push(a)}a=a[kd]}return b};else{if(">"==c)var k=d,k=k||$c,b=function(a,b,c){for(var d=0,f=a[cd];a=f[d++];)md(a)&&((!c||xd(a,c))&&k(a,d))&&
b.push(a);return b}}else if(a.id)d=!a.Lb&&e?$c:sd(a,{P:1,id:1}),b=function(b,c){var f;f=gb(b);var e=a.id;if(e=(f=u(e)?f.ua.getElementById(e):e)&&d(f))if(!(e=9==b.nodeType)){for(e=f.parentNode;e&&e!=b;)e=e.parentNode;e=!!e}if(e)return ad(f,c)};else if(f&&/\{\s*\[native code\]\s*\}/.test(String(f))&&a.e.length&&!bd)var d=sd(a,{P:1,e:1,id:1}),l=a.e.join(" "),b=function(a,b){for(var c=ad(0,b),f,e=0,g=a.getElementsByClassName(l);f=g[e++];)d(f,a)&&c.push(f);return c};else!e&&!a.Lb?b=function(b,c){for(var d=
ad(0,c),f,e=0,g=b.getElementsByTagName(a.hb());f=g[e++];)d.push(f);return d}:(d=sd(a,{P:1,q:1,id:1}),b=function(b,c){for(var f=ad(0,c),e,g=0,h=b.getElementsByTagName(a.hb());e=h[g++];)d(e,b)&&f.push(e);return f});return vd[a.qa]=b}var yd={},zd={};
function Ad(a){var b=ed(ma(a));if(1==b.length){var c=wd(b[0]);return function(a){if(a=c(a,[]))a.Ra=m;return a}}return function(a){for(var a=ad(a),c,f,g=b.length,h,k,l=0;l<g;l++){k=[];c=b[l];f=a.length-1;0<f&&(h={},k.Ra=m);f=wd(c);for(var p=0;c=a[p];p++)f(c,k,h);if(!k.length)break;a=k}return k}}var Bd=!!document.querySelectorAll&&(!C||D("526"));
function Cd(a,b){if(Bd){var c=zd[a];if(c&&!b)return c}if(c=yd[a])return c;var c=a.charAt(0),d=-1==a.indexOf(" ");0<=a.indexOf("#")&&d&&(b=m);if(Bd&&!b&&-1==">~+".indexOf(c)&&(!B||-1==a.indexOf(":"))&&!(bd&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf("|=")){var e=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return zd[a]=function(b){try{9==b.nodeType||d||i("");var c=b.querySelectorAll(e);B?c.Yb=m:c.Ra=m;return c}catch(f){return Cd(a,m)(b)}}}var f=a.split(/\s*,\s*/);return yd[a]=
2>f.length?Ad(a):function(a){for(var b=0,c=[],d;d=f[b++];)c=c.concat(Ad(d)(a));return c}}var Dd=0,Ed=B?function(a){return dd?a.getAttribute("_uid")||a.setAttribute("_uid",++Dd)||Dd:a.uniqueID}:function(a){return a._uid||(a._uid=++Dd)};function xd(a,b){if(!b)return 1;var c=Ed(a);return!b[c]?b[c]=1:0}
function Fd(a){if(a&&a.Ra)return a;var b=[];if(!a||!a.length)return b;a[0]&&b.push(a[0]);if(2>a.length)return b;Dd++;if(B&&dd){var c=Dd+"";a[0].setAttribute("_zipIdx",c);for(var d=1,e;e=a[d];d++)a[d].getAttribute("_zipIdx")!=c&&b.push(e),e.setAttribute("_zipIdx",c)}else if(B&&a.Yb)try{for(d=1;e=a[d];d++)gd(e)&&b.push(e)}catch(f){}else{a[0]&&(a[0]._zipIdx=Dd);for(d=1;e=a[d];d++)a[d]._zipIdx!=Dd&&b.push(e),e._zipIdx=Dd}return b}
function Gd(a,b){if(!a)return[];if(a.constructor==Array)return a;if(!u(a))return[a];if(u(b)&&(b=u(b)?document.getElementById(b):b,!b))return[];var b=b||document,c=b.ownerDocument||b.documentElement;dd=b.contentType&&"application/xml"==b.contentType||Da&&(b.doctype||"[object XMLDocument]"==c.toString())||!!c&&(B?c.xml:b.xmlVersion||c.xmlVersion);return(c=Cd(a)(b))&&c.Ra?c:Fd(c)}Gd.la=td;ba("goog.dom.query",Gd);ba("goog.dom.query.pseudos",Gd.la);var Hd={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Id(a){var b={},a=String(a),c="#"==a.charAt(0)?a:"#"+a;if(Jd.test(c))return b.B=Kd(c),b.type="hex",b;a:{var d=a.match(Ld);if(d){var c=Number(d[1]),e=Number(d[2]),d=Number(d[3]);if(0<=c&&255>=c&&0<=e&&255>=e&&0<=d&&255>=d){c=[c,e,d];break a}}c=[]}if(c.length)return b.B=Md(c),b.type="rgb",b;if(Hd&&(c=Hd[a.toLowerCase()]))return b.B=c,b.type="named",b;i(Error(a+" is not a valid color string"))}var Nd=/#(.)(.)(.)/;
function Kd(a){Jd.test(a)||i(Error("'"+a+"' is not a valid hex color"));4==a.length&&(a=a.replace(Nd,"#$1$1$2$2$3$3"));return a.toLowerCase()}function Od(a,b,c){a=Number(a);b=Number(b);c=Number(c);(isNaN(a)||0>a||255<a||isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c)&&i(Error('"('+a+","+b+","+c+'") is not a valid RGB color'));return"#"+Pd(a.toString(16))+Pd(b.toString(16))+Pd(c.toString(16))}function Md(a){return Od(a[0],a[1],a[2])}
function Qd(a,b,c){0>c?c+=1:1<c&&(c-=1);return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}function Rd(a,b,c){var d=0,e=0,f=0,a=a/360;if(0==b)d=e=f=255*c;else var g=f=0,g=0.5>c?c*(1+b):c+b-b*c,f=2*c-g,d=255*Qd(f,g,a+1/3),e=255*Qd(f,g,a),f=255*Qd(f,g,a-1/3);return[Math.round(d),Math.round(e),Math.round(f)]}var Jd=/^#(?:[0-9a-f]{3}){1,2}$/i,Ld=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;function Pd(a){return 1==a.length?"0"+a:a};function Sd(a){var b={},a=String(a),c="#"==a.charAt(0)?a:"#"+a;if(Td.test(c))return b.B=Ud(c),b.type="hex",b;a:{var d=a.match(Vd);if(d){var c=Number(d[1]),e=Number(d[2]),f=Number(d[3]),d=Number(d[4]);if(0<=c&&255>=c&&0<=e&&255>=e&&0<=f&&255>=f&&0<=d&&1>=d){c=[c,e,f,d];break a}}c=[]}if(c.length)return b.B=Wd(c),b.type="rgba",b;a:{if(d=a.match(Xd))if(c=Number(d[1]),e=Number(d[2]),f=Number(d[3]),d=Number(d[4]),0<=c&&360>=c&&0<=e&&100>=e&&0<=f&&100>=f&&0<=d&&1>=d){f=[c,e,f,d];break a}f=[]}if(f.length)return a=
f[0],c=f[1],e=f[2],f=f[3],d=Math.floor(255*f),(isNaN(d)||0>d||255<d)&&i(Error('"('+a+","+c+","+e+","+f+'") is not a valid HSLA color')),f=Pd(d.toString(16)),a=Md(Rd(a,c/100,e/100))+f,b.B=a,b.type="hsla",b;i(Error(a+" is not a valid color string"))}var Yd=/#(.)(.)(.)(.)/;function Ud(a){Td.test(a)||i(Error("'"+a+"' is not a valid alpha hex color"));5==a.length&&(a=a.replace(Yd,"#$1$1$2$2$3$3$4$4"));return a.toLowerCase()}
function Zd(a){a=Ud(a);return[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16),parseInt(a.substr(7,2),16)/255]}function Wd(a){var b=a[0],c=a[1],d=a[2],a=a[3],e=Math.floor(255*a);(isNaN(e)||0>e||255<e)&&i(Error('"('+b+","+c+","+d+","+a+'") is not a valid RGBA color'));a=Pd(e.toString(16));return Od(b,c,d)+a}var Td=/^#(?:[0-9a-f]{4}){1,2}$/i,Vd=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i,Xd=/^(?:hsla)\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\%,\s?(0|[1-9]\d{0,2})\%,\s?(0|1|0\.\d{0,10})\)$/i;function $d(a,b){b=b||"#ffffff";a=a||b;u(a)||i(Error(a+" is not a valid 6-hex color string"));7<a.length&&"#"==a[0]&&(a=a.substr(0,7));7<b.length&&"#"==b[0]&&(b=b.substr(0,7));try{return Id(a)}catch(c){return $d(b,"#ffffff")}}function ae(a,b){b=b||"#ffffff";a=a||b;u(a)||i(Error(a+" is not a valid 8-hex color string"));try{return Sd(a)}catch(c){try{var d=$d(a,b).B;return ae(d+"ff",b+"ff")}catch(e){return ae(b,"#ffffffff")}}}
function be(a){var b;b=0.5;for(var a=Id(a).B,a=Kd(a),a=[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16)],c=[[0,0,0],[255,255,255]],d=[],e=0;e<c.length;e++)d.push({color:c[e],Cb:Math.abs(Math.round((299*c[e][0]+587*c[e][1]+114*c[e][2])/1E3)-Math.round((299*a[0]+587*a[1]+114*a[2])/1E3))+(Math.abs(c[e][0]-a[0])+Math.abs(c[e][1]-a[1])+Math.abs(c[e][2]-a[2]))});d.sort(function(a,b){return b.Cb-a.Cb});a=d[0].color;return 1>b?(a.push(b),b=a[0],c=a[1],d=a[2],a=a[3],(isNaN(b)||
0>b||255<b||isNaN(c)||0>c||255<c||isNaN(d)||0>d||255<d||isNaN(a)||0>a||1<a)&&i(Error('"('+b+","+c+","+d+","+a+')" is not a valid RGBA color')),"rgba("+[b,c,d,a].join()+")"):Md(a)}
function ce(a,b){this.cc=m;this.aa=this.T=this.U=this.V=0;!a&&b&&(a=b);a&&(u(a)?("transparent"==a.toLowerCase()&&(a="#0000"),de(this,a)):da(a)&&3<=a.length?ee(this,[a[0],a[1],a[2],y(a[3])?a[3]:1]):a.cc?this.clone(a):ea(a)&&("h"in a&&"s"in a&&"v"in a?fe(this,[a.h,a.s,a.v,y(a.a)?a.a:1]):"h"in a&&"s"in a&&"l"in a?ge(this,[a.h,a.s,a.l,y(a.a)?a.a:1]):"r"in a&&("g"in a&&"b"in a)&&ee(this,[a.r,a.g,a.b,y(a.a)?a.a:1])))}ce.prototype.clone=function(a){this.V=a.V;this.U=a.U;this.T=a.T;this.aa=a.aa;return this};
ce.prototype.B=function(a){return a===j?Md(he(this)):de(this,a)};function de(a,b){if(b===j)return Wd(ee(a));var c=Zd(ae(b).B);a.V=c[0];a.U=c[1];a.T=c[2];a.aa=c[3];return a}function he(a){return[a.V,a.U,a.T]}function ee(a,b){if(b===j)return[a.V,a.U,a.T,a.aa];a.V=G(Math.round(b[0]),255);a.U=G(Math.round(b[1]),255);a.T=G(Math.round(b[2]),255);a.aa=G(y(b[3])?b[3]:1,1);return a}
function ge(a,b){var c;if(b===j){c=a.V/255;var d=a.U/255,e=a.T/255,f=Math.max(c,d,e),g=Math.min(c,d,e),h=0,k=0,l=0.5*(f+g);f!=g&&(f==c?h=60*(d-e)/(f-g):f==d?h=60*(e-c)/(f-g)+120:f==e&&(h=60*(c-d)/(f-g)+240),k=0<l&&0.5>=l?(f-g)/(2*l):(f-g)/(2-2*l));c=[Math.round(h+360)%360,k,l]}else b===j?c=ge(a).concat([a.aa]):(d=G(Math.round(360+b[0])%360,360),e=G(b[1],1),f=G(b[2],1),c=G(y(b[3])?b[3]:1,1),d=Rd(d,e,f),a.V=d[0],a.U=d[1],a.T=d[2],a.aa=c,c=a);return c}
function fe(a,b){if(b===j){var c,d=he(a);c=d[0];var e=d[1],f=d[2],d=Math.max(Math.max(c,e),f),g=Math.min(Math.min(c,e),f);if(g==d)g=c=0;else{var h=d-g,g=h/d;c=60*(c==d?(e-f)/h:e==d?2+(f-c)/h:4+(c-e)/h);0>c&&(c+=360);360<c&&(c-=360)}c=[c,g,d];c[0]=ge(a)[0];c[2]/=255}else{var k=G(Math.round(360+b[0])%360,360),e=G(b[1],1),d=G(b[2],1);c=G(y(b[3])?b[3]:1,1);d=G(Math.round(255*d),255);h=g=f=0;if(0==e)h=g=f=d;else{var l=Math.floor(k/60),p=k/60-l,k=d*(1-e),q=d*(1-e*p),e=d*(1-e*(1-p));switch(l){case 1:f=q;
g=d;h=k;break;case 2:f=k;g=d;h=e;break;case 3:f=k;g=q;h=d;break;case 4:f=e;g=k;h=d;break;case 5:f=d;g=k;h=q;break;case 6:case 0:f=d,g=e,h=k}}e=[Math.floor(f),Math.floor(g),Math.floor(h)];a.V=e[0];a.U=e[1];a.T=e[2];a.aa=c}};function ie(){var a=this;this.visible=r;this.pc=n;this.nc=[];this.oc=12;this.Ya=n;this.i=Y({e:"callout hidden",children:[{e:"callout-bubble",create:function(b){a.xb=b},children:[{e:"simple-color-picker",children:[{e:"preview-swatch",create:function(b){a.nb=b}},{e:"input-container",children:[{q:"input",type:"text",e:"box-sizing-border",create:function(b){a.Pb=b},change:function(b,c){try{var d=new ce($d(c.value).B);je(a,d)}catch(e){ke(a,a.Ba)}}}]},{e:"button-container",children:[{q:"button",text:"Done",
click:function(){(!a.M||a.M(a.Ba)!=r)&&a.hide()}}]},{e:"spacer"},{e:"swatch-container",create:function(b){a.Ya=b}}]}]},{e:"callout-pointer-border"},{e:"callout-pointer"}]});I(this.xb,"mousedown",function(a){a.stopPropagation()});I(this.xb,"mouseout",function(){le(a,a.Ca);ke(a,a.Ba)});this.tb={};this.M=this.Ba=this.Ca=n;this.bb();zb(P,me,function(){a.hide()})}
function ke(a,b){b&&0<ee(b)[3]?(db(a.nb,"transparent"),a.nb.style.backgroundColor=b.B(),a.Pb.value=b.B()):(cb(a.nb,"transparent"),a.Pb.value="transparent")}function le(a,b){F(Gd(".selected",a.Ya),function(a){db(a,"selected")});b&&cb(b,"selected")}function je(a,b){b?(a.Ca=a.tb[b.B().toLowerCase()]||n,a.Ba=new ce(b.B()),a.Ca&&le(a,a.Ca),ke(a,b)):(a.Ca=n,a.Ba=n)}
ie.prototype.bb=function(){var a;this.tb={};var b=new ce;for(a=0;12>a;a++)fe(b,[0,0,(11-a)/11]),ne(this,he(b));for(var c=0;9>c;c++)for(a=0;360>a;a+=30)ge(b,[a,1,(9-c)/10]),ne(this,he(b));a=Y({e:"clear"});this.Ya.appendChild(a)};
function ne(a,b){var c=Y({e:"swatch"+(b?"":" transparent"),css:{backgroundColor:b?"rgb("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+")":"transparent"},create:function(c){var e=n;b&&(e=new ce(b),a.tb[e.B().toLowerCase()]=c);I(c,"mouseover",function(){le(a,c);ke(a,e)});I(c,"click",function(){(!a.M||a.M(e)!==r)&&a.hide()})}});a.Ya.appendChild(c)}
ie.prototype.show=function(a,b,c,d){P.j(me);this.M=c;je(this,d);this.visible=m;this.i.style.display="block";var e;if(c=this.i.offsetParent)if(d="HTML"==c.tagName||"BODY"==c.tagName,!d||"static"!=pb(c,"position"))e=sb(c),d||(d=(d="rtl"==pb(c,"direction"))&&Ea?-c.scrollLeft:d&&(!B||!D("8"))?c.scrollWidth-c.clientWidth-c.scrollLeft:c.scrollLeft,c=new H(d,c.scrollTop),e=new H(e.x-c.x,e.y-c.y));e=e||new H;c=this.i;a-=e.x;d=b-e.y;e=Ea&&(ya||Ga)&&D("1.9");a instanceof H?(b=a.x,a=a.y):(b=a,a=d);c.style.left=
tb(b,e);c.style.top=tb(a,e)};ie.prototype.hide=function(){this.visible=r;this.i.style.display="none"};function Z(a){this.c=a;this.padding=10;this.K=this.I=n;this.canvas=document.createElement("CANVAS");this.canvas.width=this.c.f()+2*this.padding;this.canvas.height=this.c.m()+2*this.padding;this.canvas.style.position="absolute"}Z.prototype.D=aa();
Z.prototype.Ga=function(a){var a=a||1,b=a*this.c.scale(),c=Math.round(b*this.c.f())+2*this.padding,b=Math.round(b*this.c.m())+2*this.padding;this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c/2)+"px";this.canvas.style.top=Math.round(a*(this.c.y()+this.c.offset.y)-b/2)+"px"};
Z.prototype.Y=function(a,b){var a=a||1,c=a*this.c.scale(),d={f:this.c.f(),m:this.c.m(),color:this.c.color(),alpha:this.c.alpha(),scale:c,selected:b,text:this.c.text()},e={x:this.c.x(),y:this.c.y(),f:this.c.f(),m:this.c.m(),Eb:this.c.offset.x,Fb:this.c.offset.y,scale:c};if(!uc(d,this.I)){this.I=d;var d=this.canvas.getContext("2d"),f=Math.round(c*this.c.f())+2*this.padding,g=Math.round(c*this.c.m())+2*this.padding;d.canvas.width=f;d.canvas.height=g;d.clearRect(0,0,f,g);d.save();d.translate(this.padding,
this.padding);d.scale(c,c);d.lineCap="round";b&&(d.save(),this.D(d,"rgba(255,0,0,0.75)",this.c.lineWidth()+4/c),d.restore());d.save();this.D(d,be(this.c.color()),this.c.lineWidth()+2/c);d.restore();this.D(d);d.restore()}uc(e,this.K)||(this.K=e,this.Ga(a))};Z.prototype.ta=function(){this.K=this.I=this.c=n;mb(this.canvas);this.canvas=n};function oe(a){Z.call(this,a);this.c=a}A(oe,Z);oe.prototype.D=function(a,b,c){a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();var b=this.c.f(),c=this.c.m(),d=Math.min(this.c.f(),this.c.m())/2;a.moveTo(b/2+d*Math.cos(0),c/2+d*Math.sin(0));a.arc(b/2,c/2,d,0,2*Math.PI,r);a.moveTo(b/2,0.25*c);a.lineTo(b/2,0.75*c);a.moveTo(0.25*b,c/2);a.lineTo(b/2,0.75*c);a.lineTo(0.75*b,c/2);a.stroke()};function pe(a){Z.call(this,a);this.c=a}A(pe,Z);pe.prototype.D=function(a,b,c){var d=this.c.f(),e=this.c.m(),f=0.3*e;a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(0.4*d,e);a.lineTo(0.4*d,0);a.lineTo(d-f,0);a.arc(d-f,f,f,-Math.PI/2,Math.PI/2,r);a.lineTo(0.4*d,2*f);a.stroke()};function qe(a){this.c=a;this.padding=15;this.H=this.K=this.I=n;this.canvas=document.createElement("CANVAS");this.canvas.style.position="absolute"}
qe.prototype.D=function(a,b,c){var d,e,f,g=b===j;switch(this.c.textAlign()){case "c":a.textAlign="center";break;case "r":a.textAlign="right";break;default:a.textAlign="left"}a.textBaseline="top";a.fillStyle=this.c.color();a.strokeStyle=b||this.c.color();a.lineWidth=c||0;F(this.c.C,function(b){if(d!=b.size||e!=b.bold||f!=b.Na)d=b.size,e=b.bold,f=b.Na,a.font=re(b.Na,b.bold,b.size);g?a.fillText(b.text,0,b.top):a.strokeText(b.text,0,b.top)})};
function re(a,b,c){var d="";a&&(d+="italic ");b&&(d+="bold ");return d+c+"px Arial, Helvetica, sans-serif"}
qe.prototype.Ga=function(a){var a=a||1,b=a*this.c.scale(),c=Math.round(b*this.H.x)+2*this.padding;Math.round(b*this.H.y);switch(this.c.textAlign()){case "c":this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c/2)+"px";break;case "r":this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c+this.padding)+"px";break;default:this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-this.padding)+"px"}this.canvas.style.top=Math.round(a*(this.c.y()+this.c.offset.y)-this.padding)+
"px"};
qe.prototype.Y=function(a,b){var a=a||1,c=a*this.c.scale(),d={color:this.c.color(),alpha:this.c.alpha(),scale:c,selected:b,text:this.c.text(),textAlign:this.c.textAlign(),na:this.c.na()},e={x:this.c.x(),y:this.c.y(),Eb:this.c.offset.x,Fb:this.c.offset.y,scale:c,textAlign:this.c.textAlign()};if(!uc(d,this.I)){this.I=d;var f=this.canvas.getContext("2d"),d=this.c,g=d.text().replace(/[\s\xa0]+$/,"").replace(/\n\r/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ").split("\n"),h=0,k=[];F(g,function(a){k.push({text:a,top:h,
size:12,width:-1,bold:r,Na:r});h+=18});d.C=k;var l=0;f.save();F(this.c.C,function(a){f.font=re(a.Na,a.bold,a.size);a.width=f.measureText(a.text).width;l=Math.min(2048,Math.max(a.width,l))});f.restore();this.H=new H(l,this.c.C[this.c.C.length-1].top+this.c.C[this.c.C.length-1].size);d=this.c;g=this.padding;d.H=this.H;d.wb=g;d=Math.round(c*this.H.x)+2*this.padding;g=Math.round(c*this.H.y)+2*this.padding;f.canvas.width=d;f.canvas.height=g;f.clearRect(0,0,d,g);f.save();this.c.na()&&(f.save(),f.fillStyle=
be(this.c.color()),f.fillRect(0,0,d,g),f.restore());b&&(f.save(),f.strokeStyle="rgba(255,0,0,0.75)",f.lineWidth=1,f.strokeRect(0.5,0.5,d-1,g-1),f.restore());switch(this.c.textAlign()){case "c":f.translate(d/2,this.padding);break;case "r":f.translate(d-this.padding,this.padding);break;default:f.translate(this.padding,this.padding)}f.scale(c,c);f.lineCap="round";this.c.na()||(f.save(),this.D(f,be(this.c.color()),2/c),f.restore());this.D(f);f.restore()}uc(e,this.K)||(this.K=e,this.Ga(a))};
qe.prototype.ta=function(){this.K=this.I=this.c=n;mb(this.canvas);this.canvas=n};function se(a){Z.call(this,a);this.c=a}A(se,Z);
se.prototype.D=function(a,b,c){var d=b===j,e=this.c.f(),f=this.c.m(),g=Math.min(e,f)/2;a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(e/2+g*Math.cos(0),f/2+g*Math.sin(0));a.arc(e/2,f/2,g,0,2*Math.PI,r);a.stroke();this.c.text()&&(a.font="12px Arial, Helvetica, sans-serif",a.textAlign="center",a.textBaseline="middle",d?(a.fillStyle=this.c.color(),a.fillText(this.c.text(),e/2,f/2)):(a.strokeStyle=b||this.c.color(),a.lineWidth=Math.min(2,(c||this.c.lineWidth())-
this.c.lineWidth()),a.strokeText(this.c.text(),e/2,f/2)))};function te(a){Z.call(this,a);this.c=a}A(te,Z);te.prototype.D=function(a,b,c){a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(0,0);a.lineTo(this.c.f(),this.c.m());a.moveTo(this.c.f(),0);a.lineTo(0,this.c.m());a.stroke()};function ue(a){this.c=a;this.padding=10;this.K=this.I=n;this.canvas=document.createElement("canvas");this.canvas.width=2*this.padding;this.canvas.height=2*this.padding;this.canvas.style.position="absolute"}
function ve(a,b,c,d){var e=a.c.scale(),f=0<a.c.t();b.strokeStyle=c||a.c.color();b.lineWidth=d||a.c.lineWidth()*e;var g=f?new qc(b,a.c.z()*e,a.c.t()*e):b;g.beginPath();if(a.c.eb()){var h=a.c.w(),k=h.length;F(h,function(a,b){if(0===b)g.moveTo(a.x,a.y);else{var c=h[b-1];1==b?g.lineTo((a.x+c.x)/2,(a.y+c.y)/2):g.quadraticCurveTo(c.x,c.y,(a.x+c.x)/2,(a.y+c.y)/2);b==k-1&&g.lineTo(a.x,a.y)}})}else F(a.c.w(),function(a,b){0===b?g.moveTo(a.x,a.y):g.lineTo(a.x,a.y)});g.stroke();f&&g.ta()}
ue.prototype.D=function(a,b,c){var d=b*this.c.scale();a.save();a.lineCap="round";c?(a.save(),ve(this,a,"rgba(255,0,0,0.75)",this.c.lineWidth()*d+4/b)):(a.save(),ve(this,a,be(this.c.color()),this.c.lineWidth()*d+2/b));a.restore();ve(this,a);a.restore()};ue.prototype.Ga=function(a){a=a||1;this.canvas.style.left=Math.round(a*(this.c.offset.x+this.c.G.x)-this.padding)+"px";this.canvas.style.top=Math.round(a*(this.c.offset.y+this.c.G.y)-this.padding)+"px"};
ue.prototype.Y=function(a,b,c){var a=a||1,d=this.c.ob();d.scale=a;d.selected=!!b;d.mode=c||n;if(!uc(d,this.I)){this.I=d;d=this.c;if(0===d.w().length)d.G=n;else{var e=Number.MAX_VALUE,f=Number.MIN_VALUE,g=Number.MAX_VALUE,h=Number.MIN_VALUE;F(d.w(),function(a){e=Math.min(e,a.x);f=Math.max(f,a.x);g=Math.min(g,a.y);h=Math.max(h,a.y)});d.G=new kc(e,g,f-e,h-g)}zc(this.c);var k=this.canvas.getContext("2d"),d=Math.round(a*this.c.G.f)+2*this.padding,l=Math.round(a*this.c.G.m)+2*this.padding;k.canvas.width=
d;k.canvas.height=l;k.clearRect(0,0,d,l);k.save();k.translate(this.padding-Math.round(a*this.c.G.x),this.padding-Math.round(a*this.c.G.y));k.scale(a,a);this.D(k,a,b);if(b&&c==hc){var p=this.c.color(),q=be(p);k.save();F(this.c.w(),function(a){k.beginPath();k.moveTo(a.x+7,a.y);k.arc(a.x,a.y,7,0,2*Math.PI,r);k.strokeStyle=q;k.lineWidth=6;k.stroke();k.strokeStyle=p;k.lineWidth=4;k.stroke()});k.restore()}k.restore()}b={Eb:this.c.offset.x,Fb:this.c.offset.y,x:this.c.G.x,y:this.c.G.y,f:this.c.G.f,m:this.c.G.m};
uc(b,this.K)||(this.K=b,this.Ga(a))};ue.prototype.ta=function(){this.K=this.I=this.c=n;mb(this.canvas);this.canvas=n};function we(a){this.c=a;this.i=lb("DIV","fullsize");this.i.appendChild(this.c.$b);this.dc=lb("DIV","fullsize");this.i.appendChild(this.dc);this.Ha={};setInterval(ka(this.Ab,this),10);zb(P,Q,ka(this.bc,this))}we.prototype.bc=function(a){this.Nb=m;a&&this.Ab()};we.prototype.Ab=function(){this.Nb&&this.Y();this.Nb=r};
we.prototype.Y=function(a){for(var b={},c=0,d=this.c.J.length;c<d;c++){a:{var e=this.c.J[c],f=a,f=f||1,g=this.Ha[e.id];if(!g){switch(e.type()){case 1:g=new te(e);break;case 2:g=new pe(e);break;case 3:g=new oe(e);break;case 4:g=new se(e);break;case 5:g=new qe(e);break;case 0:g=new ue(e)}if(!g)break a;this.Ha[e.id]=g;this.i.appendChild(g.canvas)}g.Y(f,this.c.selected==e.id,this.c.mode.id)}b[this.c.J[c].id]=m}for(var h in this.Ha)b[h]||(this.Ha[h].ta(),delete this.Ha[h])};var Ec=13;function xe(){var a=this;this.visible=r;this.Da=n;this.i=Y({e:"text-area-container",children:[{e:"overlay"},{e:"wrapper",children:[{e:"heading",text:U("Edit Text Content")},{q:"textarea",create:function(b){a.Da=b;I(b,"keydown",function(a){a.stopPropagation()})}},{q:"button",e:"cancel",text:U("Cancel"),click:function(){a.hide()}},{q:"button",e:"save",text:U("Save"),click:function(){a.save()}}]}]});this.M=n}xe.prototype.save=function(){(!this.M||this.M(this.Da.value)!==r)&&this.hide()};
xe.prototype.show=function(a,b){P.j(me);this.visible=m;this.M=a;this.Da.value=b||"";this.i.style.display="block";setTimeout(ka(function(){this.Da.select&&this.Da.select()},this),250)};xe.prototype.hide=function(){this.visible=r;this.M=n;this.i.style.display="none"};function ye(a){this.P=a;this.e={};for(var a=this.P.className.split(" "),b=0,c=a.length;b<c;b++)this.e[a[b]]=m}function ze(a){var b=[],c;for(c in a.e)b.push(c);return b.join(" ")}ye.prototype.addClass=function(a){for(var a=a.split(" "),b=0,c=a.length;b<c;b++)this.e[a[b]]=m;this.P.className=ze(this)};ye.prototype.removeClass=function(a){for(var a=a.split(" "),b=0,c=a.length;b<c;b++)delete this.e[a[b]];this.P.className=ze(this)};function Ae(a,b,c){function d(){if(!e.k){var a=parseFloat(e.input.value);y(a)&&(a/=e.da);a:{for(var a=[a,e.sa,e.value],b=a.length,c=0;c<b;c++)if(a[c]||0===a[c]||""===a[c]||a[c]===r){a=a[c];break a}a=n}e.F(a)}}var a=a||{},e=this;this.Db=this.Wb=this.input=n;this.i=Y({e:"spinner",css:a.css||n,children:[{e:"spinner-textbox",children:[{q:"input",type:"text",create:function(a){e.input=a}}]},{e:"spinner-buttons",children:[{e:"spinner-up",create:function(a){e.Wb=a},children:[{e:"icon-13 icon-13-spinner-arrows"}]},
{e:"spinner-down",create:function(a){e.Db=a},children:[{e:"icon-13 icon-13-spinner-arrows"}]}]}]});this.N=new ye(this.i);this.k=a.disabled||r;this.min=a.min||0;this.max=a.max===j?100:a.max;this.step=a.step||1;this.round=a.round||0;this.loop=!!a.loop;this.sb=a.sb||"";this.sa=a.sa||0;this.da=a.da||1;this.fb=a.fb===j?this.round:a.fb;this.value=0;this.ca=[];this.Gb=[];this.vb=[];this.F(a.value||this.sa||0,m);a.change&&this.ca.push(a.change);a.focus&&this.Gb.push(a.focus);a.blur&&this.vb.push(a.blur);
b&&this.appendTo(b,c);I(this.input,"change",function(){d()});I(this.input,"keydown",function(a){if(!e.k){var b=a.keyCode;38==b?(De(e),a.preventDefault()):40==b?(Ee(e),a.preventDefault()):13==b&&(d(),a.preventDefault())}});I(this.input,"focus",function(){setTimeout(function(){e.input.select()},10);F(e.Gb,function(a){a.call(e,e.value)})});I(this.input,"blur",function(){F(e.vb,function(a){a.call(e)})});I(this.Wb,"click",function(){e.k||De(e)});I(this.Db,"click",function(){e.k||Ee(e)});this.k&&(this.k=
r,this.disable())}function De(a){!y(a.value)&&a.Oa!=n&&(a.value=a.Oa);var b=(Math.round(a.da*a.value/a.step)+1)*a.step/a.da;a.loop&&b>a.max&&(b=a.min+(b-(a.max+1)));a.F(b)}function Ee(a){!y(a.value)&&a.Oa!=n&&(a.value=a.Oa);var b=(Math.round(a.da*a.value/a.step)-1)*a.step/a.da;a.loop&&b<a.min&&(b=a.max+1-(a.min-b));a.F(b)}s=Ae.prototype;
s.F=function(a,b){var c=r;if(a!==this.value||b)a=parseFloat(a),isNaN(a)?this.sa!==n&&(this.value=this.sa):(this.value=a>this.max?this.max:a<this.min?this.min:a,this.Oa=this.value=1*this.value.toFixed(this.round)),this.ya(!!b),c=m;if(!b||c||""===this.input.value)this.input.value=u(this.value)?this.value:(this.value*this.da).toFixed(this.fb||0).replace(/^([^\.]*)$/,"$1.").replace(/\.?0*$/,"")+this.sb};s.ya=function(a){var b=this;F(this.ca,function(c){c.call(b,b.value,!!a)})};
s.appendTo=function(a,b){this.i.style.width=b?b+"px":"auto";a.appendChild(this.i);return this};s.rb=function(a){if(this.k)return this;this.F(a,m);return this};s.focus=function(){this.input.focus();return this};s.blur=function(){this.input.blur();return this};s.enable=function(){this.k&&(this.N.removeClass("disabled"),this.k=this.input.disabled=r);return this};s.disable=function(){this.k||(this.N.addClass("disabled"),this.k=this.input.disabled=m);return this};function Fe(a,b,c,d){b=b||{};this.yb=a;this.i=Y({e:"button-bar"+(b.e?" "+b.e:""),css:b.css||n});this.N=new ye(this.i);this.k=b.disabled||r;this.value=[];this.ca=[];b.change&&this.ca.push(b.change);c&&this.appendTo(c,d);this.bb();this.k&&this.disable()}s=Fe.prototype;s.F=function(a){this.value.push(a)};s.ya=function(a){var b=this;F(this.ca,function(c){c.call(b,b.value,!!a)})};s.appendTo=function(a,b){this.i.style.width=b?b+"px":"auto";a.appendChild(this.i);return this};
s.bb=function(){var a=this;this.value=[];F(this.yb,function(b){var c=b.selected&&b.selected(),d=a.k||b.disabled&&b.disabled();c&&(b.value||0===b.value||b.value===r)&&a.F(b.value);c=Y({e:"button-bar-item"+(c?" selected":"")+(d&&!a.k?" disabled":""),title:b.S||n,click:function(){d=a.k||b.disabled&&b.disabled();d||(b.action(),a.refresh(m))},children:[{e:"icon-13 icon-13-"+b.Q}]});a.i.appendChild(c)})};
s.refresh=function(a){var b=this;this.value=[];F(this.yb,function(a,d){var e=a.selected&&a.selected(),f=b.k||a.disabled&&a.disabled();e&&(a.value||0===a.value||a.value===r)&&b.F(a.value);(fb&&b.i.children!=j?b.i.children:Va(b.i.childNodes,function(a){return 1==a.nodeType}))[d].className="button-bar-item"+(e?" selected":"")+(f&&!b.k?" disabled":"")});this.ya(!a||r);return this};s.enable=function(){this.k&&(this.N.removeClass("disabled"),this.k=r);return this.refresh()};
s.disable=function(){this.k||(this.N.addClass("disabled"),this.k=m);return this.refresh()};function Ge(a,b,c){var a=a||{},d=this;this.Xa=this.Tb=n;this.i=Y({e:"color-well",children:[{e:"color-well-wrapper",children:[{e:"swatch-container",click:function(a,b){if(!d.k){var c=sb(b),h=ub(b);P.j(He,c.x+h.width/2,c.y+h.height+2,function(a){d.F(a)},d.value||n)}},children:[{e:"swatch",create:function(a){d.Tb=a},children:[{q:"canvas",css:{position:"absolute"},create:function(a){d.Xa=a}}]},{e:"border"}]}]}]});this.N=new ye(this.i);this.k=a.disabled||r;this.value=a.value||new ce("#fff");this.ca=[];
a.change&&this.ca.push(a.change);b&&this.appendTo(b,c);this.k&&this.disable()}s=Ge.prototype;
s.Y=function(a){if(!this.ic){var b=ub(this.Tb);if(0==b.width&&!a)return;this.Xa.width=b.width;this.Xa.height=b.height;this.ic=m}var a=this.Xa.getContext("2d"),c=this.value;this.N.removeClass("no-fill");this.k&&(c=new ce("#ccccccff"));c||this.N.addClass("no-fill");var b=a.canvas.width,d=a.canvas.height;a.clearRect(0,0,b,d);c&&(a.save(),c=de(c),c=Zd(c),a.fillStyle="rgba("+c.join(",")+")",a.fillRect(0,0,b,d),a.restore())};s.F=function(a,b){this.value=a;this.Y();this.ya(!!b)};
s.ya=function(a){var b=this;F(this.ca,function(c){c.call(b,b.value,!!a)})};s.appendTo=function(a,b){this.i.style.width=b?b+"px":"";a.appendChild(this.i);return this};s.rb=function(a){this.F(new ce(a),m);return this};s.enable=function(){this.k&&(this.N.removeClass("disabled"),this.k=r,this.Y());return this};s.disable=function(){this.k||(this.N.addClass("disabled"),this.k=m,this.Y());return this};function U(a){if(Ie[a]){var b=a;return b="en"!=Je?Ie[a][Je]||Ie[a].en||a:Ie[a].en||a}return a}var Je="en",Ie={};function Ke(){function a(){return!y(X(W))}function b(){return!u(X(Hc))}function c(a,b,c,d){return new Fe([{Q:a,action:function(){P.j(T,b,d)},S:U(c),selected:function(){return g.mode==b&&(d===j||d==g.pa)},disabled:function(){return r}}],n,Le(f))}function d(a){var b=[];F(a.cb,function(c){a.L?(c.action=function(){Qc(a.L,c.val)},c.selected=function(){return X(a.L)==c.val},c.disabled=function(){return X(a.L)===j}):c.L&&(c.action=function(){Qc(c.L,!X(c.L))},c.selected=function(){return!!X(c.L)},c.disabled=
function(){return X(c.L)===j});b.push(c)});return b}var e=this;this.i=lb("DIV","option-bar");this.viewport=lb("DIV","fullsize");this.i.appendChild(this.viewport);this.Qb=[];this.qc=n;var f=this.i,g=this,h=c("tool-select",Lc,"Select Tool"),k=c("tool-line",Uc,"Line Tool"),l=c("tool-anchor",Vc,"Anchor Tool",1),p=c("tool-piton",Vc,"Piton Tool",2),q=c("tool-rappel",Vc,"Rappel Tool",3),v=c("tool-belay",Vc,"Belay Tool",4),z=c("tool-text",Wc,"Text Tool");Me(f);var w=new Ge({change:function(a,b){b||Qc(K,a.B())}},
Le(f));w.refresh=ka(this.Rb,this,w,K);Me(f);var xa=Y({e:"option-bar-label-left",text:"Scale:",children:n});f.appendChild(xa);xa=new Ae({min:0.5,max:4,step:10,round:2,width:60,value:1,da:100,sb:"%",change:function(a,b){b||Qc(J,a)}},Le(f),50);xa.refresh=ka(this.Rb,this,xa,J);Me(f);var x=new Fe(d({cb:[{Q:"text-align-l",val:"l",S:U("Left Align"),selected:function(){return"l"==X(Hc)},disabled:b},{Q:"text-align-c",val:"c",S:U("Center Align"),selected:function(){return"c"==X(Hc)},disabled:b},{Q:"text-align-r",
val:"r",S:U("Right Align"),selected:function(){return"r"==X(Hc)},disabled:b}],L:Hc}),n,Le(f)),L=new Fe(d({cb:[{Q:"text-bg",L:Ic,S:U("Toggle Text Background")}]}),n,Le(f));Me(f);var Be=new Fe([{Q:"line-solid",action:function(){Qc(W,0)},S:U("Solid Line"),selected:function(){return 0===X(W)},disabled:a},{Q:"line-dashed",action:function(){Rc([[W,10],[xc,10]])},S:U("Dashed Line"),selected:function(){return 2<X(xc)},disabled:a},{Q:"line-dotted",action:function(){Rc([[W,8],[xc,0.01]])},S:U("Dotted Line"),
selected:function(){return 0<X(W)&&2>=X(xc)},disabled:a}],n,Le(f)),Ce=new Fe(d({cb:[{Q:"line-curved",L:yc,S:U("Toggle Line Curvature")}]}),n,Le(f)),Pe=new Fe([{Q:"line-edit",action:function(){P.j(T,hc)},S:U("Edit Line Shape"),selected:function(){return g.mode==hc},disabled:a}],n,Le(f)),Qe=[h,k,l,p,q,v,z,w,xa,x,L,Be,Ce,Pe];this.Qb.push(function(){F(Qe,function(a){a.refresh&&a.refresh()})});this.pa=this.mode=n;zb(P,T,function(a,b){e.mode=a;e.pa=b;e.refresh()})}
Ke.prototype.R=function(){zb(P,ec,ka(this.refresh,this));zb(P,Zc,ka(this.refresh,this));P.j(T,Lc)};function Le(a){var b=Y({e:"option-bar-input"});a.appendChild(b);return b}function Me(a){var b=Y({e:"option-bar-divider"});a.appendChild(b)}Ke.prototype.Rb=function(a,b){var c=X(b);c===j?(a.rb(n),a.disable()):(a.enable(),a.rb(c))};Ke.prototype.refresh=function(){F(this.Qb,function(a){a()})};function Ne(a){var b=this;this.oa=a;this.ub=Y({id:"betacreator",children:[{e:"fullsize viewport",create:function(a){b.viewport=a}},{e:"fullsize viewport",create:function(a){b.Ma=a}},{e:"bc-gui",create:function(a){b.Vb=a}},{create:function(a){b.ec=a}}]});this.canvas=new we(this.oa.canvas);this.viewport.appendChild(this.canvas.i);this.Ob=new Ke;this.Vb.appendChild(this.Ob.i);this.Bb=new ie;this.Vb.appendChild(this.Bb.i);zb(P,He,function(a,d,e,f){b.Bb.show(a,d,e,f)});this.Ub=new xe;this.ec.appendChild(this.Ub.i);
zb(P,ic,function(a,d){b.Ub.show(a,d)})}
Ne.prototype.R=function(){var a=this;I(this.ub,"mousedown",function(){P.j(me)});I(this.Ma,"mousedown",function(b){a.canvas.c.fa(b)});I(this.Ma,"mousemove",function(b){a.canvas.c.ia(b)});I(this.Ma,"mouseup",function(b){a.canvas.c.ja(b)});I(this.Ma,"dblclick",function(b){a.canvas.c.Ka(b)});I(document,"keydown",function(b){b.stopPropagation();if(!a.canvas.c.wa(b)){var c=r;switch(b.keyCode){case 65:P.j(T,Vc,1);break;case 66:P.j(T,Vc,4);break;case 76:P.j(T,Uc);break;case 80:P.j(T,Vc,2);break;case 82:P.j(T,
Vc,3);break;case 84:P.j(T,Wc);break;case 86:case 27:P.j(T,Lc);break;case 89:if(b.ctrlKey||b.metaKey)c=m,Yc(a.oa.canvas);break;case 90:if(b.ctrlKey||b.metaKey)if(c=m,b.shiftKey)Yc(a.oa.canvas);else{var d=a.oa.canvas;if(0!==d.Fa.length){var e=[];F(d.Fa[0],function(a){a=Jc(a);a!=n&&(a.jb=m,a.ib=r,e.unshift(a),R(d,a))});d.Fa.shift();d.Aa.unshift(e)}}}c&&b.preventDefault()}});this.Ob.R()};function Oe(a,b){var c=this,b=b||{};this.p={f:b.width||n,m:b.height||n,kc:b.imageScale||1,zoom:b.zoom||n,mc:b.replaceImg||r};this.Wa=a;var d=document.createElement("img");this.ac=I(d,"load",function(){c.R(d)});d.src=this.Wa.src}
Oe.prototype.R=function(a){Mb(this.ac);this.canvas=new Tc(this,a);this.La=new Ne(this);var b=this.La.ub,a={position:"relative",display:"inherit"==this.Wa.style.display?"inline-block":this.Wa.style.display||"inline-block",width:(this.p.f||a.width)+"px",height:(this.p.m||a.height)+29+"px"};u(a)?ob(b,j,a):Ra(a,la(ob,b));b=this.Wa;(a=b.parentNode)&&a.replaceChild(this.La.ub,b);this.La.R()};var P=new yb,Q="cr",ec="sc",He="scp",ic="sta",me="ho",T="m",Zc="a",Lc=0,Uc=1,Vc=2,Wc=3,hc=4;ba("bc.Client",Oe);})();
