/**
 *  Copyright 2012 Alma Madsen
 *
 *  BetaCreator is Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
(function() {var h,p=this;function aa(a,b){var c=a.split("."),d=p;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function fa(a){return"array"==ba(a)}function ga(a){var b=ba(a);return"array"==b||"object"==b&&"number"==typeof a.length}function q(a){return"string"==typeof a}function r(a){return"number"==typeof a}function ia(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ja(a){return a[ka]||(a[ka]=++la)}var ka="closure_uid_"+(1E9*Math.random()>>>0),la=0;function ma(a,b,c){return a.call.apply(a.bind,arguments)}
function na(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function u(a,b,c){u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ma:na;return u.apply(null,arguments)}
function oa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}function w(a,b){function c(){}c.prototype=b.prototype;a.sc=b.prototype;a.prototype=new c;a.prototype.constructor=a};function pa(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function qa(a){return a.replace(/[\s\xa0]+$/,"")}function ra(a){if(!ua.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(va,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(wa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(xa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(ya,"&quot;"));return a}var va=/&/g,wa=/</g,xa=/>/g,ya=/\"/g,ua=/[&<>\"]/;
function za(a){for(var b=0;1>b;b++)if('"'==a.charAt(0)&&'"'==a.charAt(a.length-1))return a.substring(1,a.length-1);return a}var Aa={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ba={"'":"\\'"};
function Ca(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,k;if(!(k=Aa[d])){if(!(31<e&&127>e))if(d in Ba)d=Ba[d];else if(d in Aa)d=Ba[d]=Aa[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=Ba[d]=e}k=d}f[g]=k}b.push('"');return b.join("")}function Da(a,b){return a<b?-1:a>b?1:0}
function Ea(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function Fa(a){var b=q(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return a.replace(RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,e){return b+e.toUpperCase()})};var Ga,Ha,Ia,Ja,Ka;function La(){return p.navigator?p.navigator.userAgent:null}function Ma(){return p.navigator}Ja=Ia=Ha=Ga=!1;var Qa;if(Qa=La()){var Ra=Ma();Ga=0==Qa.indexOf("Opera");Ha=!Ga&&-1!=Qa.indexOf("MSIE");Ia=!Ga&&-1!=Qa.indexOf("WebKit");Ja=!Ga&&!Ia&&"Gecko"==Ra.product}var Sa=Ga,y=Ha,z=Ja,A=Ia,Ta=Ma();Ka=-1!=(Ta&&Ta.platform||"").indexOf("Mac");var Ua=!!Ma()&&-1!=(Ma().appVersion||"").indexOf("X11");function Va(){var a=p.document;return a?a.documentMode:void 0}var Wa;
a:{var Xa="",Ya;if(Sa&&p.opera)var Za=p.opera.version,Xa="function"==typeof Za?Za():Za;else if(z?Ya=/rv\:([^\);]+)(\)|;)/:y?Ya=/MSIE\s+([^\);]+)(\)|;)/:A&&(Ya=/WebKit\/(\S+)/),Ya)var $a=Ya.exec(La()),Xa=$a?$a[1]:"";if(y){var ab=Va();if(ab>parseFloat(Xa)){Wa=String(ab);break a}}Wa=Xa}var bb={};
function C(a){var b;if(!(b=bb[a])){b=0;for(var c=pa(String(Wa)).split("."),d=pa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",m=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var n=m.exec(g)||["","",""],t=l.exec(k)||["","",""];if(0==n[0].length&&0==t[0].length)break;b=Da(0==n[1].length?0:parseInt(n[1],10),0==t[1].length?0:parseInt(t[1],10))||Da(0==n[2].length,0==t[2].length)||Da(n[2],t[2])}while(0==b)}b=bb[a]=0<=b}return b}
var cb=p.document,db=cb&&y?Va()||("CSS1Compat"==cb.compatMode?parseInt(Wa,10):5):void 0;function eb(a,b){for(var c in a)b.call(void 0,a[c],c,a)}var fb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function gb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<fb.length;f++)c=fb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var D=Array.prototype,hb=D.indexOf?function(a,b,c){return D.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(q(a))return q(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},E=D.forEach?function(a,b,c){D.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=q(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},ib=D.filter?function(a,b,c){return D.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=q(a)?
a.split(""):a,k=0;k<d;k++)if(k in g){var m=g[k];b.call(c,m,k,a)&&(e[f++]=m)}return e},nb=D.some?function(a,b,c){return D.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=q(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function ob(a,b){var c;a:{c=a.length;for(var d=q(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){c=e;break a}c=-1}return 0>c?null:q(a)?a.charAt(c):a[c]}function pb(a,b){var c=hb(a,b);0<=c&&D.splice.call(a,c,1)}
function qb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function rb(a,b,c){return 2>=arguments.length?D.slice.call(a,b):D.slice.call(a,b,c)};function F(a,b,c){return Math.min(Math.max(a,b),c)};function G(a,b){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0}h=G.prototype;h.clone=function(){return new G(this.x,this.y)};h.toString=function(){return"("+this.x+", "+this.y+")"};function sb(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}h.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};h.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
h.translate=function(a,b){a instanceof G?(this.x+=a.x,this.y+=a.y):(this.x+=a,r(b)&&(this.y+=b));return this};h.scale=function(a,b){var c=r(b)?b:a;this.x*=a;this.y*=c;return this};function tb(a,b){this.width=a;this.height=b}h=tb.prototype;h.clone=function(){return new tb(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};h.scale=function(a,b){var c=r(b)?b:a;this.width*=a;this.height*=c;return this};var ub;function vb(a){a=a.className;return q(a)&&a.match(/\S+/g)||[]}function wb(a,b){for(var c=vb(a),d=rb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=hb(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function xb(a,b){var c=vb(a),d=rb(arguments,1),c=yb(c,d);a.className=c.join(" ")}function yb(a,b){return ib(a,function(a){return!(0<=hb(b,a))})};var zb=!y||y&&9<=db,Ab=!z&&!y||y&&y&&9<=db||z&&C("1.9.1");y&&C("9");function Bb(a){return a?new Cb(Db(a)):ub||(ub=new Cb)}function Eb(a,b){eb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Fb?a.setAttribute(Fb[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var Fb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Gb(a,b,c){var d=arguments,e=document,f=d[0],g=d[1];if(!zb&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',ra(g.name),'"');if(g.type){f.push(' type="',ra(g.type),'"');var k={};gb(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=e.createElement(f);g&&(q(g)?f.className=g:fa(g)?wb.apply(null,[f].concat(g)):Eb(f,g));2<d.length&&Hb(e,f,d);return f}
function Hb(a,b,c){function d(c){c&&b.appendChild(q(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];if(!ga(f)||ia(f)&&0<f.nodeType)d(f);else{var g;a:{if(f&&"number"==typeof f.length){if(ia(f)){g="function"==typeof f.item||"string"==typeof f.item;break a}if("function"==ba(f)){g="function"==typeof f.item;break a}}g=!1}E(g?qb(f):f,d)}}}function Ib(a,b){a.appendChild(b)}function Jb(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function Kb(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)}function Lb(a){return Ab&&void 0!=a.children?a.children:ib(a.childNodes,function(a){return 1==a.nodeType})}function Db(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function Mb(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(var c;c=a.firstChild;)a.removeChild(c);a.appendChild(Db(a).createTextNode(String(b)))}}function Cb(a){this.Ja=a||p.document||document}Cb.prototype.createElement=function(a){return this.Ja.createElement(a)};Cb.prototype.createTextNode=function(a){return this.Ja.createTextNode(String(a))};
Cb.prototype.appendChild=Ib;function Nb(a,b){q(b)?Ob(a,void 0,b):eb(b,oa(Ob,a))}function Ob(a,b,c){var d;a:if(d=Ea(c),void 0===a.style[d]&&(c=(A?"Webkit":z?"Moz":y?"ms":Sa?"O":null)+Fa(c),void 0!==a.style[c])){d=c;break a}d&&(a.style[d]=b)}function Pb(a,b){var c;a:{c=Db(a);if(c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))){c=c[b]||c.getPropertyValue(b)||"";break a}c=""}return c||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}
function Qb(a){var b=a.getBoundingClientRect();y&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Rb(a){if(y&&!(y&&8<=db))return a.offsetParent;var b=Db(a),c=Pb(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Pb(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function Sb(a){var b,c=Db(a),d=Pb(a,"position"),e=z&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new G(0,0),g;b=c?Db(c):document;(g=!y)||(g=y&&9<=db)||(g="CSS1Compat"==Bb(b).Ja.compatMode);g=g?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=Qb(a),c=Bb(c).Ja,a=A||"CSS1Compat"!=c.compatMode?c.body:c.documentElement,c=c.parentWindow||c.defaultView,a=new G(c.pageXOffset||a.scrollLeft,c.pageYOffset||a.scrollTop),
f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(A&&"fixed"==Pb(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Sa||A&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=Rb(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Sa&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}
function Tb(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function Ub(a){if("none"!=Pb(a,"display"))return Vb(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Vb(a);b.display=c;b.position=e;b.visibility=d;return a}function Vb(a){var b=a.offsetWidth,c=a.offsetHeight,d=A&&!b&&!c;return(void 0===b||d)&&a.getBoundingClientRect?(a=Qb(a),new tb(a.right-a.left,a.bottom-a.top)):new tb(b,c)}
function Wb(a){return new tb(a.offsetWidth,a.offsetHeight)};function H(a){if(q(a)){var b=Gb("SPAN");Mb(b,a);return b}a.tag=a.tag||"DIV";var c=Gb(a.tag),d={id:a.id,"class":a.e,type:a.type,src:a.src,href:a.href,title:a.title,name:a.name,target:a.target,checked:a.checked,value:a.value},e={},f=!1;for(b in d)void 0!==d[b]&&(e[b]=d[b],f=!0);if(a.attr)for(b in a.attr)e[b]=a.attr[b],f=!0;f&&Eb(c,e);a.html&&(c.innerHTML=a.html);a.text&&Mb(c,a.text);if(a.css)for(b in a.css)c.style[b]=a.css[b];if(a.children)for(b=0;b<a.children.length;b++)a.children[b]&&Ib(c,H(a.children[b]));
a.create&&a.create(c);a.click&&I(c,Xb,function(b){a.click(b,c)});a.change&&I(c,Yb,function(b){a.change(b,c)});return c};function Zb(){return!0};/*
 Portions of this code are from the Dojo Toolkit, received by
 The Closure Library Authors under the BSD license. All other code is
 Copyright 2005-2009 The Closure Library Authors. All Rights Reserved.

The "New" BSD License:

Copyright (c) 2005-2009, The Dojo Foundation
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

 Redistributions of source code must retain the above copyright notice, this
    list of conditions and the following disclaimer.
 Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.
 Neither the name of the Dojo Foundation nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var $b=function(){function a(a,c){if(!a)return[];if(a.constructor==Array)return a;if(!q(a))return[a];if(q(c)&&(c=q(c)?document.getElementById(c):c,!c))return[];c=c||document;var e=c.ownerDocument||c.documentElement;sa=c.contentType&&"application/xml"==c.contentType||Sa&&(c.doctype||"[object XMLDocument]"==e.toString())||!!e&&(y?e.xml:c.xmlVersion||e.xmlVersion);return(e=d(a)(c))&&e.fb?e:b(e)}function b(a){if(a&&a.fb)return a;var b=[];if(!a||!a.length)return b;a[0]&&b.push(a[0]);if(2>a.length)return b;
ca++;if(y&&sa){var c=ca+"";a[0].setAttribute("_zipIdx",c);for(var d=1,e;e=a[d];d++)a[d].getAttribute("_zipIdx")!=c&&b.push(e),e.setAttribute("_zipIdx",c)}else if(y&&a.Ac)try{for(d=1;e=a[d];d++)ta(e)&&b.push(e)}catch(f){}else for(a[0]&&(a[0]._zipIdx=ca),d=1;e=a[d];d++)a[d]._zipIdx!=ca&&b.push(e),e._zipIdx=ca;return b}function c(a,b){if(!b)return 1;var c=He(a);return b[c]?0:b[c]=1}function d(a,b){if(fd){var c=gd[a];if(c&&!b)return c}if(c=hd[a])return c;var c=a.charAt(0),f=-1==a.indexOf(" ");0<=a.indexOf("#")&&
f&&(b=!0);if(!fd||b||-1!=">~+".indexOf(c)||y&&-1!=a.indexOf(":")||jb&&0<=a.indexOf(".")||-1!=a.indexOf(":contains")||-1!=a.indexOf("|=")){var g=a.split(/\s*,\s*/);return hd[a]=2>g.length?e(a):function(a){for(var b=0,c=[],d;d=g[b++];)c=c.concat(e(d)(a));return c}}var k=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return gd[a]=function(b){try{if(9!=b.nodeType&&!f)throw"";var c=b.querySelectorAll(k);y?c.Ac=!0:c.fb=!0;return c}catch(e){return d(a,!0)(b)}}}function e(a){var b=kb(pa(a));if(1==b.length){var c=
f(b[0]);return function(a){if(a=c(a,[]))a.fb=!0;return a}}return function(a){a=ha(a);for(var c,d,e=b.length,g,k,bc=0;bc<e;bc++){k=[];c=b[bc];d=a.length-1;0<d&&(g={},k.fb=!0);d=f(c);for(var l=0;c=a[l];l++)d(c,k,g);if(!k.length)break;a=k}return k}}function f(a){var b=id[a.Ea];if(b)return b;var c=a.bc,c=c?c.gb:"",d=l(a,{Z:1}),e="*"==a.tag,f=document.getElementsByClassName;if(c)f={Z:1},e&&(f.tag=1),d=l(a,f),"+"==c?b=m(d):"~"==c?b=k(d):">"==c&&(b=g(d));else if(a.id)d=!a.kc&&e?Zb:l(a,{Z:1,id:1}),b=function(b,
c){var e;e=Bb(b);var f=a.id;if((f=(e=q(f)?e.Ja.getElementById(f):f)&&d(e))&&!(f=9==b.nodeType)){for(f=e.parentNode;f&&f!=b;)f=f.parentNode;f=!!f}if(f)return ha(e,c)};else if(f&&/\{\s*\[native code\]\s*\}/.test(String(f))&&a.e.length&&!jb)var d=l(a,{Z:1,e:1,id:1}),n=a.e.join(" "),b=function(a,b){for(var c=ha(0,b),e,f=0,g=a.getElementsByClassName(n);e=g[f++];)d(e,a)&&c.push(e);return c};else e||a.kc?(d=l(a,{Z:1,tag:1,id:1}),b=function(b,c){for(var e=ha(0,c),f,g=0,k=b.getElementsByTagName(a.zb());f=
k[g++];)d(f,b)&&e.push(f);return e}):b=function(b,c){for(var d=ha(0,c),e,f=0,g=b.getElementsByTagName(a.zb());e=g[f++];)d.push(e);return d};return id[a.Ea]=b}function g(a){a=a||Zb;return function(b,d,e){for(var f=0,g=b[lb];b=g[f++];)Na(b)&&(!e||c(b,e))&&a(b,f)&&d.push(b);return d}}function k(a){return function(b,d,e){for(b=b[Oa];b;){if(Na(b)){if(e&&!c(b,e))break;a(b)&&d.push(b)}b=b[Oa]}return d}}function m(a){return function(b,d,e){for(;b=b[Oa];)if(!mb||ta(b)){e&&!c(b,e)||!a(b)||d.push(b);break}return d}}
function l(a,b){if(!a)return Zb;b=b||{};var c=null;b.Z||(c=da(c,ta));b.tag||"*"!=a.tag&&(c=da(c,function(b){return b&&b.tagName==a.zb()}));b.e||E(a.e,function(a,b){var d=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");c=da(c,function(a){return d.test(a.className)});c.count=b});b.Aa||E(a.Aa,function(a){var b=a.name;cc[b]&&(c=da(c,cc[b](b,a.value)))});b.Va||E(a.Va,function(a){var b,d=a.attr;a.type&&Pa[a.type]?b=Pa[a.type](d,a.Cb):d.length&&(b=Ie(d));b&&(c=da(c,b))});b.id||a.id&&(c=da(c,function(b){return!!b&&b.id==
a.id}));c||"default"in b||(c=Zb);return c}function n(a){return s(a)%2}function t(a){return!(s(a)%2)}function s(a){var b=a.parentNode,c=0,d=b[lb],e=a._i||-1,f=b._l||-1;if(!d)return-1;d=d.length;if(f==d&&0<=e&&0<=f)return e;b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[Oa])Na(b)&&(b._i=++c,a===b&&(e=c));return e}function x(a){for(;a=a[Oa];)if(Na(a))return!1;return!0}function S(a){for(;a=a[Je];)if(Na(a))return!1;return!0}function ea(a,b){return a?"class"==b?a.className||"":"for"==b?a.htmlFor||
"":"style"==b?a.style.cssText||"":(sa?a.getAttribute(b):a.getAttribute(b,2))||"":""}function ta(a){return 1==a.nodeType}function da(a,b){return a?b?function(){return a.apply(window,arguments)&&b.apply(window,arguments)}:a:b}function kb(a){function b(){0<=m&&(v.id=c(m,B).replace(/\\/g,""),m=-1);if(0<=n){var a=n==B?null:c(n,B);0>">~+".indexOf(a)?v.tag=a:v.gb=a;n=-1}0<=l&&(v.e.push(c(l+1,B).replace(/\\/g,"")),l=-1)}function c(b,d){return pa(a.slice(b,d))}a=0<=">~+".indexOf(a.slice(-1))?a+" * ":a+" ";
for(var d=[],e=-1,f=-1,g=-1,k=-1,l=-1,m=-1,n=-1,t="",s="",Pa,B=0,lb=a.length,v=null,x=null;t=s,s=a.charAt(B),B<lb;B++)"\\"!=t&&(v||(Pa=B,v={Ea:null,Aa:[],Va:[],e:[],tag:null,gb:null,id:null,zb:function(){return sa?this.Mc:this.tag}},n=B),0<=e?"]"==s?(x.attr?x.Cb=c(g||e+1,B):x.attr=c(e+1,B),!(e=x.Cb)||'"'!=e.charAt(0)&&"'"!=e.charAt(0)||(x.Cb=e.slice(1,-1)),v.Va.push(x),x=null,e=g=-1):"="==s&&(g=0<="|~^$*".indexOf(t)?t:"",x.type=g+s,x.attr=c(e+1,B-g.length),g=B+1):0<=f?")"==s&&(0<=k&&(x.value=c(f+
1,B)),k=f=-1):"#"==s?(b(),m=B+1):"."==s?(b(),l=B):":"==s?(b(),k=B):"["==s?(b(),e=B,x={}):"("==s?(0<=k&&(x={name:c(k+1,B),value:null},v.Aa.push(x)),f=B):" "==s&&t!=s&&(b(),0<=k&&v.Aa.push({name:c(k+1,B)}),v.kc=v.Aa.length||v.Va.length||v.e.length,v.Oc=v.Ea=c(Pa,B),v.Mc=v.tag=v.gb?null:v.tag||"*",v.tag&&(v.tag=v.tag.toUpperCase()),d.length&&d[d.length-1].gb&&(v.bc=d.pop(),v.Ea=v.bc.Ea+" "+v.Ea),d.push(v),v=null));return d}function ha(a,b){var c=b||[];a&&c.push(a);return c}var jb=A&&"BackCompat"==document.compatMode,
lb=document.firstChild.children?"children":"childNodes",sa=!1,Pa={"*=":function(a,b){return function(c){return 0<=ea(c,a).indexOf(b)}},"^=":function(a,b){return function(c){return 0==ea(c,a).indexOf(b)}},"$=":function(a,b){return function(c){c=" "+ea(c,a);return c.lastIndexOf(b)==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+ea(b,a)+" ").indexOf(c)}},"|=":function(a,b){b=" "+b;return function(c){c=" "+ea(c,a);return c==b||0==c.indexOf(b+"-")}},"=":function(a,
b){return function(c){return ea(c,a)==b}}},mb="undefined"==typeof document.firstChild.nextElementSibling,Oa=mb?"nextSibling":"nextElementSibling",Je=mb?"previousSibling":"previousElementSibling",Na=mb?ta:Zb,cc={checked:function(){return function(a){return a.checked||a.attributes.checked}},"first-child":function(){return S},"last-child":function(){return x},"only-child":function(){return function(a){return S(a)&&x(a)?!0:!1}},empty:function(){return function(a){var b=a.childNodes;for(a=a.childNodes.length-
1;0<=a;a--){var c=b[a].nodeType;if(1===c||3==c)return!1}return!0}},contains:function(a,b){var c=b.charAt(0);if('"'==c||"'"==c)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},not:function(a,b){var c=kb(b)[0],d={Z:1};"*"!=c.tag&&(d.tag=1);c.e.length||(d.e=1);var e=l(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){if("odd"==b)return n;if("even"==b)return t;if(-1!=b.indexOf("n")){var c=b.split("n",2),d=c[0]?"-"==c[0]?-1:parseInt(c[0],10):1,e=c[1]?parseInt(c[1],10):
0,f=0,g=-1;0<d?0>e?e=e%d&&d+e%d:0<e&&(e>=d&&(f=e-e%d),e%=d):0>d&&(d*=-1,0<e&&(g=e,e%=d));if(0<d)return function(a){a=s(a);return a>=f&&(0>g||a<=g)&&a%d==e};b=e}var k=parseInt(b,10);return function(a){return s(a)==k}}},Ie=y?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return sa?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},id={},hd={},gd={},fd=!!document.querySelectorAll&&(!A||C("526")),ca=0,He=y?function(a){return sa?
a.getAttribute("_uid")||a.setAttribute("_uid",++ca)||ca:a.uniqueID}:function(a){return a._uid||(a._uid=++ca)};a.Aa=cc;return a}();aa("goog.dom.query",$b);aa("goog.dom.query.pseudos",$b.Aa);var ac={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function dc(a){var b={};a=String(a);var c="#"==a.charAt(0)?a:"#"+a;if(ec.test(c))return b.I=fc(c),b.type="hex",b;a:{var d=a.match(gc);if(d){var c=Number(d[1]),e=Number(d[2]),d=Number(d[3]);if(0<=c&&255>=c&&0<=e&&255>=e&&0<=d&&255>=d){c=[c,e,d];break a}}c=[]}if(c.length)return b.I=hc(c),b.type="rgb",b;if(ac&&(c=ac[a.toLowerCase()]))return b.I=c,b.type="named",b;throw Error(a+" is not a valid color string");}var ic=/#(.)(.)(.)/;
function fc(a){if(!ec.test(a))throw Error("'"+a+"' is not a valid hex color");4==a.length&&(a=a.replace(ic,"#$1$1$2$2$3$3"));return a.toLowerCase()}function jc(a,b,c){a=Number(a);b=Number(b);c=Number(c);if(isNaN(a)||0>a||255<a||isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c)throw Error('"('+a+","+b+","+c+'") is not a valid RGB color');return"#"+kc(a.toString(16))+kc(b.toString(16))+kc(c.toString(16))}function hc(a){return jc(a[0],a[1],a[2])}
function lc(a,b,c){0>c?c+=1:1<c&&(c-=1);return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a}function mc(a,b,c){var d=0,e=0,f=0;a/=360;if(0==b)d=e=f=255*c;else var g=f=0,g=0.5>c?c*(1+b):c+b-b*c,f=2*c-g,d=255*lc(f,g,a+1/3),e=255*lc(f,g,a),f=255*lc(f,g,a-1/3);return[Math.round(d),Math.round(e),Math.round(f)]}var ec=/^#(?:[0-9a-f]{3}){1,2}$/i,gc=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;function kc(a){return 1==a.length?"0"+a:a}
function nc(a){for(var b=[[0,0,0],[255,255,255]],c=[],d=0;d<b.length;d++)c.push({color:b[d],Vb:oc(b[d],a)+pc(b[d],a)});c.sort(function(a,b){return b.Vb-a.Vb});return c[0].color}function oc(a,b){return Math.abs(Math.round((299*a[0]+587*a[1]+114*a[2])/1E3)-Math.round((299*b[0]+587*b[1]+114*b[2])/1E3))}function pc(a,b){return Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1])+Math.abs(a[2]-b[2])};function qc(a){var b={};a=String(a);var c="#"==a.charAt(0)?a:"#"+a;if(rc.test(c))return b.I=sc(c),b.type="hex",b;a:{var d=a.match(tc);if(d){var c=Number(d[1]),e=Number(d[2]),f=Number(d[3]),d=Number(d[4]);if(0<=c&&255>=c&&0<=e&&255>=e&&0<=f&&255>=f&&0<=d&&1>=d){c=[c,e,f,d];break a}}c=[]}if(c.length)return b.I=uc(c),b.type="rgba",b;a:{if(d=a.match(vc))if(c=Number(d[1]),e=Number(d[2]),f=Number(d[3]),d=Number(d[4]),0<=c&&360>=c&&0<=e&&100>=e&&0<=f&&100>=f&&0<=d&&1>=d){f=[c,e,f,d];break a}f=[]}if(f.length){a=
f[0];c=f[1];e=f[2];f=f[3];d=Math.floor(255*f);if(isNaN(d)||0>d||255<d)throw Error('"('+a+","+c+","+e+","+f+'") is not a valid HSLA color');f=kc(d.toString(16));a=hc(mc(a,c/100,e/100))+f;b.I=a;b.type="hsla";return b}throw Error(a+" is not a valid color string");}var wc=/#(.)(.)(.)(.)/;function sc(a){if(!rc.test(a))throw Error("'"+a+"' is not a valid alpha hex color");5==a.length&&(a=a.replace(wc,"#$1$1$2$2$3$3$4$4"));return a.toLowerCase()}
function xc(a){a=sc(a);return[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16),parseInt(a.substr(7,2),16)/255]}function uc(a){var b=a[0],c=a[1],d=a[2];a=a[3];var e=Math.floor(255*a);if(isNaN(e)||0>e||255<e)throw Error('"('+b+","+c+","+d+","+a+'") is not a valid RGBA color');a=kc(e.toString(16));return jc(b,c,d)+a}var rc=/^#(?:[0-9a-f]{4}){1,2}$/i,tc=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i,vc=/^(?:hsla)\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\%,\s?(0|[1-9]\d{0,2})\%,\s?(0|1|0\.\d{0,10})\)$/i;
function yc(a){return"rgba("+a.join(",")+")"};function zc(a,b){b=b||"#ffffff";a=a||b;if(!q(a))throw Error(a+" is not a valid 6-hex color string");7<a.length&&"#"==a[0]&&(a=a.substr(0,7));7<b.length&&"#"==b[0]&&(b=b.substr(0,7));try{return dc(a)}catch(c){return zc(b,"#ffffff")}}function Ac(a,b){b=b||"#ffffff";a=a||b;if(!q(a))throw Error(a+" is not a valid 8-hex color string");try{return qc(a)}catch(c){try{var d=zc(a,b).I;return Ac(d+"ff",b+"ff")}catch(e){return Ac(b,"#ffffffff")}}}
function Bc(a){var b;b=0.5;a=dc(a).I;a=fc(a);a=nc([parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16)]);if(1>b){a.push(b);b=a[0];var c=a[1],d=a[2];a=a[3];if(isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c||isNaN(d)||0>d||255<d||isNaN(a)||0>a||1<a)throw Error('"('+b+","+c+","+d+","+a+')" is not a valid RGBA color');return yc([b,c,d,a])}return hc(a)}
function J(a,b){this.Ec=!0;this.ba=this.T=this.U=this.V=0;!a&&b&&(a=b);a&&(q(a)?("transparent"==a.toLowerCase()&&(a="#0000"),Cc(this,a)):fa(a)&&3<=a.length?Dc(this,[a[0],a[1],a[2],r(a[3])?a[3]:1]):a.Ec?this.clone(a):ia(a)&&("h"in a&&"s"in a&&"v"in a?Ec(this,[a.h,a.s,a.v,r(a.a)?a.a:1]):"h"in a&&"s"in a&&"l"in a?Fc(this,[a.h,a.s,a.l,r(a.a)?a.a:1]):"r"in a&&"g"in a&&"b"in a&&Dc(this,[a.r,a.g,a.b,r(a.a)?a.a:1])))}J.prototype.clone=function(a){this.V=a.V;this.U=a.U;this.T=a.T;this.ba=a.ba;return this};
J.prototype.I=function(a){return void 0===a?hc(Gc(this)):Cc(this,a)};function Cc(a,b){if(void 0===b)return uc(Dc(a));var c=xc(Ac(b).I);a.V=c[0];a.U=c[1];a.T=c[2];a.ba=c[3];return a}function Gc(a){return[a.V,a.U,a.T]}function Dc(a,b){if(void 0===b)return[a.V,a.U,a.T,a.ba];a.V=F(Math.round(b[0]),0,255);a.U=F(Math.round(b[1]),0,255);a.T=F(Math.round(b[2]),0,255);a.ba=F(r(b[3])?b[3]:1,0,1);return a}
function Fc(a,b){var c;if(void 0===b){c=a.V/255;var d=a.U/255,e=a.T/255,f=Math.max(c,d,e),g=Math.min(c,d,e),k=0,m=0,l=0.5*(f+g);f!=g&&(f==c?k=60*(d-e)/(f-g):f==d?k=60*(e-c)/(f-g)+120:f==e&&(k=60*(c-d)/(f-g)+240),m=0<l&&0.5>=l?(f-g)/(2*l):(f-g)/(2-2*l));c=[Math.round(k+360)%360,m,l]}else void 0===b?c=Fc(a).concat([a.ba]):(d=F(Math.round(360+b[0])%360,0,360),e=F(b[1],0,1),f=F(b[2],0,1),c=F(r(b[3])?b[3]:1,0,1),d=mc(d,e,f),a.V=d[0],a.U=d[1],a.T=d[2],a.ba=c,c=a);return c}
function Ec(a,b){if(void 0===b){var c,d=Gc(a);c=d[0];var e=d[1],f=d[2],d=Math.max(Math.max(c,e),f),g=Math.min(Math.min(c,e),f);if(g==d)g=c=0;else{var k=d-g,g=k/d;c=60*(c==d?(e-f)/k:e==d?2+(f-c)/k:4+(c-e)/k);0>c&&(c+=360);360<c&&(c-=360)}c=[c,g,d];c[0]=Fc(a)[0];c[2]/=255}else{var m=F(Math.round(360+b[0])%360,0,360),e=F(b[1],0,1),d=F(b[2],0,1);c=F(r(b[3])?b[3]:1,0,1);d=F(Math.round(255*d),0,255);k=g=f=0;if(0==e)k=g=f=d;else{var l=Math.floor(m/60),n=m/60-l,m=d*(1-e),t=d*(1-e*n),e=d*(1-e*(1-n));switch(l){case 1:f=
t;g=d;k=m;break;case 2:f=m;g=d;k=e;break;case 3:f=m;g=t;k=d;break;case 4:f=e;g=m;k=d;break;case 5:f=d;g=m;k=t;break;case 6:case 0:f=d,g=e,k=m}}e=[Math.floor(f),Math.floor(g),Math.floor(k)];a.V=e[0];a.U=e[1];a.T=e[2];a.ba=c}}J.prototype.serialize=function(a){return a?{r:this.V,g:this.U,b:this.T,a:this.ba}:Cc(this)};function Hc(){var a=this;this.sb=this.visible=!1;this.pb=null;this.k=H({e:"callout hidden",children:[{e:"callout-bubble",create:function(b){a.Rb=b},children:[{e:"simple-color-picker",children:[{e:"preview-swatch",create:function(b){a.Gb=b}},{e:"input-container",children:[{tag:"input",type:"text",e:"box-sizing-border",create:function(b){a.pc=b;I(b,Ic,function(){a.sb=!0});I(b,Jc,function(){a.sb=!1});I(b,Kc,function(a){a.stopPropagation()})},change:function(b,c){try{var d=new J(zc(c.value).I);Lc(a,d)}catch(e){Mc(a,
a.Qa)}}}]},{e:"button-container",children:[{tag:"button",text:"Done",click:function(){a.W&&!1==a.W(a.Qa)||a.hide()}}]},{e:"spacer"},{e:"swatch-container",create:function(b){a.pb=b}}]}]},{e:"callout-pointer-border"},{e:"callout-pointer"}]});I(this.Rb,Nc,function(a){a.stopPropagation()});I(this.Rb,Oc,function(){Pc(a,a.Ra);Mc(a,a.Qa)});this.Mb={};this.W=this.Qa=this.Ra=null;this.vb();K(L,Qc,function(){a.hide()})}
function Mc(a,b){b&&0<Dc(b)[3]?(xb(a.Gb,"transparent"),a.Gb.style.backgroundColor=b.I(),a.sb||(a.pc.value=b.I())):(wb(a.Gb,"transparent"),a.sb||(a.pc.value="transparent"))}function Pc(a,b){E($b(".selected",a.pb),function(a){xb(a,"selected")});b&&wb(b,"selected")}function Lc(a,b){b?(a.Ra=a.Mb[b.I().toLowerCase()]||null,a.Qa=new J(b.I()),a.Ra&&Pc(a,a.Ra),Mc(a,b)):(a.Ra=null,a.Qa=null)}
Hc.prototype.vb=function(){var a;this.Mb={};var b=new J;for(a=0;12>a;a++)Ec(b,[0,0,(11-a)/11]),Rc(this,Gc(b));for(var c=0;9>c;c++)for(a=0;360>a;a+=30)Fc(b,[a,1,(9-c)/10]),Rc(this,Gc(b));a=H({e:"clear"});this.pb.appendChild(a)};
function Rc(a,b){Ib(a.pb,H({e:"swatch"+(b?"":" transparent"),css:{backgroundColor:b?"rgb("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+")":"transparent"},create:function(c){var d=null;b&&(d=new J(b),a.Mb[d.I().toLowerCase()]=c);I(c,Sc,function(){Pc(a,c);Mc(a,d)});I(c,Xb,function(){a.W&&!1===a.W(d)||a.hide()})}}))}
Hc.prototype.show=function(a,b,c,d){L.i(Qc);this.W=c;Lc(this,d);this.visible=!0;this.k.style.display="block";var e;if(c=this.k.offsetParent)d="HTML"==c.tagName||"BODY"==c.tagName,d&&"static"==Pb(c,"position")||(e=Sb(c),d||(d=(d="rtl"==Pb(c,"direction"))&&z?-c.scrollLeft:!d||y&&C("8")||"visible"==Pb(c,"overflowX")?c.scrollLeft:c.scrollWidth-c.clientWidth-c.scrollLeft,c=new G(d,c.scrollTop),e=new G(e.x-c.x,e.y-c.y)));e=e||new G;c=this.k;a-=e.x;d=b-e.y;e=z&&(Ka||Ua)&&C("1.9");a instanceof G?(b=a.x,a=
a.y):(b=a,a=d);c.style.left=Tb(b,e);c.style.top=Tb(a,e)};Hc.prototype.hide=function(){this.visible=!1;this.k.style.display="none"};function Tc(){var a=this;this.visible=!1;this.Sa=null;this.k=H({e:"text-area-container",children:[{e:"overlay"},{e:"wrapper",children:[{e:"heading",text:M("Edit Text Content")},{tag:"textarea",create:function(b){a.Sa=b;I(b,Kc,function(a){a.stopPropagation()})}},{tag:"button",e:"cancel",text:M("Cancel"),click:function(){a.hide()}},{tag:"button",e:"save",text:M("Save"),click:function(){a.save()}}]}]});this.W=null}Tc.prototype.save=function(){this.W&&!1===this.W(this.Sa.value)||this.hide()};
Tc.prototype.show=function(a,b){L.i(Qc);this.visible=!0;this.W=a;this.Sa.value=b||"";this.k.style.display="block";setTimeout(u(function(){this.Sa.select&&this.Sa.select()},this),250)};Tc.prototype.hide=function(){this.visible=!1;this.W=null;this.k.style.display="none"};function Uc(a,b,c,d){this.x=a;this.y=b;this.f=c;this.j=d}function Vc(a,b,c,d){if(2==arguments.length)return Math.sqrt(a*a+b*b);var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)}function Wc(a,b,c,d,e,f,g){var k=0,m=a,l=b,n,t,s,x;g=g||6;for(var S=1;S<=g;S++)n=S/g,s=1-n,t=s*s,s*=2*n,x=n*n,n=t*a+s*c+x*e,t=t*b+s*d+x*f,k+=Vc(m,l,n,t),m=n,l=t;return k}function Xc(a,b,c,d,e,f,g,k){if(0==g)return Yc(a,b,c,d,e,f,k);if(1==k)return Zc(a,b,c,d,e,f,g);a=Yc(a,b,c,d,e,f,k);a.push(g/k);return Zc.apply(null,a)}
function Yc(a,b,c,d,e,f,g){g=g||1;1!=g&&(e=c+(e-c)*g,f=d+(f-d)*g,c=a+(c-a)*g,d=b+(d-b)*g,e=c+(e-c)*g,f=d+(f-d)*g);return[a,b,c,d,e,f]}function Zc(a,b,c,d,e,f,g){g=g||1;1!=g&&(a+=(c-a)*g,b+=(d-b)*g,c+=(e-c)*g,d+=(f-d)*g,a+=(c-a)*g,b+=(d-b)*g);return[a,b,c,d,e,f]}
function $c(a,b,c){var d=(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y),e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d,d=Math.abs(((b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y))/d)*Math.sqrt(d);0<=e&&1>=e?a=d:(b=(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y),a=(a.x-c.x)*(a.x-c.x)+(a.y-c.y)*(a.y-c.y),a=b<a?Math.sqrt(b):Math.sqrt(a));return a};function ad(a){this.Z=a;this.e={};a=this.Z.className.split(" ");for(var b=0,c=a.length;b<c;b++)this.e[a[b]]=!0}function bd(a){var b=[],c;for(c in a.e)b.push(c);return b.join(" ")}ad.prototype.addClass=function(a){a=a.split(" ");for(var b=0,c=a.length;b<c;b++)this.e[a[b]]=!0;this.Z.className=bd(this)};ad.prototype.removeClass=function(a){a=a.split(" ");for(var b=0,c=a.length;b<c;b++)delete this.e[a[b]];this.Z.className=bd(this)};function cd(a,b,c){function d(){if(!e.n){var a=parseFloat(e.input.value);r(a)&&(a/=e.ma);a:{for(var a=[a,e.Ha,e.value],b=a.length,c=0;c<b;c++)if(a[c]||0===a[c]||""===a[c]||!1===a[c]){a=a[c];break a}a=null}e.N(a)}}a=a||{};var e=this;this.Wb=this.wc=this.input=null;this.k=H({e:"spinner",css:a.css||null,children:[{e:"spinner-textbox",children:[{tag:"input",type:"text",create:function(a){e.input=a}}]},{e:"spinner-buttons",children:[{e:"spinner-up",create:function(a){e.wc=a},children:[{e:"icon-13 icon-13-spinner-arrows"}]},
{e:"spinner-down",create:function(a){e.Wb=a},children:[{e:"icon-13 icon-13-spinner-arrows"}]}]}]});this.X=new ad(this.k);this.n=a.disabled||!1;this.min=a.min||0;this.max=void 0===a.max?100:a.max;this.step=a.step||1;this.round=a.round||0;this.loop=!!a.loop;this.Lb=a.Lb||"";this.Ha=a.Ha||0;this.ma=a.ma||1;this.wb=void 0===a.wb?this.round:a.wb;this.value=0;this.ka=[];this.Zb=[];this.Pb=[];this.N(a.value||this.Ha||0,!0);a.change&&this.ka.push(a.change);a.focus&&this.Zb.push(a.focus);a.blur&&this.Pb.push(a.blur);
b&&this.appendTo(b,c);I(this.input,Yb,function(){d()});I(this.input,Kc,function(a){if(!e.n){var b=a.keyCode;38==b?(e.stepUp(),a.preventDefault()):40==b?(e.stepDown(),a.preventDefault()):13==b&&(d(),e.input.blur(),a.preventDefault());a.stopPropagation()}});I(this.input,Ic,function(){dd(e)});I(this.input,Jc,function(){ed(e)});I(this.wc,Xb,function(){e.n||e.stepUp()});I(this.Wb,Xb,function(){e.n||e.stepDown()});this.n&&(this.n=!1,this.disable())}h=cd.prototype;
h.stepUp=function(){r(this.value)||null==this.bb||(this.value=this.bb);var a=(Math.round(this.ma*this.value/this.step)+1)*this.step/this.ma;this.loop&&a>this.max&&(a=this.min+(a-(this.max+1)));this.N(a)};h.stepDown=function(){r(this.value)||null==this.bb||(this.value=this.bb);var a=(Math.round(this.ma*this.value/this.step)-1)*this.step/this.ma;this.loop&&a<this.min&&(a=this.max+1-(this.min-a));this.N(a)};
h.N=function(a,b){var c=!1;if(a!==this.value||b)a=parseFloat(a),isNaN(a)?null!==this.Ha&&(this.value=this.Ha):(this.value=a>this.max?this.max:a<this.min?this.min:a,this.bb=this.value=1*this.value.toFixed(this.round)),this.pa(!!b),c=!0;if(!b||c||""===this.input.value)this.input.value=q(this.value)?this.value:(this.value*this.ma).toFixed(this.wb||0).replace(/^([^\.]*)$/,"$1.").replace(/\.?0*$/,"")+this.Lb};h.pa=function(a){var b=this;E(this.ka,function(c){c.call(b,b.value,!!a)})};
function dd(a){setTimeout(function(){a.input.select()},10);E(a.Zb,function(b){b.call(a,a.value)})}function ed(a){E(a.Pb,function(b){b.call(a)})}h.appendTo=function(a,b){this.k.style.width=b?b+"px":"auto";a.appendChild(this.k);return this};h.Kb=function(a){if(this.n)return this;this.N(a,!0);return this};h.focus=function(){this.input.focus();return this};h.blur=function(){this.input.blur();return this};h.enable=function(){this.n&&(this.X.removeClass("disabled"),this.n=this.input.disabled=!1);return this};
h.disable=function(){this.n||(this.X.addClass("disabled"),this.n=this.input.disabled=!0);return this};function jd(a,b,c,d){b=b||{};this.Sb=a;this.k=H({e:"button-bar"+(b.e?" "+b.e:""),css:b.css||null});this.X=new ad(this.k);this.n=b.disabled||!1;this.value=[];this.ka=[];b.change&&this.ka.push(b.change);c&&this.appendTo(c,d);this.vb();this.n&&this.disable()}h=jd.prototype;h.N=function(a){this.value.push(a)};h.pa=function(a){var b=this;E(this.ka,function(c){c.call(b,b.value,!!a)})};h.appendTo=function(a,b){this.k.style.width=b?b+"px":"auto";a.appendChild(this.k);return this};
h.vb=function(){var a=this;this.value=[];E(this.Sb,function(b){var c=b.selected&&b.selected(),d=a.n||b.disabled&&b.disabled();c&&(b.value||0===b.value||!1===b.value)&&a.N(b.value);Ib(a.k,H({e:"button-bar-item"+(c?" selected":"")+(d&&!a.n?" disabled":""),title:b.aa||null,click:function(){d=a.n||b.disabled&&b.disabled();d||(b.action(),a.refresh(!0))},children:[{e:"icon-13 icon-13-"+b.icon}]}))})};
h.refresh=function(a){var b=this;this.value=[];E(this.Sb,function(a,d){var e=a.selected&&a.selected(),f=b.n||a.disabled&&a.disabled();e&&(a.value||0===a.value||!1===a.value)&&b.N(a.value);Lb(b.k)[d].className="button-bar-item"+(e?" selected":"")+(f&&!b.n?" disabled":"")});this.pa(!a||!1);return this};h.enable=function(){this.n&&(this.X.removeClass("disabled"),this.n=!1);return this.refresh()};h.disable=function(){this.n||(this.X.addClass("disabled"),this.n=!0);return this.refresh()};function kd(a,b,c){a=a||{};var d=this;this.ob=this.tc=null;this.k=H({e:"color-well",children:[{e:"color-well-wrapper",children:[{e:"swatch-container",click:function(a,b){if(!d.n){var c=Sb(b),k=Ub(b);L.i(ld,c.x+k.width/2,c.y+k.height+2,function(a){d.N(a)},d.value||null)}},children:[{e:"swatch",create:function(a){d.tc=a},children:[{tag:"canvas",css:{position:"absolute"},create:function(a){d.ob=a}}]},{e:"border"}]}]}]});this.X=new ad(this.k);this.n=a.disabled||!1;this.value=a.value||new J("#fff");this.ka=
[];a.change&&this.ka.push(a.change);b&&this.appendTo(b,c);this.n&&this.disable()}h=kd.prototype;h.fa=function(a){if(!this.Nc){var b=Ub(this.tc);if(0==b.width&&!a)return;this.ob.width=b.width;this.ob.height=b.height;this.Nc=!0}a=this.ob.getContext("2d");var c=this.value;this.X.removeClass("no-fill");this.n&&(c=new J("#ccccccff"));c||this.X.addClass("no-fill");var b=a.canvas.width,d=a.canvas.height;a.clearRect(0,0,b,d);c&&(a.save(),c=Cc(c),c=yc(xc(c)),a.fillStyle=c,a.fillRect(0,0,b,d),a.restore())};
h.N=function(a,b){this.value=a;this.fa();this.pa(!!b)};h.pa=function(a){var b=this;E(this.ka,function(c){c.call(b,b.value,!!a)})};h.appendTo=function(a,b){this.k.style.width=b?b+"px":"";a.appendChild(this.k);return this};h.Kb=function(a){this.N(new J(a),!0);return this};h.enable=function(){this.n&&(this.X.removeClass("disabled"),this.n=!1,this.fa());return this};h.disable=function(){this.n||(this.X.addClass("disabled"),this.n=!0,this.fa());return this};function md(a,b){if(null==a)return null;null==b&&(b=0);if(100<b)return null;var c={};if("object"==typeof a){"undefined"!=typeof a.length&&(c=[]);for(var d in a){var e=typeof a[d];"object"==e?c[d]=a[d]instanceof HTMLElement?a[d]:md(a[d],b+1):"string"==e?c[d]=a[d]:"number"==e?c[d]=a[d]:"function"==e?c[d]=a[d]:"boolean"==e?!0==a[d]?c[d]=!0:c[d]=!1:"undefined"==e&&(c[d]=void 0)}}return c}
function nd(a,b){if("object"==typeof a&&"object"==typeof b){if(null==a&&null==b)return!0;if(fa(a)&&fa(b)){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(!nd(a[c],b[c]))return!1;return!0}if(ia(a)&&ia(b)){for(c in a)if(!(c in(a.__proto__||a.constructor)||"__proto__"==c||c in b&&nd(a[c],b[c])))return!1;for(c in b)if(!(c in(b.__proto__||b.constructor)||"__proto__"==c||c in a))return!1;return!0}return!1}return r(a)&&r(b)?1E-9>Math.abs(a-b):null==a&&null==b?!0:a===b};function N(a,b){this.type=a;this.q=b;this.Eb=null;this.Bb=this.Ab=!1}N.prototype.copy=function(){return new N(this.type,md(this.q))};function od(a){var b=a.copy();switch(a.type){case 1:b.type=5;break;case 2:b.type=6;break;case 3:b.type=7;break;case 4:b.q=md(a.Eb);break;case 5:b.type=1;break;case 6:b.type=2;break;case 7:b.type=3;break;default:return null}return b};var pd=null;function qd(a,b){var c=pd;if(c){var d=rd(c);0<d.length?E(d,function(d){void 0!==d.d[a]&&(d={id:d.id},d[a]=b,O(c,new N(4,d)))}):c.c.d[a]=b}}function sd(a){var b=pd;b&&(b.Fa++,E(a,function(a){qd(a[0],a[1])}),td(b))}function P(a){var b=pd;if(b){var c=rd(b),d;0<c.length?nb(c,function(b){return void 0!==b.d[a]?(d=b.d[a],!0):!1}):d=b.c.d[a];return d}}function Q(a,b){return function(c){void 0!==c&&void 0!==a[b]&&(a[b]=c);return a[b]}};function M(a){if(ud[a]){var b=a;return b="en"!=vd?ud[a][vd]||ud[a].en||a:ud[a].en||a}return a}var vd="en",ud={};function wd(){var a=this;this.k=Gb("DIV","option-bar");this.viewport=Gb("DIV","fullsize");this.k.appendChild(this.viewport);this.qc=[];xd(this,this.k);this.Da=this.mode=null;K(L,R,function(b,c){a.mode=b;a.Da=c;a.refresh()})}wd.prototype.$=function(){K(L,yd,u(this.refresh,this));K(L,zd,u(this.refresh,this));L.i(R,Ad)};function Bd(a){var b=H({e:"option-bar-input"});a.appendChild(b);return b}function Cd(a){var b=H({e:"option-bar-divider"});a.appendChild(b)}
function Dd(a){var b=H({e:"option-bar-label-left",text:"Scale:",children:null});a.appendChild(b)}wd.prototype.rc=function(a,b){var c=P(b);void 0===c?(a.Kb(null),a.disable()):(a.enable(),a.Kb(c))};
function xd(a,b){function c(){return!r(P("fl"))}function d(){return!q(P("ta"))}function e(c,d,e,f){return new jd([{icon:c,action:function(){L.i(R,d,f)},aa:M(e),selected:function(){return a.mode==d&&(void 0===f||f==a.Da)},disabled:function(){return!1}}],null,Bd(b))}function f(a){var b=[];E(a.buttons,function(c){a.S?(c.action=function(){qd(a.S,c.val)},c.selected=function(){return P(a.S)==c.val},c.disabled=function(){return void 0===P(a.S)}):c.S&&(c.action=function(){qd(c.S,!P(c.S))},c.selected=function(){return!!P(c.S)},
c.disabled=function(){return void 0===P(c.S)});b.push(c)});return b}var g=e("tool-select",Ad,"Select Tool"),k=e("tool-line",Ed,"Line Tool"),m=e("tool-anchor",T,"Anchor Tool",Fd),l=e("tool-piton",T,"Piton Tool",Gd),n=e("tool-rappel",T,"Rappel Tool",Hd),t=e("tool-belay",T,"Belay Tool",Id),s=e("tool-text",Jd,"Text Tool");Cd(b);var x=new kd({change:function(a,b){b||qd("ic",a.I())}},Bd(b));x.refresh=u(a.rc,a,x,"ic");Cd(b);Dd(b);var S=new cd({min:0.25,max:8,step:10,round:2,width:60,value:1,ma:100,Lb:"%",
change:function(a,b){b||qd("is",a)}},Bd(b),50);S.refresh=u(a.rc,a,S,"is");Cd(b);var ea=new jd(f({buttons:[{icon:"text-align-l",val:"l",aa:M("Left Align"),selected:function(){return"l"==P("ta")},disabled:d},{icon:"text-align-c",val:"c",aa:M("Center Align"),selected:function(){return"c"==P("ta")},disabled:d},{icon:"text-align-r",val:"r",aa:M("Right Align"),selected:function(){return"r"==P("ta")},disabled:d}],S:"ta"}),null,Bd(b)),ta=new jd(f({buttons:[{icon:"text-bg",S:"tb",aa:M("Toggle Text Background")}]}),
null,Bd(b));Cd(b);var da=new jd([{icon:"line-solid",action:function(){qd("fl",0)},aa:M("Solid Line"),selected:function(){return 0===P("fl")},disabled:c},{icon:"line-dashed",action:function(){sd([["fl",10],["nl",10]])},aa:M("Dashed Line"),selected:function(){return 2<P("nl")},disabled:c},{icon:"line-dotted",action:function(){sd([["fl",8],["nl",0.01]])},aa:M("Dotted Line"),selected:function(){return 0<P("fl")&&2>=P("nl")},disabled:c}],null,Bd(b)),kb=new jd(f({buttons:[{icon:"line-curved",S:"lc",aa:M("Toggle Line Curvature")}]}),
null,Bd(b)),ha=new jd([{icon:"line-edit",action:function(){L.i(R,Kd)},aa:M("Edit Line Shape"),selected:function(){return a.mode==Kd},disabled:c}],null,Bd(b)),jb=[g,k,m,l,n,t,s,x,S,ea,ta,da,kb,ha];a.qc.push(function(){E(jb,function(a){a.refresh&&a.refresh()})})}wd.prototype.refresh=function(){E(this.qc,function(a){a()})};function Ld(a){var b=this;this.C=a;this.Ga=H({id:"betacreator",children:[{e:"fullsize viewport",create:function(a){b.viewport=a}},{e:"fullsize hitdiv",create:function(a){b.$a=a}},{e:"bc-gui",create:function(a){b.vc=a}},{create:function(a){b.Lc=a}}]});this.m=this.C.m;this.viewport.appendChild(this.m.view.k);this.oc=new wd;this.vc.appendChild(this.oc.k);this.Ub=new Hc;this.vc.appendChild(this.Ub.k);K(L,ld,function(a,d,e,f){b.Ub.show(a,d,e,f)});this.uc=new Tc;this.Lc.appendChild(this.uc.k);K(L,Md,function(a,
d){b.uc.show(a,d)})}Ld.prototype.$=function(){Nd(this);this.oc.$()};
function Nd(a){I(a.Ga,Nc,function(){L.i(Qc)});I(a.$a,Nc,function(b){a.m.oa(b)});I(a.$a,Od,function(b){a.m.xa(b)});I(a.$a,Pd,function(b){a.m.ya(b)});I(a.$a,Qd,function(b){a.m.Za(b)});I(document,Kc,function(b){b.stopPropagation();if(!a.m.La(b)){var c=!1;switch(b.keyCode){case 65:L.i(R,T,Fd);break;case 66:L.i(R,T,Id);break;case 76:L.i(R,Ed);break;case 80:L.i(R,T,Gd);break;case 82:L.i(R,T,Hd);break;case 84:L.i(R,Jd);break;case 86:case 27:L.i(R,Ad);break;case 89:if(b.ctrlKey||b.metaKey)c=!0,Rd(a.m);break;
case 90:if(b.ctrlKey||b.metaKey)c=!0,b.shiftKey?Rd(a.m):Sd(a.m);break;case 8:case 46:c=!0;a.m.Fa++;E(rd(a.m),function(b){var c=null;b.Fc?(c=Td(b.d),c.id=b.id,O(a.m,new N(5,c))):b.p?(c=Ud(b.d),c.id=b.id,O(a.m,new N(6,c))):b.Gc&&(c=Vd(b.d),c.id=b.id,O(a.m,new N(7,c)))});td(a.m);a.m.selected=null;L.i(yd);L.i(U);break;case 189:if(b.ctrlKey||b.metaKey)c=!0,a.m.Ob();break;case 187:if(b.ctrlKey||b.metaKey)c=!0,a.m.Nb()}c&&b.preventDefault()}})};function Wd(){0!=Xd&&ja(this)}var Xd=0;function Yd(){Wd.call(this);this.ga=[];this.qb={}}w(Yd,Wd);Yd.prototype.fc=1;Yd.prototype.kb=0;function K(a,b,c){var d=a.qb[b];d||(d=a.qb[b]=[]);var e=a.fc;a.ga[e]=b;a.ga[e+1]=c;a.ga[e+2]=void 0;a.fc=e+3;d.push(e)}
Yd.prototype.i=function(a,b){var c=this.qb[a];if(c){this.kb++;for(var d=rb(arguments,1),e=0,f=c.length;e<f;e++){var g=c[e];this.ga[g+1].apply(this.ga[g+2],d)}this.kb--;if(this.hb&&0==this.kb)for(;c=this.hb.pop();)if(0!=this.kb)this.hb||(this.hb=[]),this.hb.push(c);else if(d=this.ga[c])(d=this.qb[d])&&pb(d,c),delete this.ga[c],delete this.ga[c+1],delete this.ga[c+2]}};function Zd(a,b){this.type=a;this.currentTarget=this.target=b}Zd.prototype.jb=!1;Zd.prototype.defaultPrevented=!1;Zd.prototype.stopPropagation=function(){this.jb=!0};Zd.prototype.preventDefault=function(){this.defaultPrevented=!0};var $d=0;function ae(){}h=ae.prototype;h.key=0;h.Ba=!1;h.Wa=!1;h.$=function(a,b,c,d,e,f){if("function"==ba(a))this.dc=!0;else if(a&&a.handleEvent&&"function"==ba(a.handleEvent))this.dc=!1;else throw Error("Invalid listener argument");this.wa=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.$b=f;this.Wa=!1;this.key=++$d;this.Ba=!1};h.handleEvent=function(a){return this.dc?this.wa.call(this.$b||this.src,a):this.wa.handleEvent.call(this.wa,a)};var be=!y||y&&9<=db,ce=y&&!C("9");!A||C("528");z&&C("1.9b")||y&&C("8")||Sa&&C("9.5")||A&&C("528");z&&!C("8")||y&&C("9");var Xb="click",Qd="dblclick",Nc="mousedown",Pd="mouseup",Sc="mouseover",Oc="mouseout",Od="mousemove",Kc="keydown",Jc="blur",Ic="focus",Yb="change";function de(a){de[" "](a);return a}de[" "]=function(){};function ee(a,b){a&&this.$(a,b)}w(ee,Zd);h=ee.prototype;h.target=null;h.relatedTarget=null;h.offsetX=0;h.offsetY=0;h.clientX=0;h.clientY=0;h.screenX=0;h.screenY=0;h.button=0;h.keyCode=0;h.charCode=0;h.ctrlKey=!1;h.altKey=!1;h.shiftKey=!1;h.metaKey=!1;h.Ka=null;
h.$=function(a,b){var c=this.type=a.type;Zd.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(z){var e;a:{try{de(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else c==Sc?d=a.fromElement:c==Oc&&(d=a.toElement);this.relatedTarget=d;this.offsetX=A||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=A||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ka=a;a.defaultPrevented&&this.preventDefault();delete this.jb};h.stopPropagation=function(){ee.sc.stopPropagation.call(this);this.Ka.stopPropagation?this.Ka.stopPropagation():this.Ka.cancelBubble=!0};
h.preventDefault=function(){ee.sc.preventDefault.call(this);var a=this.Ka;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ce)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var fe={},V={},ge={},he={};
function I(a,b,c,d,e){if(fa(b)){for(var f=0;f<b.length;f++)I(a,b[f],c,d,e);return null}a:{if(!b)throw Error("Invalid event type");d=!!d;var g=V;b in g||(g[b]={ca:0,ea:0});g=g[b];d in g||(g[d]={ca:0,ea:0},g.ca++);var g=g[d],f=ja(a),k;g.ea++;if(g[f]){k=g[f];for(var m=0;m<k.length;m++)if(g=k[m],g.wa==c&&g.$b==e){if(g.Ba)break;k[m].Wa=!1;a=k[m];break a}}else k=g[f]=[],g.ca++;m=ie();g=new ae;g.$(c,m,a,b,d,e);g.Wa=!1;m.src=a;m.wa=g;k.push(g);ge[f]||(ge[f]=[]);ge[f].push(g);a.addEventListener?a!=p&&a.Bc||
a.addEventListener(b,m,d):a.attachEvent(b in he?he[b]:he[b]="on"+b,m);a=g}b=a.key;fe[b]=a;return b}function ie(){var a=je,b=be?function(c){return a.call(b.src,b.wa,c)}:function(c){c=a.call(b.src,b.wa,c);if(!c)return c};return b}
function ke(a){var b=fe[a];if(b&&!b.Ba){var c=b.src,d=b.type,e=b.proxy,f=b.capture;c.removeEventListener?c!=p&&c.Bc||c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in he?he[d]:he[d]="on"+d,e);c=ja(c);ge[c]&&(e=ge[c],pb(e,b),0==e.length&&delete ge[c]);b.Ba=!0;if(b=V[d][f][c])b.nc=!0,le(d,f,c,b);delete fe[a]}}
function le(a,b,c,d){if(!d.cb&&d.nc){for(var e=0,f=0;e<d.length;e++)d[e].Ba?d[e].proxy.src=null:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.nc=!1;0==f&&(delete V[a][b][c],V[a][b].ca--,0==V[a][b].ca&&(delete V[a][b],V[a].ca--),0==V[a].ca&&delete V[a])}}function me(a,b,c,d,e){var f=1;b=ja(b);if(a[b]){var g=--a.ea,k=a[b];k.cb?k.cb++:k.cb=1;try{for(var m=k.length,l=0;l<m;l++){var n=k[l];n&&!n.Ba&&(f&=!1!==ne(n,e))}}finally{a.ea=Math.max(g,a.ea),k.cb--,le(c,d,b,k)}}return Boolean(f)}
function ne(a,b){a.Wa&&ke(a.key);return a.handleEvent(b)}
function je(a,b){if(a.Ba)return!0;var c=a.type,d=V;if(!(c in d))return!0;var d=d[c],e,f;if(!be){var g;if(!(g=b))a:{g=["window","event"];for(var k=p;e=g.shift();)if(null!=k[e])k=k[e];else{g=null;break a}g=k}e=g;g=!0 in d;k=!1 in d;if(g){if(0>e.keyCode||void 0!=e.returnValue)return!0;a:{var m=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(l){m=!0}if(m||void 0==e.returnValue)e.returnValue=!0}}m=new ee;m.$(e,this);e=!0;try{if(g){for(var n=[],t=m.currentTarget;t;t=t.parentNode)n.push(t);f=d[!0];f.ea=
f.ca;for(var s=n.length-1;!m.jb&&0<=s&&f.ea;s--)m.currentTarget=n[s],e&=me(f,n[s],c,!0,m);if(k)for(f=d[!1],f.ea=f.ca,s=0;!m.jb&&s<n.length&&f.ea;s++)m.currentTarget=n[s],e&=me(f,n[s],c,!1,m)}else e=ne(a,m)}finally{n&&(n.length=0)}return e}c=new ee(b,this);return e=ne(a,c)};var Fd=1,Gd=2,Hd=3,Id=4;function oe(a){if(a)return pe[a]=!0,a;a=qe();return pe[a]?oe():oe(a)}var pe={};function qe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};function W(a,b){a=a||{};this.Fc=!0;this.id=oe(a.id);this.d={};this.d.it=null;this.d.is=a.scale||b.is;this.d.ic=a.color||b.ic;this.d.ia=a.alpha||b.ia;this.d.lw=a.lineWidth||3;this.d.x=a.x||0;this.d.y=a.y||0;this.d.w=a.f||18;this.d.h=a.j||18;this.d.t=a.text||"";this.type=Q(this.d,"it");this.scale=Q(this.d,"is");this.color=Q(this.d,"ic");this.alpha=Q(this.d,"ia");this.lineWidth=Q(this.d,"lw");this.x=Q(this.d,"x");this.y=Q(this.d,"y");this.f=Q(this.d,"w");this.j=Q(this.d,"h");this.text=Q(this.d,"t");
this.ja="is ic ia x y w h t".split(" ");this.offset=new G(0,0)}h=W.prototype;h.ub=function(){var a={};a.x=this.x()+this.offset.x;a.y=this.y()+this.offset.y;this.offset.x=0;this.offset.y=0;return a};function Td(a){a=a||{};return{type:a.it,scale:a.is,color:a.ic,alpha:a.ia,lineWidth:a.lw,x:a.x,y:a.y,f:a.w,j:a.h,text:a.t}}h.Jb=function(a){this.offset.x=a.x;this.offset.y=a.y};h.mb=function(){var a={},b;for(b in this.d)a[b]=this.d[b];return a};
h.xb=function(){var a=this,b={};E(this.ja,function(c){b[c]=a.d[c]});return b};h.Ib=function(a){var b=this;E(this.ja,function(c){void 0!==a[c]&&(b.d[c]=a[c])})};function re(a,b){a=a||{};a.f||(a.f=10);a.j||(a.j=10);W.call(this,a,b);this.type(Fd)}w(re,W);re.prototype.da=function(a,b){var c=this.scale(),d=this.f()*c,e=this.j()*c,c=this.lineWidth()*c/2+6;return $c(new G(a,b),new G(this.x()-d/2,this.y()-e/2),new G(this.x()+d/2,this.y()+e/2))<c||$c(new G(a,b),new G(this.x()+d/2,this.y()-e/2),new G(this.x()-d/2,this.y()+e/2))<c?!0:!1};function X(a,b){this.canvas=a;this.id=b}h=X.prototype;h.oa=function(){};h.xa=function(){};h.ya=function(){};h.Za=function(){};h.La=function(){};function se(a,b){X.call(this,a,b);this.xc=this.mc=this.F=null}w(se,X);function te(a){var b=a.canvas;b.offset.x+=b.gc||0;b.offset.y+=b.hc||0;b.gc=0;b.hc=0;ke(a.mc);ke(a.xc)}function ue(a,b){te(a);ve(a.canvas);var c=b.clientX,d=b.clientY;a.mc=I(document.body,Od,function(b){var f=a.canvas,g=b.clientX-c;b=b.clientY-d;g=F(g,f.Jc,f.Hc);b=F(b,f.Kc,f.Ic);f.gc=g;f.hc=b;f.view.k.style.left=f.offset.x+g+"px";f.view.k.style.top=f.offset.y+b+"px"});a.xc=I(document.body,Pd,function(){te(a)})}h=se.prototype;
h.Na=function(){this.F=null};h.oa=function(a,b){var c=this,d=!0;this.F&&this.ya(a,b);this.F=b;we(this.canvas.c,function(a){if(a.da(b.x,b.y,c.canvas.selected==a.id))return c.canvas.selected=a.id,L.i(yd),L.i(U),d=!1,!0});d&&(this.canvas.selected=null,L.i(yd),L.i(U),ue(this,a))};h.xa=function(a,b){var c=this;this.F&&(E(rd(this.canvas),function(a){a.Jb(new G(b.x-c.F.x,b.y-c.F.y))}),L.i(U))};
h.ya=function(a,b){var c=this;if(this.F){var d=b.x-this.F.x,e=b.y-this.F.y;(2<Math.abs(d)||2<Math.abs(e))&&E(rd(this.canvas),function(a){var b=a.ub(new G(d,e));b.id=a.id;O(c.canvas,new N(4,b))})}this.F=null};
h.Za=function(a,b){var c=this;we(this.canvas.c,function(a){if(0==a.type()&&a.da(b.x,b.y,c.canvas.selected==a.id))return L.i(R,Kd),!0;if(a.type()==Id&&a.da(b.x,b.y,c.canvas.selected==a.id)){var e=prompt(M("Enter text for the belay:"),a.text());if(null!==e&&e!=a.text()){var f={id:a.id};f.t=e;O(c.canvas,new N(4,f))}return!0}if(5==a.type()&&a.da(b.x,b.y,c.canvas.selected==a.id))return L.i(Md,function(b){if(null!==b&&b!=a.text()){var e={id:a.id};e.t=b;O(c.canvas,new N(4,e))}},a.text()),!0})};function xe(a,b){a=a||{};a.f||(a.f=12);a.j||(a.j=12);W.call(this,a,b);this.type(Gd)}w(xe,W);xe.prototype.da=function(a,b){var c=this.lineWidth()*this.scale()/2+1,d=this.f()*this.scale(),e=this.j()*this.scale();if(Math.abs(a-this.x())>d/2+c||Math.abs(b-this.y())>e/2+c)return!1;d=this.x()-0.1*d;e=this.y()+0.1*e;return a<d-c||a>d+c&&b>e+c?!1:!0};function ye(a,b,c){this.ua=a;this.yc=6;this.p=!0;this.Ya=this.A=this.u=this.overflow=0;this.o=null;this.A=b;this.u=c;this.Ya=this.A+this.u;this.p=!0;this.overflow=0;this.o={x:0,y:0}}h=ye.prototype;h.moveTo=function(a,b){Y(this,a,b)};
h.lineTo=function(a,b){var c=a-this.o.x,d=b-this.o.y,e=Math.atan2(d,c),f=Math.cos(e),e=Math.sin(e),c=Vc(0,0,c,d);if(this.overflow){if(this.overflow>c){this.p?ze(this,a,b):Y(this,a,b);this.overflow-=c;return}this.p?ze(this,this.o.x+f*this.overflow,this.o.y+e*this.overflow):Y(this,this.o.x+f*this.overflow,this.o.y+e*this.overflow);c-=this.overflow;this.overflow=0;this.p=!this.p;if(!c)return}if(d=Math.floor(c/this.Ya)){for(var g=f*this.A,k=e*this.A,m=f*this.u,l=e*this.u,n=0;n<d;n++)this.p?(ze(this,this.o.x+
g,this.o.y+k),Y(this,this.o.x+m,this.o.y+l)):(Y(this,this.o.x+m,this.o.y+l),ze(this,this.o.x+g,this.o.y+k));c-=this.Ya*d}this.p?c>this.A?(ze(this,this.o.x+f*this.A,this.o.y+e*this.A),Y(this,a,b),this.overflow=this.u-(c-this.A),this.p=!1):(ze(this,a,b),c==this.A?(this.overflow=0,this.p=!this.p):(this.overflow=this.A-c,Y(this,a,b))):c>this.u?(Y(this,this.o.x+f*this.u,this.o.y+e*this.u),ze(this,a,b),this.overflow=this.A-(c-this.u),this.p=!0):(Y(this,a,b),c==this.u?(this.overflow=0,this.p=!this.p):this.overflow=
this.u-c)};
h.quadraticCurveTo=function(a,b,c,d){var e=this.o.x,f=this.o.y,g=Wc(e,f,a,b,c,d,this.yc),k=0,m=0,l;if(this.overflow){if(this.overflow>g){this.p?Ae(this,a,b,c,d):Y(this,c,d);this.overflow-=g;return}k=this.overflow/g;l=Yc(e,f,a,b,c,d,k);this.p?Ae(this,l[2],l[3],l[4],l[5]):Y(this,l[4],l[5]);this.overflow=0;this.p=!this.p;if(!g)return}var n;n=Math.floor((g-g*k)/this.Ya);var t=this.A/g,s=this.u/g;if(n)for(var x=0;x<n;x++)this.p?(m=k+t,l=Xc(e,f,a,b,c,d,k,m),Ae(this,l[2],l[3],l[4],l[5]),k=m,m=k+s,l=Xc(e,
f,a,b,c,d,k,m),Y(this,l[4],l[5])):(m=k+s,l=Xc(e,f,a,b,c,d,k,m),Y(this,l[4],l[5]),k=m,m=k+t,l=Xc(e,f,a,b,c,d,k,m),Ae(this,l[2],l[3],l[4],l[5])),k=m;n=g-g*k;this.p?n>this.A?(l=Xc(e,f,a,b,c,d,k,k+t),Ae(this,l[2],l[3],l[4],l[5]),Y(this,c,d),this.overflow=this.u-(n-this.A),this.p=!1):(l=Zc(e,f,a,b,c,d,k),Ae(this,l[2],l[3],l[4],l[5]),g==this.A?(this.overflow=0,this.p=!this.p):(this.overflow=this.A-n,Y(this,c,d))):n>this.u?(m=k+s,l=Xc(e,f,a,b,c,d,k,m),Y(this,l[4],l[5]),l=Zc(e,f,a,b,c,d,m),Ae(this,l[2],l[3],
l[4],l[5]),this.overflow=this.A-(n-this.u),this.p=!0):(Y(this,c,d),n==this.u?(this.overflow=0,this.p=!this.p):this.overflow=this.u-n)};h.beginPath=function(){this.ua.beginPath()};h.stroke=function(){this.ua.stroke()};h.clearRect=function(a,b,c,d){this.ua.clearRect(a,b,c,d)};h.Ia=function(){this.o=this.ua=null};function Y(a,b,c){a.o={x:b,y:c};a.ua.moveTo(b,c)}function ze(a,b,c){if(b!=a.o.x||c!=a.o.y)a.o={x:b,y:c},a.ua.lineTo(b,c)}
function Ae(a,b,c,d,e){if(b!=d||c!=e||d!=a.o.x||e!=a.o.y)a.o={x:d,y:e},a.ua.quadraticCurveTo(b,c,d,e)};function Be(a,b){a=a||{};this.p=!0;this.id=oe(a.id);this.d={};this.d.it=0;this.d.is=a.scale||b.is;this.d.ic=a.color||b.ic;this.d.ia=a.alpha||b.ia;this.d.lw=a.lineWidth||3;this.d.cp=a.D||[];this.d.nl=a.A||b.nl;this.d.fl=r(a.u)?a.u:b.fl;this.d.lc=a.Xa||b.lc;this.type=Q(this.d,"it");this.scale=Q(this.d,"is");this.color=Q(this.d,"ic");this.alpha=Q(this.d,"ia");this.lineWidth=Q(this.d,"lw");this.D=Q(this.d,"cp");this.A=Q(this.d,"nl");this.u=Q(this.d,"fl");this.Xa=Q(this.d,"lc");this.ja="is ic ia lw cp nl fl lc".split(" ");
this.offset=new G(0,0);this.qa=[];Ce(this)}function De(a,b,c,d,e,f){var g=[],k=Wc(a,b,c,d,e,f),m=0,l=0,n=Math.floor(k/10),k=10/k;if(n){for(var t=0;t<n;t++)l=m+k,m=Xc(a,b,c,d,e,f,m,l),g.push(new G(m[4],m[5])),m=l;g.push(new G(e,f))}return g}h=Be.prototype;h.ub=function(){var a=this,b=[],c={};E(this.D(),function(c){b.push(new G(c.x+a.offset.x,c.y+a.offset.y))});this.offset.x=0;this.offset.y=0;c.cp=b;return c};
function Ud(a){a=a||{};var b={type:a.it,scale:a.is,color:a.ic,alpha:a.ia,lineWidth:a.lw,A:a.nl,u:a.fl,Xa:a.lc};if(a.cp&&fa(a.cp)){var c=[];E(a.cp,function(a){c.push(new G(a.x,a.y))});b.D=c}return b}h.Jb=function(a){this.offset=a};h.mb=function(){var a={},b;for(b in this.d)a[b]=this.d[b];if(a.cp&&fa(a.cp)){var c=[];E(a.cp,function(a){c.push({x:a.x,y:a.y})});a.cp=c}return a};h.xb=function(){var a=this,b={};E(this.ja,function(c){b[c]=a.d[c]});return b};
h.Ib=function(a){var b=this;E(this.ja,function(c){void 0!==a[c]&&(b.d[c]=a[c])})};h.da=function(a,b){for(var c=this.qa,d=this.lineWidth()*this.scale()/2+6,e=0,f=c.length-1;e<f;e++)if($c(new G(a,b),c[e],c[e+1])<d)return!0;return!1};function Ee(a){if(0===a.D().length)a.O=null;else{var b=Number.MAX_VALUE,c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=-Number.MAX_VALUE;E(a.D(),function(a){b=Math.min(b,a.x);c=Math.max(c,a.x);d=Math.min(d,a.y);e=Math.max(e,a.y)});a.O=new Uc(b,d,c-b,e-d)}}
function Ce(a){var b=[];if(a.Xa()){var c=a.D(),d=c.length;E(c,function(a,f){if(0===f)b.push(new G(a.x,a.y));else{var g=c[f-1];1==f?b.push(new G((a.x+g.x)/2,(a.y+g.y)/2)):b=b.concat(De(b[b.length-1].x,b[b.length-1].y,g.x,g.y,(a.x+g.x)/2,(a.y+g.y)/2));f==d-1&&b.push(new G(a.x,a.y))}})}else E(a.D(),function(a){b.push(new G(a.x,a.y))});a.qa=b};function Fe(a,b,c){X.call(this,a,b);this.qa=[];this.J=this.B=this.Ma=null;this.zc=c}w(Fe,X);Fe.prototype.oa=function(a,b){this.B&&this.B.D(Ge(this));this.qa.push(new G(b.x,b.y));if(this.B){var c={id:this.B.id};c.cp=Ge(this);O(this.canvas,new N(4,c))}else 1<this.qa.length?(Ke(this),c=new N(2,{D:Ge(this)}),O(this.canvas,c),this.B=this.canvas.c.getItem(c.q.id)):(this.Ma=new G(b.x,b.y),this.J=this.zc,this.J.D(Ge(this,this.Ma)),this.J.A(this.canvas.c.d.nl),this.J.u(this.canvas.c.d.fl),L.i(U))};
Fe.prototype.xa=function(a,b){var c=this.B||this.J;c&&(this.Ma=new G(b.x,b.y),c.D(Ge(this,this.Ma)),Ce(c),L.i(U))};Fe.prototype.La=function(a){if(13==a.keyCode&&this.B)return this.Na(),!0};Fe.prototype.Na=function(){this.B&&(this.B.D(Ge(this)),Ce(this.B),L.i(U));this.qa=[];this.B=this.Ma=null;Ke(this)};function Ge(a,b){return b?a.qa.concat([b]):a.qa.concat([])}function Ke(a){a.J&&a.J.D([new G(0,0)]);a.J=null};function Le(a,b){a=a||{};a.lineWidth||(a.lineWidth=2);W.call(this,a,b);this.type(Id)}w(Le,W);Le.prototype.da=function(a,b){var c=this.lineWidth()*this.scale()/2+1;return sb(new G(a,b),new G(this.x(),this.y()))<=this.f()*this.scale()/2+c?!0:!1};function Z(a){this.c=a;this.padding=this.la=10;this.R=this.Q=null;this.canvas=document.createElement("CANVAS");this.canvas.width=this.c.f()+2*this.padding;this.canvas.height=this.c.j()+2*this.padding;this.canvas.style.position="absolute"}h=Z.prototype;h.M=function(){};
h.Ua=function(a){a=a||1;var b=a*this.c.scale(),c=Math.round(b*this.c.f())+2*this.padding,b=Math.round(b*this.c.j())+2*this.padding;this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c/2)+"px";this.canvas.style.top=Math.round(a*(this.c.y()+this.c.offset.y)-b/2)+"px"};
h.ha=function(a,b,c,d){this.padding=this.la*Math.max(1,b);var e=Math.round(b*this.c.f())+2*this.padding,f=Math.round(b*this.c.j())+2*this.padding;d||(a.canvas.width=e,a.canvas.height=f,a.clearRect(0,0,e,f));a.save();d&&a.translate(Math.round(this.c.x()-e/2),Math.round(this.c.y()-f/2));a.translate(this.padding,this.padding);a.scale(b,b);a.lineCap="round";c&&(a.save(),this.M(a,"rgba(255,0,0,0.75)",this.c.lineWidth()+4/b),a.restore());a.save();this.M(a,Bc(this.c.color()),this.c.lineWidth()+2/b);a.restore();
this.M(a);a.restore()};h.fa=function(a,b){a=a||1;var c=a*this.c.scale(),d={f:this.c.f(),j:this.c.j(),color:this.c.color(),alpha:this.c.alpha(),scale:c,selected:b,text:this.c.text()},e={x:this.c.x(),y:this.c.y(),f:this.c.f(),j:this.c.j(),Xb:this.c.offset.x,Yb:this.c.offset.y,scale:c};nd(d,this.Q)||(this.Q=d,d=this.canvas.getContext("2d"),this.ha(d,c,b));nd(e,this.R)||(this.R=e,this.Ua(a))};h.Pa=function(a){a.save();this.ha(a,this.c.scale(),!1,!0);a.restore()};
h.Ia=function(){this.R=this.Q=this.c=null;Jb(this.canvas);this.canvas=null};function Me(a,b){a=a||{};a.lineWidth||(a.lineWidth=2);W.call(this,a,b);this.type(Hd)}w(Me,W);Me.prototype.da=function(a,b){var c=this.lineWidth()*this.scale()/2+1;return sb(new G(a,b),new G(this.x(),this.y()))<=this.f()*this.scale()/2+c?!0:!1};function Ne(a){Z.call(this,a);this.c=a}w(Ne,Z);Ne.prototype.M=function(a,b,c){a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();b=this.c.f();c=this.c.j();var d=Math.min(this.c.f(),this.c.j())/2;a.moveTo(b/2+d*Math.cos(0),c/2+d*Math.sin(0));a.arc(b/2,c/2,d,0,2*Math.PI,!1);a.moveTo(b/2,0.25*c);a.lineTo(b/2,0.75*c);a.moveTo(0.25*b,c/2);a.lineTo(b/2,0.75*c);a.lineTo(0.75*b,c/2);a.stroke()};function Oe(a){Z.call(this,a);this.c=a}w(Oe,Z);Oe.prototype.M=function(a,b,c){var d=this.c.f(),e=this.c.j(),f=0.3*e;a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(0.4*d,e);a.lineTo(0.4*d,0);a.lineTo(d-f,0);a.arc(d-f,f,f,-Math.PI/2,Math.PI/2,!1);a.lineTo(0.4*d,2*f);a.stroke()};function Pe(a,b){a=a||{};this.Gc=!0;this.id=oe(a.id);this.d={};this.d.it=5;this.d.is=a.scale||b.is;this.d.ic=a.color||b.ic;this.d.ia=a.alpha||b.ia;this.d.x=a.x||0;this.d.y=a.y||0;this.d.t=a.text||"";this.d.ta=a.textAlign||b.ta;this.d.tb=a.ra||b.tb;this.type=Q(this.d,"it");this.scale=Q(this.d,"is");this.color=Q(this.d,"ic");this.alpha=Q(this.d,"ia");this.x=Q(this.d,"x");this.y=Q(this.d,"y");this.text=Q(this.d,"t");this.textAlign=Q(this.d,"ta");this.ra=Q(this.d,"tb");this.ja="is ic ia x y t ta tb".split(" ");
this.offset=new G(0,0);this.P=null;this.Qb=0;this.L=[]}h=Pe.prototype;h.ub=function(){var a={};a.x=this.x()+this.offset.x;a.y=this.y()+this.offset.y;this.offset.x=0;this.offset.y=0;return a};function Qe(a){var b=qa(a.text()).replace(/\n\r/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ").split("\n"),c=0,d=[];E(b,function(a){d.push({text:a,top:c,size:12,width:-1,bold:!1,ab:!1});c+=18});a.L=d}
function Vd(a){a=a||{};return{type:a.it,scale:a.is,color:a.ic,alpha:a.ia,x:a.x,y:a.y,text:a.t,textAlign:a.ta,ra:a.tb}}h.Jb=function(a){this.offset.x=a.x;this.offset.y=a.y};h.mb=function(){var a={},b;for(b in this.d)a[b]=this.d[b];return a};h.xb=function(){var a=this,b={};E(this.ja,function(c){b[c]=a.d[c]});return b};h.Ib=function(a){var b=this;E(this.ja,function(c){void 0!==a[c]&&(b.d[c]=a[c])})};
h.da=function(a,b,c){if(!this.P)return!1;var d=this.scale(),e=this.textAlign(),f=new Uc(this.x(),this.y(),this.P.x*this.scale(),this.P.y*this.scale()),g=this.ra()||c?this.Qb:0;"c"==e?f.x-=f.f/2:"r"==e&&(f.x-=f.f);if(Math.abs(a-f.x-f.f/2)>f.f/2+g||Math.abs(b-f.y-f.j/2)>f.j/2+g)return!1;if(this.ra()||c)return!0;for(var g=c=0,k=this.L.length;g<k;g++)if(c=this.L[g].width*d,-1<c&&a>=f.x+("c"==e?f.f/2-c/2:"r"==e?f.f-c:0)&&a<=f.x+("c"==e?f.f/2+c/2:"r"==e?f.f:c)&&b>=f.y+this.L[g].top*d&&b<=f.y+(g+1<k?this.L[g+
1].top:this.L[g].top+this.L[g].size)*d)return!0;return!1};function Re(a){this.c=a;this.padding=this.la=15;this.P=this.R=this.Q=null;this.canvas=document.createElement("CANVAS");this.canvas.style.position="absolute"}h=Re.prototype;
h.M=function(a,b,c){var d,e,f,g=void 0===b;switch(this.c.textAlign()){case "c":a.textAlign="center";break;case "r":a.textAlign="right";break;default:a.textAlign="left"}a.textBaseline="top";a.fillStyle=this.c.color();a.strokeStyle=b||this.c.color();a.lineWidth=c||0;E(this.c.L,function(b){if(d!=b.size||e!=b.bold||f!=b.ab)d=b.size,e=b.bold,f=b.ab,a.font=Se(b.ab,b.bold,b.size);g?a.fillText(b.text,0,b.top):a.strokeText(b.text,0,b.top)})};
function Se(a,b,c){var d="";a&&(d+="italic ");b&&(d+="bold ");return d+c+"px Arial, Helvetica, sans-serif"}function Te(a,b){var c=0;b.save();E(a.c.L,function(a){b.font=Se(a.ab,a.bold,a.size);a.width=b.measureText(a.text).width;c=Math.min(2048,Math.max(a.width,c))});b.restore();return new G(c,a.c.L[a.c.L.length-1].top+a.c.L[a.c.L.length-1].size)}
h.Ua=function(a){a=a||1;var b=a*this.c.scale(),c=Math.round(b*this.P.x)+2*this.padding;Math.round(b*this.P.y);switch(this.c.textAlign()){case "c":this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c/2)+"px";break;case "r":this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c+this.padding)+"px";break;default:this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-this.padding)+"px"}this.canvas.style.top=Math.round(a*(this.c.y()+this.c.offset.y)-this.padding)+"px"};
h.ha=function(a,b,c,d){this.padding=this.la*Math.max(1,b);Qe(this.c);this.P=Te(this,a);var e=this.c,f=this.padding;e.P=this.P;e.Qb=f;e=Math.round(b*this.P.x)+2*this.padding;f=Math.round(b*this.P.y)+2*this.padding;d||(a.canvas.width=e,a.canvas.height=f,a.clearRect(0,0,e,f));a.save();if(d)switch(a.translate(this.c.x(),this.c.y()),this.c.textAlign()){case "c":a.translate(-e/2,-this.padding);break;case "r":a.translate(-e+this.padding,-this.padding);break;default:a.translate(-this.padding,-this.padding)}this.c.ra()&&
(a.save(),a.fillStyle=Bc(this.c.color()),a.fillRect(0,0,e,f),a.restore());c&&(a.save(),a.strokeStyle="rgba(255,0,0,0.75)",a.lineWidth=1,a.strokeRect(0.5,0.5,e-1,f-1),a.restore());switch(this.c.textAlign()){case "c":a.translate(e/2,this.padding);break;case "r":a.translate(e-this.padding,this.padding);break;default:a.translate(this.padding,this.padding)}a.scale(b,b);a.lineCap="round";this.c.ra()||(a.save(),this.M(a,Bc(this.c.color()),2/b),a.restore());this.M(a);a.restore()};
h.fa=function(a,b){a=a||1;var c=a*this.c.scale(),d={color:this.c.color(),alpha:this.c.alpha(),scale:c,selected:b,text:this.c.text(),textAlign:this.c.textAlign(),ra:this.c.ra()},e={x:this.c.x(),y:this.c.y(),Xb:this.c.offset.x,Yb:this.c.offset.y,scale:c,textAlign:this.c.textAlign()};nd(d,this.Q)||(this.Q=d,d=this.canvas.getContext("2d"),this.ha(d,c,b));nd(e,this.R)||(this.R=e,this.Ua(a))};h.Pa=function(a){a.save();this.ha(a,this.c.scale(),!1,!0);a.restore()};
h.Ia=function(){this.R=this.Q=this.c=null;Jb(this.canvas);this.canvas=null};function Ue(a){Z.call(this,a);this.c=a}w(Ue,Z);
Ue.prototype.M=function(a,b,c){var d=void 0===b,e=this.c.f(),f=this.c.j(),g=Math.min(e,f)/2;a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(e/2+g*Math.cos(0),f/2+g*Math.sin(0));a.arc(e/2,f/2,g,0,2*Math.PI,!1);a.stroke();this.c.text()&&(a.font="12px Arial, Helvetica, sans-serif",a.textAlign="center",a.textBaseline="middle",d?(a.fillStyle=this.c.color(),a.fillText(this.c.text(),e/2,f/2)):(a.strokeStyle=b||this.c.color(),a.lineWidth=Math.min(2,(c||this.c.lineWidth())-
this.c.lineWidth()),a.strokeText(this.c.text(),e/2,f/2)))};function Ve(a,b){this.sa=a;this.ac=b;this.j=b.height;this.f=b.width;this.scale=1;this.G=[0.125,1/6,0.25,1/3,0.5,2/3,1,2,3,4,5,6,7,8,12,16];this.items=[];this.d={};this.d.is=1;this.d.ic="#ffff00";this.d.ia=1;this.d.nl=10;this.d.fl=10;this.d.lc=!1;this.d.ta="l";this.d.tb=!1;this.J=new Be({D:[new G(0,0)]},this.d);this.items.push(this.J)}Ve.prototype.removeItem=function(a){pb(this.items,a)};function We(a){a.items=[];a.items.push(a.J)}
Ve.prototype.getItem=function(a){return ob(this.items,function(b){return b.id==a})};function we(a,b){for(var c=a.items.length-1;0<=c&&(a.items[c]==a.J||!0!==b(a.items[c]));c--);}function Xe(a,b,c){for(var d=0,e=a.items.length;d<e&&(!c&&a.items[d]==a.J||!0!==b(a.items[d]));d++);}
Ve.prototype.Ob=function(){for(var a=0,b=this.G.length;a<b;a++)if(1E-6>=Math.abs(this.G[a]-this.scale)){this.scale=this.G[F(a-1,0,b-1)];break}else if(this.scale>this.G[a]&&(!this.G[a+1]||this.scale<this.G[a+1])){this.scale=this.G[a];break}};Ve.prototype.Nb=function(){for(var a=0,b=this.G.length;a<b;a++)if(1E-6>=Math.abs(this.G[a]-this.scale)){this.scale=this.G[F(a+1,0,b-1)];break}else if(this.scale>this.G[a]&&this.G[a+1]&&this.scale<this.G[a+1]){this.scale=this.G[a+1];break}};function Ye(a){Z.call(this,a);this.c=a}w(Ye,Z);Ye.prototype.M=function(a,b,c){a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(0,0);a.lineTo(this.c.f(),this.c.j());a.moveTo(this.c.f(),0);a.lineTo(0,this.c.j());a.stroke()};function Ze(a){this.c=a;this.padding=this.la=10;this.R=this.Q=null;this.canvas=document.createElement("canvas");this.canvas.width=2*this.padding;this.canvas.height=2*this.padding;this.canvas.style.position="absolute"}
function $e(a,b,c,d){var e=a.c.scale(),f=0<a.c.u();b.strokeStyle=c||a.c.color();b.lineWidth=d||a.c.lineWidth()*e;var g=f?new ye(b,a.c.A()*e,a.c.u()*e):b;g.beginPath();if(a.c.Xa()){var k=a.c.D(),m=k.length;E(k,function(a,b){if(0===b)g.moveTo(a.x,a.y);else{var c=k[b-1];1==b?g.lineTo((a.x+c.x)/2,(a.y+c.y)/2):g.quadraticCurveTo(c.x,c.y,(a.x+c.x)/2,(a.y+c.y)/2);b==m-1&&g.lineTo(a.x,a.y)}})}else E(a.c.D(),function(a,b){0===b?g.moveTo(a.x,a.y):g.lineTo(a.x,a.y)});g.stroke();f&&g.Ia()}h=Ze.prototype;
h.M=function(a,b,c){var d=this.c.scale();a.save();a.lineCap="round";c?(a.save(),$e(this,a,"rgba(255,0,0,0.75)",this.c.lineWidth()*d+4/b)):(a.save(),$e(this,a,Bc(this.c.color()),this.c.lineWidth()*d+2/b));a.restore();$e(this,a);a.restore()};function af(a,b,c){c=c||1;var d=a.c.color(),e=Bc(d),f=7/c;b.save();E(a.c.D(),function(a){b.beginPath();b.moveTo(a.x+f,a.y);b.arc(a.x,a.y,f,0,2*Math.PI,!1);b.strokeStyle=e;b.lineWidth=6/c;b.stroke();b.strokeStyle=d;b.lineWidth=4/c;b.stroke()});b.restore()}
h.Ua=function(a){a=a||1;this.canvas.style.left=Math.round(a*(this.c.offset.x+this.c.O.x)-this.padding)+"px";this.canvas.style.top=Math.round(a*(this.c.offset.y+this.c.O.y)-this.padding)+"px"};
h.ha=function(a,b,c,d,e){this.padding=this.la*Math.max(1,this.c.scale()*b);Ee(this.c);Ce(this.c);var f=Math.round(b*this.c.O.f)+2*this.padding,g=Math.round(b*this.c.O.j)+2*this.padding;e||(a.canvas.width=f,a.canvas.height=g,a.clearRect(0,0,f,g));a.save();e||a.translate(this.padding-Math.round(b*this.c.O.x),this.padding-Math.round(b*this.c.O.y));a.scale(b,b);this.M(a,b,c);c&&d==Kd&&af(this,a,b);a.restore()};
h.fa=function(a,b,c){a=a||1;var d=this.c.mb();d.scale=a;d.selected=!!b;d.mode=c||null;nd(d,this.Q)||(this.Q=d,d=this.canvas.getContext("2d"),this.ha(d,a,b,c));b={Xb:this.c.offset.x,Yb:this.c.offset.y,x:this.c.O.x,y:this.c.O.y,f:this.c.O.f,j:this.c.O.j,scale:a*this.c.scale()};nd(b,this.R)||(this.R=b,this.Ua(a))};h.Pa=function(a){a.save();this.ha(a,1,!1,null,!0);a.restore()};h.Ia=function(){this.R=this.Q=this.c=null;Jb(this.canvas);this.canvas=null};function bf(a,b){this.sa=a;this.c=b;this.Hb=1;this.Db=!0;this.eb=!1;this.k=Gb("DIV","canvas-container");this.k.appendChild(this.c.ac);this.ec=Gb("DIV","fullsize");this.k.appendChild(this.ec);this.Ca={};setInterval(u(this.Tb,this),10);K(L,U,u(this.Dc,this))}bf.prototype.Dc=function(a){this.Db=!0;a&&this.Tb()};bf.prototype.Tb=function(){this.Db&&this.fa(this.c.scale);this.Db=!1};
bf.prototype.fa=function(a){var b=this,c={};Xe(this.c,function(d){a:{var f=a,f=f||1,g=b.Ca[d.id];if(!g){switch(d.type()){case Fd:g=new Ye(d);break;case Gd:g=new Oe(d);break;case Hd:g=new Ne(d);break;case Id:g=new Ue(d);break;case 5:g=new Re(d);break;case 0:g=new Ze(d)}if(!g)break a;b.Ca[d.id]=g;b.ec.appendChild(g.canvas)}g.fa(f,b.sa.selected==d.id,b.sa.mode.id)}c[d.id]=!0},!0);for(var d in this.Ca)c[d]||(this.Ca[d].Ia(),delete this.Ca[d]);if(this.c.scale!=this.Hb||this.eb)Nb(this.k,{width:Math.round(this.c.scale*
this.c.f)+"px",height:Math.round(this.c.scale*this.c.j)+"px"}),this.eb?(cf(this.sa),this.eb=!1):df(this.sa,this.c.scale/this.Hb),this.k.style.left=this.sa.offset.x+"px",this.k.style.top=this.sa.offset.y+"px";this.Hb=this.c.scale};bf.prototype.Pa=function(a){var b=this;Xe(this.c,function(c){b.Ca[c.id]&&b.Ca[c.id].Pa(a)})};function ef(a,b){X.call(this,a,b);this.za=this.Y=this.B=this.F=null}w(ef,X);h=ef.prototype;h.Fb=function(){var a=this;nb(rd(this.canvas),function(b){return 0==b.type()?(a.B=b,L.i(U),!0):!1})};h.Na=function(){this.za=this.Y=this.B=this.F=null;L.i(U)};h.oa=function(a,b){this.F&&this.ya(a,b);if(this.B){var c=this;nb(this.B.D(),function(a){var e=b.x-a.x,f=b.y-a.y;return 100>e*e+f*f?(c.Y=a,c.za=a.clone(),!0):!1});this.Y?this.F=b:L.i(R,Ad)}};
h.xa=function(a,b){this.F&&this.B&&this.Y&&(this.Y.x=this.za.x+b.x-this.F.x,this.Y.y=this.za.y+b.y-this.F.y,Ce(this.B),L.i(U))};h.ya=function(a,b){this.xa(a,b);if(this.F&&this.B&&this.Y){var c=[];E(this.B.D(),function(a){c.push(a.clone())});this.Y.x=this.za.x;this.Y.y=this.za.y;var d={id:this.B.id};d.cp=c;O(this.canvas,new N(4,d))}this.za=this.Y=this.F=null};h.La=function(a){if(13==a.keyCode)return L.i(R,Ad),!0};function ff(a,b){X.call(this,a,b);this.Da=null}w(ff,X);ff.prototype.Fb=function(a){this.Da=r(a)?a:null};ff.prototype.oa=function(a,b){null!==this.Da&&O(this.canvas,new N(1,{type:this.Da,x:b.x,y:b.y}))};function gf(a,b){X.call(this,a,b)}w(gf,X);gf.prototype.oa=function(a,b){var c=this;L.i(Md,function(a){a&&O(c.canvas,new N(3,{text:a,x:b.x,y:b.y}))},M("Enter some text"))};function hf(a,b){var c=this;this.C=a;this.c=new Ve(this,b);this.view=new bf(this,this.c);this.offset=new G;this.selected=null;pd=this;this.na={};this.na[Ad]=new se(this,Ad);this.na[Ed]=new Fe(this,Ed,this.c.J);this.na[T]=new ff(this,T);this.na[Jd]=new gf(this,Jd);this.na[Kd]=new ef(this,Kd);var d=null;K(L,R,function(a,b){if(c.na[a]){var g=c.mode!=c.na[a]||d!=b;g&&c.mode&&c.mode.Na&&c.mode.Na();c.mode=c.na[a];g&&c.mode.Fb&&c.mode.Fb(b);d=b}});this.mode=null;this.Ta=[];this.Oa=[];this.Fa=0;this.rb=
[];setInterval(function(){td(c)},100)}function td(a){a.Fa=Math.max(0,a.Fa-1);0==a.Fa&&0<a.rb.length&&(a.Ta.unshift(a.rb),a.Oa=[],a.rb=[])}function jf(a,b){var c=b.clientX,d=b.clientY,e,f=document;e=f.body;f=f.documentElement;e=new G(e.scrollLeft||f.scrollLeft,e.scrollTop||f.scrollTop);f=Sb(a.C.va.viewport);return new G(Math.round((c+e.x-f.x-a.offset.x)/a.c.scale),Math.round((d+e.y-f.y-a.offset.y)/a.c.scale))}
function Sd(a){if(0!==a.Ta.length){var b=[];E(a.Ta[0],function(c){c=od(c);null!=c&&(c.Bb=!0,c.Ab=!1,b.unshift(c),O(a,c))});a.Ta.shift();a.Oa.unshift(b)}}function Rd(a){if(0!==a.Oa.length){var b=[];E(a.Oa[0],function(c){c=od(c);null!=c&&(c.Ab=!0,c.Bb=!1,b.unshift(c),O(a,c))});a.Oa.shift();a.Ta.unshift(b)}}
function O(a,b){var c;switch(b.type){case 1:switch(b.q.type){case Fd:c=new re(b.q,a.c.d);break;case Gd:c=new xe(b.q,a.c.d);break;case Hd:c=new Me(b.q,a.c.d);break;case Id:c=new Le(b.q,a.c.d)}if(c)b.q.id=c.id,a.c.items.push(c);else return;break;case 2:if(b.q.D&&1<b.q.D.length)c=new Be(b.q,a.c.d),b.q.id=c.id,a.c.items.push(c);else return;break;case 3:if(b.q.text)c=new Pe(b.q,a.c.d),b.q.id=c.id,a.c.items.push(c);else return;break;case 4:if(c=a.c.getItem(b.q.id)){if(!b.Eb){var d=c.xb(),e={id:b.q.id},
f;for(f in b.q)void 0!==d[f]&&(e[f]=d[f]);b.Eb=e}c.Ib(b.q)}else return;break;case 5:case 7:case 6:if(c=a.c.getItem(b.q.id))a.c.removeItem(c);else return;break;default:return}a.Fa++;b.Bb||b.Ab||a.rb.unshift(b);td(a);L.i(U);L.i(zd)}function rd(a){return a.selected?(a=a.c.getItem(a.selected))?[a]:[]:[]}h=hf.prototype;h.oa=function(a){this.mode.oa(a,jf(this,a))};h.xa=function(a){this.mode.xa(a,jf(this,a))};h.ya=function(a){this.mode.ya(a,jf(this,a))};h.Za=function(a){this.mode.Za(a,jf(this,a))};
h.La=function(a){return this.mode.La(a)};h.Ob=function(){L.i(U);this.c.Ob()};h.Nb=function(){L.i(U);this.c.Nb()};function kf(a,b){b=r(b)?b/100:"cover"==b?Math.max(a.C.H/a.c.f,a.C.K/a.c.j):Math.min(a.C.H/a.c.f,a.C.K/a.c.j);var c=a.c;c.scale=F(b,c.G[0],c.G[c.G.length-1]);L.i(U)}
function df(a,b){var c=b*(a.C.K/2-a.offset.y),d=a.c.f*a.c.scale,e=a.c.j*a.c.scale;a.offset.x=-Math.round(b*(a.C.H/2-a.offset.x)-a.C.H/2);a.offset.y=-Math.round(c-a.C.K/2);a.offset.x=d<=a.C.H?Math.round(a.C.H/2-d/2):F(a.offset.x,a.C.H-d,0);a.offset.y=e<=a.C.K?Math.round(a.C.K/2-e/2):F(a.offset.y,a.C.K-e,0)}function cf(a){a.offset.x=Math.round(a.C.H/2-a.c.f*a.c.scale/2);a.offset.y=Math.round(a.C.K/2-a.c.j*a.c.scale/2)}
function ve(a){var b=Math.round(a.c.f*a.c.scale),c=Math.round(a.c.j*a.c.scale);a.Jc=-Math.max(a.offset.x+b-a.C.H,0);a.Hc=Math.max(-a.offset.x,0);a.Kc=-Math.max(a.offset.y+c-a.C.K,0);a.Ic=Math.max(-a.offset.y,0)}
h.yb=function(a,b){L.i(U,!0);var c=document.createElement("CANVAS"),d=c.getContext("2d");b=a&&b&&"jpg"==b.toLowerCase()?"jpeg":"png";c.width=this.c.f;c.height=this.c.j;a&&d.drawImage(this.c.ac,0,0);this.view.Pa(d);try{return c.toDataURL("image/"+b)}catch(e){return alert("Source image must be from the same domain to be included in getImage. Try getImage() without any parameters."),""}};function lf(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);}function mf(a){return(new nf(void 0)).serialize(a)}function nf(a){this.lb=a}nf.prototype.serialize=function(a){var b=[];of(this,a,b);return b.join("")};
function of(a,b,c){switch(typeof b){case "string":pf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(fa(b)){a.serializeArray(b,c);break}c.push("{");var d="",e;for(e in b)if(Object.prototype.hasOwnProperty.call(b,e)){var f=b[e];"function"!=typeof f&&(c.push(d),pf(e,c),c.push(":"),of(a,a.lb?a.lb.call(b,e,f):f,c),d=",")}c.push("}");break;case "function":break;
default:throw Error("Unknown type: "+typeof b);}}var qf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},rf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function pf(a,b){b.push('"',a.replace(rf,function(a){if(a in qf)return qf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return qf[a]=e+b.toString(16)}),'"')}
nf.prototype.serializeArray=function(a,b){var c=a.length;b.push("[");for(var d="",e=0;e<c;e++)b.push(d),d=a[e],of(this,this.lb?this.lb.call(a,String(e),d):d,b),d=",";b.push("]")};function sf(a,b,c){c=c||{};this.q={f:c.width||null,j:c.height||null,zoom:c.zoom||"contain",parent:c.parent||null,pa:c.onChange||null};this.minWidth=556;this.nb=a;this.cc=!1;this.ib=[];b&&this.ib.push(b);var d=document.createElement("img");this.Cc=I(d,"load",function(){this.$(d)},!1,this);d.src=this.nb.src;c.pa&&K(L,zd,function(){c.pa()})}
sf.prototype.$=function(a){ke(this.Cc);this.m=new hf(this,a);this.va=new Ld(this);this.H=this.q.f||a.width;this.K=this.q.j||a.height;r(this.H)&&this.H<this.minWidth&&(this.H=this.minWidth);Nb(this.va.Ga,{position:"relative",display:"inherit"==this.nb.style.display?"inline-block":this.nb.style.display||"inline-block",width:r(this.H)?this.H+"px":this.H,height:r(this.K)?this.K+29+"px":this.K});this.q.parent?this.q.parent.appendChild(this.va.Ga):Kb(this.va.Ga,this.nb);r(this.H)||(this.H=Wb(this.va.Ga).width-
2);r(this.K)||(this.K=Wb(this.va.Ga).height-29-2);this.va.$();kf(this.m,this.q.zoom);this.cc=this.m.view.eb=!0;E(this.ib,function(a){a()});this.ib=[]};sf.prototype.jc=function(a){var b=this;We(this.m.c);E(a.items||[],function(a){var d=null;switch(a.it){case Fd:d=new re(Td(a),b.m.c.d);break;case Gd:d=new xe(Td(a),b.m.c.d);break;case Hd:d=new Me(Td(a),b.m.c.d);break;case Id:d=new Le(Td(a),b.m.c.d);break;case 0:d=new Be(Ud(a),b.m.c.d);break;case 5:d=new Pe(Vd(a),b.m.c.d)}d&&b.m.c.items.push(d)});L.i(U)};
sf.prototype.getData=function(a){var b=[];Xe(this.m.c,function(a){b.push(a.mb())});return a?za(Ca(mf({items:b}))):mf({items:b})};sf.prototype.yb=function(a,b){return this.m.yb(a,b)};var L=new Yd,U="cr",yd="sc",ld="scp",Md="sta",Qc="ho",R="m",zd="a",Ad=0,Ed=1,T=2,Jd=3,Kd=4;
aa("BetaCreator",function(a,b,c){var d,e=new sf(a,b?function(){b.call(d)}:null,c),f=c.onError||function(a){alert(a)};return d={loadData:function(a){try{a=lf(a),e.cc?e.jc(a):e.ib.push(function(){e.jc(a)})}catch(b){f(M("Invalid data."))}},getData:function(a){try{return e.getData(a)}catch(b){f(M("Editor hasn't been initialized yet, make calls in onReady callback."))}},getImage:function(a,b){try{return e.yb(a,b)}catch(c){f(M("Editor hasn't been initialized yet, make calls in onReady callback."))}}}});})();
