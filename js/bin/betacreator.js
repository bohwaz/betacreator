/**
 *  Copyright 2012 Alma Madsen
 *
 *  BetaCreator is Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
(function() {function j(a){throw a;}var k=void 0,m=!0,n=null,r=!1;function aa(){return function(){}}var s,t=this;function ba(a,b){var c=a.split("."),d=t;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==k?d[e]=b:d=d[e]?d[e]:d[e]={}}
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function da(a){return"array"==ca(a)}function u(a){return"string"==typeof a}function z(a){return"number"==typeof a}function ea(a){var b=typeof a;return"object"==b&&a!=n||"function"==b}function fa(a){return a[ga]||(a[ga]=++ha)}var ga="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ha=0;function ia(a,b,c){return a.call.apply(a.bind,arguments)}
function ka(a,b,c){a||j(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function A(a,b,c){A=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ka;return A.apply(n,arguments)}
function la(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}function B(a,b){function c(){}c.prototype=b.prototype;a.oc=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ma(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function na(a){if(!oa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(pa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(qa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(ra,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(sa,"&quot;"));return a}var pa=/&/g,qa=/</g,ra=/>/g,sa=/\"/g,oa=/[&<>\"]/,ta={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},ua={"'":"\\'"};var va,wa,xa,ya,za;function Aa(){return t.navigator?t.navigator.userAgent:n}function Ba(){return t.navigator}ya=xa=wa=va=r;var Ca;if(Ca=Aa()){var Da=Ba();va=0==Ca.indexOf("Opera");wa=!va&&-1!=Ca.indexOf("MSIE");xa=!va&&-1!=Ca.indexOf("WebKit");ya=!va&&!xa&&"Gecko"==Da.product}var Ea=va,C=wa,Fa=ya,D=xa,Ga=Ba();za=-1!=(Ga&&Ga.platform||"").indexOf("Mac");var Ha=!!Ba()&&-1!=(Ba().appVersion||"").indexOf("X11"),Ia;
a:{var Ja="",Ka;if(Ea&&t.opera)var La=t.opera.version,Ja="function"==typeof La?La():La;else if(Fa?Ka=/rv\:([^\);]+)(\)|;)/:C?Ka=/MSIE\s+([^\);]+)(\)|;)/:D&&(Ka=/WebKit\/(\S+)/),Ka)var Ma=Ka.exec(Aa()),Ja=Ma?Ma[1]:"";if(C){var Na,Oa=t.document;Na=Oa?Oa.documentMode:k;if(Na>parseFloat(Ja)){Ia=String(Na);break a}}Ia=Ja}var Pa={};
function E(a){var b;if(!(b=Pa[a])){b=0;for(var c=ma(String(Ia)).split("."),d=ma(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",i=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var p=i.exec(g)||["","",""],q=l.exec(h)||["","",""];if(0==p[0].length&&0==q[0].length)break;b=((0==p[1].length?0:parseInt(p[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==p[1].length?0:parseInt(p[1],10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==p[2].length)<
(0==q[2].length)?-1:(0==p[2].length)>(0==q[2].length)?1:0)||(p[2]<q[2]?-1:p[2]>q[2]?1:0)}while(0==b)}b=Pa[a]=0<=b}return b}var Qa={};function Ra(a){return Qa[a]||(Qa[a]=C&&!!document.documentMode&&document.documentMode>=a)};function Sa(a,b){for(var c in a)b.call(k,a[c],c,a)}var Ta="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ua(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Ta.length;f++)c=Ta[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var F=Array.prototype,Va=F.indexOf?function(a,b,c){return F.indexOf.call(a,b,c)}:function(a,b,c){c=c==n?0:0>c?Math.max(0,a.length+c):c;if(u(a))return!u(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},G=F.forEach?function(a,b,c){F.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=u(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Wa=F.filter?function(a,b,c){return F.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=u(a)?a.split(""):
a,h=0;h<d;h++)if(h in g){var i=g[h];b.call(c,i,h,a)&&(e[f++]=i)}return e},Xa=F.some?function(a,b,c){return F.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=u(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return m;return r};function Ya(a,b){var c=Va(a,b);0<=c&&F.splice.call(a,c,1)}function Za(a,b,c){return 2>=arguments.length?F.slice.call(a,b):F.slice.call(a,b,c)};function H(a,b,c){return Math.min(Math.max(a,b),c)};function I(a,b){this.x=a!==k?a:0;this.y=b!==k?b:0}I.prototype.clone=function(){return new I(this.x,this.y)};I.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function $a(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};function ab(a,b){this.width=a;this.height=b}s=ab.prototype;s.clone=function(){return new ab(this.width,this.height)};s.toString=function(){return"("+this.width+" x "+this.height+")"};s.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};s.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};s.scale=function(a){this.width*=a;this.height*=a;return this};var bb;function cb(a){a=a.className;return u(a)&&a.match(/\S+/g)||[]}function db(a,b){for(var c=cb(a),d=Za(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Va(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function eb(a,b){var c=cb(a),d=Za(arguments,1),c=Wa(c,function(a){return!(0<=Va(d,a))});a.className=c.join(" ")};var fb=!C||Ra(9),gb=!Fa&&!C||C&&Ra(9)||Fa&&E("1.9.1");C&&E("9");function hb(a){return a?new ib(jb(a)):bb||(bb=new ib)}function kb(a,b){Sa(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in lb?a.setAttribute(lb[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var lb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function mb(a,b,c){var d=arguments,e=document,f=d[0],g=d[1];if(!fb&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',na(g.name),'"');if(g.type){f.push(' type="',na(g.type),'"');var h={};Ua(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=e.createElement(f);g&&(u(g)?f.className=g:da(g)?db.apply(n,[f].concat(g)):kb(f,g));if(2<d.length)for(var i=e,l=f,e=function(a){a&&l.appendChild(u(a)?i.createTextNode(a):a)},g=2;g<d.length;g++){var p=d[g],h=ca(p);if(("array"==h||"object"==h&&"number"==typeof p.length)&&
!(ea(p)&&0<p.nodeType)){var q;a:{if(p&&"number"==typeof p.length){if(ea(p)){q="function"==typeof p.item||"string"==typeof p.item;break a}if("function"==ca(p)){q="function"==typeof p.item;break a}}q=r}h=G;if(q)if(q=p.length,0<q){for(var v=Array(q),y=0;y<q;y++)v[y]=p[y];p=v}else p=[];h(p,e)}else e(p)}return f}function nb(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function jb(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function ob(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(var c;c=a.firstChild;)a.removeChild(c);a.appendChild(jb(a).createTextNode(b))}}function ib(a){this.Ia=a||t.document||document}ib.prototype.createElement=function(a){return this.Ia.createElement(a)};ib.prototype.createTextNode=function(a){return this.Ia.createTextNode(a)};ib.prototype.appendChild=function(a,b){a.appendChild(b)};function pb(a,b){u(b)?qb(a,k,b):Sa(b,la(qb,a))}function qb(a,b,c){a.style[String(c).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})]=b}function rb(a,b){var c;a:{c=jb(a);if(c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,n))){c=c[b]||c.getPropertyValue(b)||"";break a}c=""}return c||(a.currentStyle?a.currentStyle[b]:n)||a.style&&a.style[b]}
function sb(a){var b=a.getBoundingClientRect();C&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function tb(a){if(C&&!Ra(8))return a.offsetParent;for(var b=jb(a),c=rb(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=rb(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return n}
function ub(a){var b,c=jb(a),d=rb(a,"position"),e=Fa&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new I(0,0),g;b=c?jb(c):document;if(g=C)if(g=!Ra(9))g="CSS1Compat"!=hb(b).Ia.compatMode;g=g?b.body:b.documentElement;if(a==g)return f;if(a.getBoundingClientRect)b=sb(a),c=hb(c).Ia,a=!D&&"CSS1Compat"==c.compatMode?c.documentElement:c.body,c=c.parentWindow||c.defaultView,a=new I(c.pageXOffset||a.scrollLeft,c.pageYOffset||a.scrollTop),
f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(D&&"fixed"==rb(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ea||D&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=tb(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Ea||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function vb(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function wb(a){if("none"!=rb(a,"display"))return xb(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=xb(a);b.display=c;b.position=e;b.visibility=d;return a}function xb(a){var b=a.offsetWidth,c=a.offsetHeight,d=D&&!b&&!c;return(b===k||d)&&a.getBoundingClientRect?(a=sb(a),new ab(a.right-a.left,a.bottom-a.top)):new ab(b,c)};function J(a){if(u(a)){var b=mb("SPAN");ob(b,a);return b}a.z=a.z||"DIV";var c=mb(a.z),d={id:a.id,"class":a.e,type:a.type,src:a.src,href:a.href,title:a.title,name:a.name,target:a.target,checked:a.checked,value:a.value},e={},f=r;for(b in d)d[b]!==k&&(e[b]=d[b],f=m);if(a.attr)for(b in a.attr)e[b]=a.attr[b],f=m;f&&kb(c,e);a.html&&(c.innerHTML=a.html);a.text&&ob(c,a.text);if(a.css)for(b in a.css)c.style[b]=a.css[b];if(a.children)for(b=0;b<a.children.length;b++)a.children[b]&&(d=J(a.children[b]),c.appendChild(d));
a.create&&a.create(c);a.click&&L(c,yb,function(b){a.click(b,c)});a.change&&L(c,zb,function(b){a.change(b,c)});return c};var Ab;Ab=function(){return m};/*
 Portions of this code are from the Dojo Toolkit, received by
 The Closure Library Authors under the BSD license. All other code is
 Copyright 2005-2009 The Closure Library Authors. All Rights Reserved.

The "New" BSD License:

Copyright (c) 2005-2009, The Dojo Foundation
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

 Redistributions of source code must retain the above copyright notice, this
    list of conditions and the following disclaimer.
 Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.
 Neither the name of the Dojo Foundation nor the names of its contributors
    may be used to endorse or promote products derived from this software
    without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
function Bb(a,b){var c=b||[];a&&c.push(a);return c}var Cb=D&&"BackCompat"==document.compatMode,Db=document.firstChild.children?"children":"childNodes",Eb=r;
function Fb(a){function b(){0<=l&&(x.id=c(l,w).replace(/\\/g,""),l=-1);if(0<=p){var a=p==w?n:c(p,w);0>">~+".indexOf(a)?x.z=a:x.fb=a;p=-1}0<=i&&(x.e.push(c(i+1,w).replace(/\\/g,"")),i=-1)}function c(b,c){return ma(a.slice(b,c))}for(var a=0<=">~+".indexOf(a.slice(-1))?a+" * ":a+" ",d=[],e=-1,f=-1,g=-1,h=-1,i=-1,l=-1,p=-1,q="",v="",y,w=0,ja=a.length,x=n,K=n;q=v,v=a.charAt(w),w<ja;w++)if("\\"!=q)if(x||(y=w,x={Da:n,Aa:[],Ua:[],e:[],z:n,fb:n,id:n,xb:function(){return Eb?this.Lc:this.z}},p=w),0<=e)if("]"==
v){K.attr?K.Ab=c(g||e+1,w):K.attr=c(e+1,w);if((e=K.Ab)&&('"'==e.charAt(0)||"'"==e.charAt(0)))K.Ab=e.slice(1,-1);x.Ua.push(K);K=n;e=g=-1}else"="==v&&(g=0<="|~^$*".indexOf(q)?q:"",K.type=g+v,K.attr=c(e+1,w-g.length),g=w+1);else 0<=f?")"==v&&(0<=h&&(K.value=c(f+1,w)),h=f=-1):"#"==v?(b(),l=w+1):"."==v?(b(),i=w):":"==v?(b(),h=w):"["==v?(b(),e=w,K={}):"("==v?(0<=h&&(K={name:c(h+1,w),value:n},x.Aa.push(K)),f=w):" "==v&&q!=v&&(b(),0<=h&&x.Aa.push({name:c(h+1,w)}),x.fc=x.Aa.length||x.Ua.length||x.e.length,
x.Qc=x.Da=c(y,w),x.Lc=x.z=x.fb?n:x.z||"*",x.z&&(x.z=x.z.toUpperCase()),d.length&&d[d.length-1].fb&&(x.$b=d.pop(),x.Da=x.$b.Da+" "+x.Da),d.push(x),x=n);return d}function Gb(a,b){return!a?b:!b?a:function(){return a.apply(window,arguments)&&b.apply(window,arguments)}}function Hb(a){return 1==a.nodeType}function Ib(a,b){return!a?"":"class"==b?a.className||"":"for"==b?a.htmlFor||"":"style"==b?a.style.cssText||"":(Eb?a.getAttribute(b):a.getAttribute(b,2))||""}
var Jb={"*=":function(a,b){return function(c){return 0<=Ib(c,a).indexOf(b)}},"^=":function(a,b){return function(c){return 0==Ib(c,a).indexOf(b)}},"$=":function(a,b){return function(c){c=" "+Ib(c,a);return c.lastIndexOf(b)==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+Ib(b,a)+" ").indexOf(c)}},"|=":function(a,b){b=" "+b;return function(c){c=" "+Ib(c,a);return c==b||0==c.indexOf(b+"-")}},"=":function(a,b){return function(c){return Ib(c,a)==b}}},Kb="undefined"==
typeof document.firstChild.nextElementSibling,Lb=!Kb?"nextElementSibling":"nextSibling",Mb=!Kb?"previousElementSibling":"previousSibling",Nb=Kb?Hb:Ab;function Ob(a){for(;a=a[Mb];)if(Nb(a))return r;return m}function Pb(a){for(;a=a[Lb];)if(Nb(a))return r;return m}function Qb(a){var b=a.parentNode,c=0,d=b[Db],e=a._i||-1,f=b._l||-1;if(!d)return-1;d=d.length;if(f==d&&0<=e&&0<=f)return e;b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[Lb])Nb(b)&&(b._i=++c,a===b&&(e=c));return e}
function Rb(a){return!(Qb(a)%2)}function Sb(a){return Qb(a)%2}
var Ub={checked:function(){return function(a){return a.checked||a.attributes.checked}},"first-child":function(){return Ob},"last-child":function(){return Pb},"only-child":function(){return function(a){return!Ob(a)||!Pb(a)?r:m}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;0<=a;a--){var c=b[a].nodeType;if(1===c||3==c)return r}return m}},contains:function(a,b){var c=b.charAt(0);if('"'==c||"'"==c)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},
not:function(a,b){var c=Fb(b)[0],d={$:1};"*"!=c.z&&(d.z=1);c.e.length||(d.e=1);var e=Tb(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){if("odd"==b)return Sb;if("even"==b)return Rb;if(-1!=b.indexOf("n")){var c=b.split("n",2),d=c[0]?"-"==c[0]?-1:parseInt(c[0],10):1,e=c[1]?parseInt(c[1],10):0,f=0,g=-1;0<d?0>e?e=e%d&&d+e%d:0<e&&(e>=d&&(f=e-e%d),e%=d):0>d&&(d*=-1,0<e&&(g=e,e%=d));if(0<d)return function(a){a=Qb(a);return a>=f&&(0>g||a<=g)&&a%d==e};b=e}var h=parseInt(b,10);return function(a){return Qb(a)==
h}}},Vb=C?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return Eb?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}};
function Tb(a,b){if(!a)return Ab;var b=b||{},c=n;b.$||(c=Gb(c,Hb));b.z||"*"!=a.z&&(c=Gb(c,function(b){return b&&b.tagName==a.xb()}));b.e||G(a.e,function(a,b){var f=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");c=Gb(c,function(a){return f.test(a.className)});c.count=b});b.Aa||G(a.Aa,function(a){var b=a.name;Ub[b]&&(c=Gb(c,Ub[b](b,a.value)))});b.Ua||G(a.Ua,function(a){var b,f=a.attr;a.type&&Jb[a.type]?b=Jb[a.type](f,a.Ab):f.length&&(b=Vb(f));b&&(c=Gb(c,b))});b.id||a.id&&(c=Gb(c,function(b){return!!b&&b.id==a.id}));
c||"default"in b||(c=Ab);return c}var Wb={};
function Xb(a){var b=Wb[a.Da];if(b)return b;var c=a.$b,c=c?c.fb:"",d=Tb(a,{$:1}),e="*"==a.z,f=document.getElementsByClassName;if(c)if(f={$:1},e&&(f.z=1),d=Tb(a,f),"+"==c)var g=d,b=function(a,b,c){for(;a=a[Lb];)if(!Kb||Hb(a)){(!c||Yb(a,c))&&g(a)&&b.push(a);break}return b};else if("~"==c)var h=d,b=function(a,b,c){for(a=a[Lb];a;){if(Nb(a)){if(c&&!Yb(a,c))break;h(a)&&b.push(a)}a=a[Lb]}return b};else{if(">"==c)var i=d,i=i||Ab,b=function(a,b,c){for(var d=0,e=a[Db];a=e[d++];)Nb(a)&&((!c||Yb(a,c))&&i(a,d))&&
b.push(a);return b}}else if(a.id)d=!a.fc&&e?Ab:Tb(a,{$:1,id:1}),b=function(b,c){var e;e=hb(b);var f=a.id;if(f=(e=u(f)?e.Ia.getElementById(f):f)&&d(e))if(!(f=9==b.nodeType)){for(f=e.parentNode;f&&f!=b;)f=f.parentNode;f=!!f}if(f)return Bb(e,c)};else if(f&&/\{\s*\[native code\]\s*\}/.test(String(f))&&a.e.length&&!Cb)var d=Tb(a,{$:1,e:1,id:1}),l=a.e.join(" "),b=function(a,b){for(var c=Bb(0,b),e,f=0,g=a.getElementsByClassName(l);e=g[f++];)d(e,a)&&c.push(e);return c};else!e&&!a.fc?b=function(b,c){for(var d=
Bb(0,c),e,f=0,g=b.getElementsByTagName(a.xb());e=g[f++];)d.push(e);return d}:(d=Tb(a,{$:1,z:1,id:1}),b=function(b,c){for(var e=Bb(0,c),f,g=0,h=b.getElementsByTagName(a.xb());f=h[g++];)d(f,b)&&e.push(f);return e});return Wb[a.Da]=b}var Zb={},$b={};
function ac(a){var b=Fb(ma(a));if(1==b.length){var c=Xb(b[0]);return function(a){if(a=c(a,[]))a.eb=m;return a}}return function(a){for(var a=Bb(a),c,f,g=b.length,h,i,l=0;l<g;l++){i=[];c=b[l];f=a.length-1;0<f&&(h={},i.eb=m);f=Xb(c);for(var p=0;c=a[p];p++)f(c,i,h);if(!i.length)break;a=i}return i}}var bc=!!document.querySelectorAll&&(!D||E("526"));
function cc(a,b){if(bc){var c=$b[a];if(c&&!b)return c}if(c=Zb[a])return c;var c=a.charAt(0),d=-1==a.indexOf(" ");0<=a.indexOf("#")&&d&&(b=m);if(bc&&!b&&-1==">~+".indexOf(c)&&(!C||-1==a.indexOf(":"))&&!(Cb&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf("|=")){var e=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return $b[a]=function(b){try{9==b.nodeType||d||j("");var c=b.querySelectorAll(e);C?c.wc=m:c.eb=m;return c}catch(f){return cc(a,m)(b)}}}var f=a.split(/\s*,\s*/);return Zb[a]=
2>f.length?ac(a):function(a){for(var b=0,c=[],d;d=f[b++];)c=c.concat(ac(d)(a));return c}}var dc=0,ec=C?function(a){return Eb?a.getAttribute("_uid")||a.setAttribute("_uid",++dc)||dc:a.uniqueID}:function(a){return a._uid||(a._uid=++dc)};function Yb(a,b){if(!b)return 1;var c=ec(a);return!b[c]?b[c]=1:0}
function fc(a){if(a&&a.eb)return a;var b=[];if(!a||!a.length)return b;a[0]&&b.push(a[0]);if(2>a.length)return b;dc++;if(C&&Eb){var c=dc+"";a[0].setAttribute("_zipIdx",c);for(var d=1,e;e=a[d];d++)a[d].getAttribute("_zipIdx")!=c&&b.push(e),e.setAttribute("_zipIdx",c)}else if(C&&a.wc)try{for(d=1;e=a[d];d++)Hb(e)&&b.push(e)}catch(f){}else{a[0]&&(a[0]._zipIdx=dc);for(d=1;e=a[d];d++)a[d]._zipIdx!=dc&&b.push(e),e._zipIdx=dc}return b}
function gc(a,b){if(!a)return[];if(a.constructor==Array)return a;if(!u(a))return[a];if(u(b)&&(b=u(b)?document.getElementById(b):b,!b))return[];var b=b||document,c=b.ownerDocument||b.documentElement;Eb=b.contentType&&"application/xml"==b.contentType||Ea&&(b.doctype||"[object XMLDocument]"==c.toString())||!!c&&(C?c.xml:b.xmlVersion||c.xmlVersion);return(c=cc(a)(b))&&c.eb?c:fc(c)}gc.Aa=Ub;ba("goog.dom.query",gc);ba("goog.dom.query.pseudos",gc.Aa);var hc={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ic(a){var b={},a=String(a),c="#"==a.charAt(0)?a:"#"+a;if(jc.test(c))return b.I=kc(c),b.type="hex",b;a:{var d=a.match(lc);if(d){var c=Number(d[1]),e=Number(d[2]),d=Number(d[3]);if(0<=c&&255>=c&&0<=e&&255>=e&&0<=d&&255>=d){c=[c,e,d];break a}}c=[]}if(c.length)return b.I=mc(c),b.type="rgb",b;if(hc&&(c=hc[a.toLowerCase()]))return b.I=c,b.type="named",b;j(Error(a+" is not a valid color string"))}var nc=/#(.)(.)(.)/;
function kc(a){jc.test(a)||j(Error("'"+a+"' is not a valid hex color"));4==a.length&&(a=a.replace(nc,"#$1$1$2$2$3$3"));return a.toLowerCase()}function oc(a,b,c){a=Number(a);b=Number(b);c=Number(c);(isNaN(a)||0>a||255<a||isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c)&&j(Error('"('+a+","+b+","+c+'") is not a valid RGB color'));return"#"+pc(a.toString(16))+pc(b.toString(16))+pc(c.toString(16))}function mc(a){return oc(a[0],a[1],a[2])}
function qc(a,b,c){0>c?c+=1:1<c&&(c-=1);return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}function rc(a,b,c){var d=0,e=0,f=0,a=a/360;if(0==b)d=e=f=255*c;else var g=f=0,g=0.5>c?c*(1+b):c+b-b*c,f=2*c-g,d=255*qc(f,g,a+1/3),e=255*qc(f,g,a),f=255*qc(f,g,a-1/3);return[Math.round(d),Math.round(e),Math.round(f)]}var jc=/^#(?:[0-9a-f]{3}){1,2}$/i,lc=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;function pc(a){return 1==a.length?"0"+a:a};function sc(a){var b={},a=String(a),c="#"==a.charAt(0)?a:"#"+a;if(tc.test(c))return b.I=uc(c),b.type="hex",b;a:{var d=a.match(vc);if(d){var c=Number(d[1]),e=Number(d[2]),f=Number(d[3]),d=Number(d[4]);if(0<=c&&255>=c&&0<=e&&255>=e&&0<=f&&255>=f&&0<=d&&1>=d){c=[c,e,f,d];break a}}c=[]}if(c.length)return b.I=wc(c),b.type="rgba",b;a:{if(d=a.match(xc))if(c=Number(d[1]),e=Number(d[2]),f=Number(d[3]),d=Number(d[4]),0<=c&&360>=c&&0<=e&&100>=e&&0<=f&&100>=f&&0<=d&&1>=d){f=[c,e,f,d];break a}f=[]}if(f.length)return a=
f[0],c=f[1],e=f[2],f=f[3],d=Math.floor(255*f),(isNaN(d)||0>d||255<d)&&j(Error('"('+a+","+c+","+e+","+f+'") is not a valid HSLA color')),f=pc(d.toString(16)),a=mc(rc(a,c/100,e/100))+f,b.I=a,b.type="hsla",b;j(Error(a+" is not a valid color string"))}var yc=/#(.)(.)(.)(.)/;function uc(a){tc.test(a)||j(Error("'"+a+"' is not a valid alpha hex color"));5==a.length&&(a=a.replace(yc,"#$1$1$2$2$3$3$4$4"));return a.toLowerCase()}
function zc(a){a=uc(a);return[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16),parseInt(a.substr(7,2),16)/255]}function wc(a){var b=a[0],c=a[1],d=a[2],a=a[3],e=Math.floor(255*a);(isNaN(e)||0>e||255<e)&&j(Error('"('+b+","+c+","+d+","+a+'") is not a valid RGBA color'));a=pc(e.toString(16));return oc(b,c,d)+a}var tc=/^#(?:[0-9a-f]{4}){1,2}$/i,vc=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i,xc=/^(?:hsla)\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\%,\s?(0|[1-9]\d{0,2})\%,\s?(0|1|0\.\d{0,10})\)$/i;function Ac(a,b){b=b||"#ffffff";a=a||b;u(a)||j(Error(a+" is not a valid 6-hex color string"));7<a.length&&"#"==a[0]&&(a=a.substr(0,7));7<b.length&&"#"==b[0]&&(b=b.substr(0,7));try{return ic(a)}catch(c){return Ac(b,"#ffffff")}}function Bc(a,b){b=b||"#ffffff";a=a||b;u(a)||j(Error(a+" is not a valid 8-hex color string"));try{return sc(a)}catch(c){try{var d=Ac(a,b).I;return Bc(d+"ff",b+"ff")}catch(e){return Bc(b,"#ffffffff")}}}
function Cc(a){var b;b=0.5;for(var a=ic(a).I,a=kc(a),a=[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16)],c=[[0,0,0],[255,255,255]],d=[],e=0;e<c.length;e++)d.push({color:c[e],Ub:Math.abs(Math.round((299*c[e][0]+587*c[e][1]+114*c[e][2])/1E3)-Math.round((299*a[0]+587*a[1]+114*a[2])/1E3))+(Math.abs(c[e][0]-a[0])+Math.abs(c[e][1]-a[1])+Math.abs(c[e][2]-a[2]))});d.sort(function(a,b){return b.Ub-a.Ub});a=d[0].color;return 1>b?(a.push(b),b=a[0],c=a[1],d=a[2],a=a[3],(isNaN(b)||
0>b||255<b||isNaN(c)||0>c||255<c||isNaN(d)||0>d||255<d||isNaN(a)||0>a||1<a)&&j(Error('"('+b+","+c+","+d+","+a+')" is not a valid RGBA color')),"rgba("+[b,c,d,a].join()+")"):mc(a)}
function M(a,b){this.Cc=m;this.da=this.U=this.V=this.W=0;!a&&b&&(a=b);a&&(u(a)?("transparent"==a.toLowerCase()&&(a="#0000"),Dc(this,a)):da(a)&&3<=a.length?Ec(this,[a[0],a[1],a[2],z(a[3])?a[3]:1]):a.Cc?this.clone(a):ea(a)&&("h"in a&&"s"in a&&"v"in a?Fc(this,[a.h,a.s,a.v,z(a.a)?a.a:1]):"h"in a&&"s"in a&&"l"in a?Gc(this,[a.h,a.s,a.l,z(a.a)?a.a:1]):"r"in a&&("g"in a&&"b"in a)&&Ec(this,[a.r,a.g,a.b,z(a.a)?a.a:1])))}M.prototype.clone=function(a){this.W=a.W;this.V=a.V;this.U=a.U;this.da=a.da;return this};
M.prototype.I=function(a){return a===k?mc(Hc(this)):Dc(this,a)};function Dc(a,b){if(b===k)return wc(Ec(a));var c=zc(Bc(b).I);a.W=c[0];a.V=c[1];a.U=c[2];a.da=c[3];return a}function Hc(a){return[a.W,a.V,a.U]}function Ec(a,b){if(b===k)return[a.W,a.V,a.U,a.da];a.W=H(Math.round(b[0]),0,255);a.V=H(Math.round(b[1]),0,255);a.U=H(Math.round(b[2]),0,255);a.da=H(z(b[3])?b[3]:1,0,1);return a}
function Gc(a,b){var c;if(b===k){c=a.W/255;var d=a.V/255,e=a.U/255,f=Math.max(c,d,e),g=Math.min(c,d,e),h=0,i=0,l=0.5*(f+g);f!=g&&(f==c?h=60*(d-e)/(f-g):f==d?h=60*(e-c)/(f-g)+120:f==e&&(h=60*(c-d)/(f-g)+240),i=0<l&&0.5>=l?(f-g)/(2*l):(f-g)/(2-2*l));c=[Math.round(h+360)%360,i,l]}else b===k?c=Gc(a).concat([a.da]):(d=H(Math.round(360+b[0])%360,0,360),e=H(b[1],0,1),f=H(b[2],0,1),c=H(z(b[3])?b[3]:1,0,1),d=rc(d,e,f),a.W=d[0],a.V=d[1],a.U=d[2],a.da=c,c=a);return c}
function Fc(a,b){if(b===k){var c,d=Hc(a);c=d[0];var e=d[1],f=d[2],d=Math.max(Math.max(c,e),f),g=Math.min(Math.min(c,e),f);if(g==d)g=c=0;else{var h=d-g,g=h/d;c=60*(c==d?(e-f)/h:e==d?2+(f-c)/h:4+(c-e)/h);0>c&&(c+=360);360<c&&(c-=360)}c=[c,g,d];c[0]=Gc(a)[0];c[2]/=255}else{var i=H(Math.round(360+b[0])%360,0,360),e=H(b[1],0,1),d=H(b[2],0,1);c=H(z(b[3])?b[3]:1,0,1);d=H(Math.round(255*d),0,255);h=g=f=0;if(0==e)h=g=f=d;else{var l=Math.floor(i/60),p=i/60-l,i=d*(1-e),q=d*(1-e*p),e=d*(1-e*(1-p));switch(l){case 1:f=
q;g=d;h=i;break;case 2:f=i;g=d;h=e;break;case 3:f=i;g=q;h=d;break;case 4:f=e;g=i;h=d;break;case 5:f=d;g=i;h=q;break;case 6:case 0:f=d,g=e,h=i}}e=[Math.floor(f),Math.floor(g),Math.floor(h)];a.W=e[0];a.V=e[1];a.U=e[2];a.da=c}}M.prototype.serialize=function(a){return a?{r:this.W,g:this.V,b:this.U,a:this.da}:Dc(this)};function Ic(){var a=this;this.qb=this.visible=r;this.Tc=n;this.Rc=[];this.Sc=12;this.nb=n;this.i=J({e:"callout hidden",children:[{e:"callout-bubble",create:function(b){a.Pb=b},children:[{e:"simple-color-picker",children:[{e:"preview-swatch",create:function(b){a.Eb=b}},{e:"input-container",children:[{z:"input",type:"text",e:"box-sizing-border",create:function(b){a.kc=b;L(b,Jc,function(){a.qb=m});L(b,Kc,function(){a.qb=r});L(b,Lc,function(a){a.stopPropagation()})},change:function(b,c){try{var d=new M(Ac(c.value).I);
Mc(a,d)}catch(e){Nc(a,a.Oa)}}}]},{e:"button-container",children:[{z:"button",text:"Done",click:function(){(!a.X||a.X(a.Oa)!=r)&&a.hide()}}]},{e:"spacer"},{e:"swatch-container",create:function(b){a.nb=b}}]}]},{e:"callout-pointer-border"},{e:"callout-pointer"}]});L(this.Pb,Oc,function(a){a.stopPropagation()});L(this.Pb,Pc,function(){Qc(a,a.Pa);Nc(a,a.Oa)});this.Kb={};this.X=this.Oa=this.Pa=n;this.sb();Rc(N,Sc,function(){a.hide()})}
function Nc(a,b){b&&0<Ec(b)[3]?(eb(a.Eb,"transparent"),a.Eb.style.backgroundColor=b.I(),a.qb||(a.kc.value=b.I())):(db(a.Eb,"transparent"),a.qb||(a.kc.value="transparent"))}function Qc(a,b){G(gc(".selected",a.nb),function(a){eb(a,"selected")});b&&db(b,"selected")}function Mc(a,b){b?(a.Pa=a.Kb[b.I().toLowerCase()]||n,a.Oa=new M(b.I()),a.Pa&&Qc(a,a.Pa),Nc(a,b)):(a.Pa=n,a.Oa=n)}
Ic.prototype.sb=function(){var a;this.Kb={};var b=new M;for(a=0;12>a;a++)Fc(b,[0,0,(11-a)/11]),Tc(this,Hc(b));for(var c=0;9>c;c++)for(a=0;360>a;a+=30)Gc(b,[a,1,(9-c)/10]),Tc(this,Hc(b));a=J({e:"clear"});this.nb.appendChild(a)};
function Tc(a,b){var c=J({e:"swatch"+(b?"":" transparent"),css:{backgroundColor:b?"rgb("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+")":"transparent"},create:function(c){var e=n;b&&(e=new M(b),a.Kb[e.I().toLowerCase()]=c);L(c,Uc,function(){Qc(a,c);Nc(a,e)});L(c,yb,function(){(!a.X||a.X(e)!==r)&&a.hide()})}});a.nb.appendChild(c)}
Ic.prototype.show=function(a,b,c,d){N.j(Sc);this.X=c;Mc(this,d);this.visible=m;this.i.style.display="block";var e;if(c=this.i.offsetParent)if(d="HTML"==c.tagName||"BODY"==c.tagName,!d||"static"!=rb(c,"position"))e=ub(c),d||(d=(d="rtl"==rb(c,"direction"))&&Fa?-c.scrollLeft:d&&(!C||!E("8"))?c.scrollWidth-c.clientWidth-c.scrollLeft:c.scrollLeft,c=new I(d,c.scrollTop),e=new I(e.x-c.x,e.y-c.y));e=e||new I;c=this.i;a-=e.x;d=b-e.y;e=Fa&&(za||Ha)&&E("1.9");a instanceof I?(b=a.x,a=a.y):(b=a,a=d);c.style.left=
vb(b,e);c.style.top=vb(a,e)};Ic.prototype.hide=function(){this.visible=r;this.i.style.display="none"};function Vc(){var a=this;this.visible=r;this.Qa=n;this.i=J({e:"text-area-container",children:[{e:"overlay"},{e:"wrapper",children:[{e:"heading",text:O("Edit Text Content")},{z:"textarea",create:function(b){a.Qa=b;L(b,Lc,function(a){a.stopPropagation()})}},{z:"button",e:"cancel",text:O("Cancel"),click:function(){a.hide()}},{z:"button",e:"save",text:O("Save"),click:function(){a.save()}}]}]});this.X=n}Vc.prototype.save=function(){(!this.X||this.X(this.Qa.value)!==r)&&this.hide()};
Vc.prototype.show=function(a,b){N.j(Sc);this.visible=m;this.X=a;this.Qa.value=b||"";this.i.style.display="block";setTimeout(A(function(){this.Qa.select&&this.Qa.select()},this),250)};Vc.prototype.hide=function(){this.visible=r;this.X=n;this.i.style.display="none"};function Wc(a,b,c,d){this.x=a;this.y=b;this.f=c;this.k=d}function Xc(a,b,c,d){if(2==arguments.length)return Math.sqrt(a*a+b*b);var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)}function Yc(a,b,c,d,e,f,g){for(var h=0,i=a,l=b,p,q,v,y,g=g||6,w=1;w<=g;w++)p=w/g,v=1-p,q=v*v,v*=2*p,y=p*p,p=q*a+v*c+y*e,q=q*b+v*d+y*f,h+=Xc(i,l,p,q),i=p,l=q;return h}function Zc(a,b,c,d,e,f,g,h){if(0==g)return $c(a,b,c,d,e,f,h);if(1==h)return ad(a,b,c,d,e,f,g);a=$c(a,b,c,d,e,f,h);a.push(g/h);return ad.apply(n,a)}
function $c(a,b,c,d,e,f,g){g=g||1;1!=g&&(e=c+(e-c)*g,f=d+(f-d)*g,c=a+(c-a)*g,d=b+(d-b)*g,e=c+(e-c)*g,f=d+(f-d)*g);return[a,b,c,d,e,f]}function ad(a,b,c,d,e,f,g){g=g||1;1!=g&&(a+=(c-a)*g,b+=(d-b)*g,c+=(e-c)*g,d+=(f-d)*g,a+=(c-a)*g,b+=(d-b)*g);return[a,b,c,d,e,f]}
function bd(a,b,c){var d=(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y),e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d,d=Math.abs(((b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y))/d)*Math.sqrt(d);0<=e&&1>=e?a=d:(b=(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y),a=(a.x-c.x)*(a.x-c.x)+(a.y-c.y)*(a.y-c.y),a=b<a?Math.sqrt(b):Math.sqrt(a));return a};function cd(a){this.$=a;this.e={};for(var a=this.$.className.split(" "),b=0,c=a.length;b<c;b++)this.e[a[b]]=m}function dd(a){var b=[],c;for(c in a.e)b.push(c);return b.join(" ")}cd.prototype.addClass=function(a){for(var a=a.split(" "),b=0,c=a.length;b<c;b++)this.e[a[b]]=m;this.$.className=dd(this)};cd.prototype.removeClass=function(a){for(var a=a.split(" "),b=0,c=a.length;b<c;b++)delete this.e[a[b]];this.$.className=dd(this)};function ed(a,b,c){function d(){if(!e.n){var a=parseFloat(e.input.value);z(a)&&(a/=e.na);a:{for(var a=[a,e.Ga,e.value],b=a.length,c=0;c<b;c++)if(a[c]||0===a[c]||""===a[c]||a[c]===r){a=a[c];break a}a=n}e.O(a)}}var a=a||{},e=this;this.Vb=this.sc=this.input=n;this.i=J({e:"spinner",css:a.css||n,children:[{e:"spinner-textbox",children:[{z:"input",type:"text",create:function(a){e.input=a}}]},{e:"spinner-buttons",children:[{e:"spinner-up",create:function(a){e.sc=a},children:[{e:"icon-13 icon-13-spinner-arrows"}]},
{e:"spinner-down",create:function(a){e.Vb=a},children:[{e:"icon-13 icon-13-spinner-arrows"}]}]}]});this.Y=new cd(this.i);this.n=a.disabled||r;this.min=a.min||0;this.max=a.max===k?100:a.max;this.step=a.step||1;this.round=a.round||0;this.loop=!!a.loop;this.Jb=a.Jb||"";this.Ga=a.Ga||0;this.na=a.na||1;this.vb=a.vb===k?this.round:a.vb;this.value=0;this.la=[];this.Yb=[];this.Nb=[];this.O(a.value||this.Ga||0,m);a.change&&this.la.push(a.change);a.focus&&this.Yb.push(a.focus);a.blur&&this.Nb.push(a.blur);
b&&this.appendTo(b,c);L(this.input,zb,function(){d()});L(this.input,Lc,function(a){if(!e.n){var b=a.keyCode;38==b?(fd(e),a.preventDefault()):40==b?(gd(e),a.preventDefault()):13==b&&(d(),e.input.blur(),a.preventDefault());a.stopPropagation()}});L(this.input,Jc,function(){setTimeout(function(){e.input.select()},10);G(e.Yb,function(a){a.call(e,e.value)})});L(this.input,Kc,function(){G(e.Nb,function(a){a.call(e)})});L(this.sc,yb,function(){e.n||fd(e)});L(this.Vb,yb,function(){e.n||gd(e)});this.n&&(this.n=
r,this.disable())}function fd(a){!z(a.value)&&a.$a!=n&&(a.value=a.$a);var b=(Math.round(a.na*a.value/a.step)+1)*a.step/a.na;a.loop&&b>a.max&&(b=a.min+(b-(a.max+1)));a.O(b)}function gd(a){!z(a.value)&&a.$a!=n&&(a.value=a.$a);var b=(Math.round(a.na*a.value/a.step)-1)*a.step/a.na;a.loop&&b<a.min&&(b=a.max+1-(a.min-b));a.O(b)}s=ed.prototype;
s.O=function(a,b){var c=r;if(a!==this.value||b)a=parseFloat(a),isNaN(a)?this.Ga!==n&&(this.value=this.Ga):(this.value=a>this.max?this.max:a<this.min?this.min:a,this.$a=this.value=1*this.value.toFixed(this.round)),this.qa(!!b),c=m;if(!b||c||""===this.input.value)this.input.value=u(this.value)?this.value:(this.value*this.na).toFixed(this.vb||0).replace(/^([^\.]*)$/,"$1.").replace(/\.?0*$/,"")+this.Jb};s.qa=function(a){var b=this;G(this.la,function(c){c.call(b,b.value,!!a)})};
s.appendTo=function(a,b){this.i.style.width=b?b+"px":"auto";a.appendChild(this.i);return this};s.Ib=function(a){if(this.n)return this;this.O(a,m);return this};s.focus=function(){this.input.focus();return this};s.blur=function(){this.input.blur();return this};s.enable=function(){this.n&&(this.Y.removeClass("disabled"),this.n=this.input.disabled=r);return this};s.disable=function(){this.n||(this.Y.addClass("disabled"),this.n=this.input.disabled=m);return this};function hd(a,b,c,d){b=b||{};this.Qb=a;this.i=J({e:"button-bar"+(b.e?" "+b.e:""),css:b.css||n});this.Y=new cd(this.i);this.n=b.disabled||r;this.value=[];this.la=[];b.change&&this.la.push(b.change);c&&this.appendTo(c,d);this.sb();this.n&&this.disable()}s=hd.prototype;s.O=function(a){this.value.push(a)};s.qa=function(a){var b=this;G(this.la,function(c){c.call(b,b.value,!!a)})};s.appendTo=function(a,b){this.i.style.width=b?b+"px":"auto";a.appendChild(this.i);return this};
s.sb=function(){var a=this;this.value=[];G(this.Qb,function(b){var c=b.selected&&b.selected(),d=a.n||b.disabled&&b.disabled();c&&(b.value||0===b.value||b.value===r)&&a.O(b.value);c=J({e:"button-bar-item"+(c?" selected":"")+(d&&!a.n?" disabled":""),title:b.ca||n,click:function(){d=a.n||b.disabled&&b.disabled();d||(b.action(),a.refresh(m))},children:[{e:"icon-13 icon-13-"+b.aa}]});a.i.appendChild(c)})};
s.refresh=function(a){var b=this;this.value=[];G(this.Qb,function(a,d){var e=a.selected&&a.selected(),f=b.n||a.disabled&&a.disabled();e&&(a.value||0===a.value||a.value===r)&&b.O(a.value);(gb&&b.i.children!=k?b.i.children:Wa(b.i.childNodes,function(a){return 1==a.nodeType}))[d].className="button-bar-item"+(e?" selected":"")+(f&&!b.n?" disabled":"")});this.qa(!a||r);return this};s.enable=function(){this.n&&(this.Y.removeClass("disabled"),this.n=r);return this.refresh()};
s.disable=function(){this.n||(this.Y.addClass("disabled"),this.n=m);return this.refresh()};function id(a,b,c){var a=a||{},d=this;this.mb=this.pc=n;this.i=J({e:"color-well",children:[{e:"color-well-wrapper",children:[{e:"swatch-container",click:function(a,b){if(!d.n){var c=ub(b),h=wb(b);N.j(jd,c.x+h.width/2,c.y+h.height+2,function(a){d.O(a)},d.value||n)}},children:[{e:"swatch",create:function(a){d.pc=a},children:[{z:"canvas",css:{position:"absolute"},create:function(a){d.mb=a}}]},{e:"border"}]}]}]});this.Y=new cd(this.i);this.n=a.disabled||r;this.value=a.value||new M("#fff");this.la=[];
a.change&&this.la.push(a.change);b&&this.appendTo(b,c);this.n&&this.disable()}s=id.prototype;
s.ha=function(a){if(!this.Oc){var b=wb(this.pc);if(0==b.width&&!a)return;this.mb.width=b.width;this.mb.height=b.height;this.Oc=m}var a=this.mb.getContext("2d"),c=this.value;this.Y.removeClass("no-fill");this.n&&(c=new M("#ccccccff"));c||this.Y.addClass("no-fill");var b=a.canvas.width,d=a.canvas.height;a.clearRect(0,0,b,d);c&&(a.save(),c=Dc(c),c=zc(c),a.fillStyle="rgba("+c.join(",")+")",a.fillRect(0,0,b,d),a.restore())};s.O=function(a,b){this.value=a;this.ha();this.qa(!!b)};
s.qa=function(a){var b=this;G(this.la,function(c){c.call(b,b.value,!!a)})};s.appendTo=function(a,b){this.i.style.width=b?b+"px":"";a.appendChild(this.i);return this};s.Ib=function(a){this.O(new M(a),m);return this};s.enable=function(){this.n&&(this.Y.removeClass("disabled"),this.n=r,this.ha());return this};s.disable=function(){this.n||(this.Y.addClass("disabled"),this.n=m,this.ha());return this};function kd(a,b){if(a==n)return n;b==n&&(b=0);if(100<b)return n;var c={};if("object"==typeof a){"undefined"!=typeof a.length&&(c=[]);for(var d in a){var e=typeof a[d];"object"==e?c[d]=a[d]instanceof HTMLElement?a[d]:kd(a[d],b+1):"string"==e?c[d]=a[d]:"number"==e?c[d]=a[d]:"function"==e?c[d]=a[d]:"boolean"==e?a[d]==m?c[d]=m:c[d]=r:"undefined"==e&&(c[d]=k)}}return c}
function ld(a,b){if("object"==typeof a&&"object"==typeof b){if(a==n&&b==n)return m;if(da(a)&&da(b)){if(a.length!=b.length)return r;for(var c=0;c<a.length;c++)if(!ld(a[c],b[c]))return r;return m}if(ea(a)&&ea(b)){for(c in a)if(!(c in(a.__proto__||a.constructor)||"__proto__"==c))if(!(c in b)||!ld(a[c],b[c]))return r;for(c in b)if(!(c in(b.__proto__||b.constructor)||"__proto__"==c)&&!(c in a))return r;return m}return r}return z(a)&&z(b)?1E-9>Math.abs(a-b):a==n&&b==n?m:a===b};function P(a,b){this.type=a;this.q=b;this.Cb=n;this.zb=this.yb=r}P.prototype.copy=function(){return new P(this.type,kd(this.q))};function md(a){var b=a.copy();switch(a.type){case 1:b.type=5;break;case 2:b.type=6;break;case 3:b.type=7;break;case 4:b.q=kd(a.Cb);break;case 5:b.type=1;break;case 6:b.type=2;break;case 7:b.type=3;break;default:return n}return b};var nd=n;function od(a,b){var c=nd;if(c){var d=pd(c);0<d.length?G(d,function(d){d.d[a]!==k&&(d={id:d.id},d[a]=b,Q(c,new P(4,d)))}):c.c.d[a]=b}}function qd(a){var b=nd;b&&(b.Fa++,G(a,function(a){od(a[0],a[1])}),rd(b))}function R(a){var b=nd;if(b){var c=pd(b),d;0<c.length?Xa(c,function(b){return b.d[a]!==k?(d=b.d[a],m):r}):d=b.c.d[a];return d}}function S(a,b){return function(c){c!==k&&a[b]!==k&&(a[b]=c);return a[b]}};function O(a){if(sd[a]){var b=a;return b="en"!=td?sd[a][td]||sd[a].en||a:sd[a].en||a}return a}var td="en",sd={};function ud(){function a(){return!z(R("fl"))}function b(){return!u(R("ta"))}function c(a,b,c,d){return new hd([{aa:a,action:function(){N.j(T,b,d)},ca:O(c),selected:function(){return g.mode==b&&(d===k||d==g.Ca)},disabled:function(){return r}}],n,vd(f))}function d(a){var b=[];G(a.ub,function(c){a.T?(c.action=function(){od(a.T,c.val)},c.selected=function(){return R(a.T)==c.val},c.disabled=function(){return R(a.T)===k}):c.T&&(c.action=function(){od(c.T,!R(c.T))},c.selected=function(){return!!R(c.T)},
c.disabled=function(){return R(c.T)===k});b.push(c)});return b}var e=this;this.i=mb("DIV","option-bar");this.viewport=mb("DIV","fullsize");this.i.appendChild(this.viewport);this.mc=[];this.Uc=n;var f=this.i,g=this,h=c("tool-select",wd,"Select Tool"),i=c("tool-line",xd,"Line Tool"),l=c("tool-anchor",U,"Anchor Tool",yd),p=c("tool-piton",U,"Piton Tool",zd),q=c("tool-rappel",U,"Rappel Tool",Ad),v=c("tool-belay",U,"Belay Tool",Bd),y=c("tool-text",Cd,"Text Tool");Dd(f);var w=new id({change:function(a,b){b||
od("ic",a.I())}},vd(f));w.refresh=A(this.nc,this,w,"ic");Dd(f);var ja=J({e:"option-bar-label-left",text:"Scale:",children:n});f.appendChild(ja);ja=new ed({min:0.5,max:4,step:10,round:2,width:60,value:1,na:100,Jb:"%",change:function(a,b){b||od("is",a)}},vd(f),50);ja.refresh=A(this.nc,this,ja,"is");Dd(f);var x=new hd(d({ub:[{aa:"text-align-l",val:"l",ca:O("Left Align"),selected:function(){return"l"==R("ta")},disabled:b},{aa:"text-align-c",val:"c",ca:O("Center Align"),selected:function(){return"c"==
R("ta")},disabled:b},{aa:"text-align-r",val:"r",ca:O("Right Align"),selected:function(){return"r"==R("ta")},disabled:b}],T:"ta"}),n,vd(f)),K=new hd(d({ub:[{aa:"text-bg",T:"tb",ca:O("Toggle Text Background")}]}),n,vd(f));Dd(f);var De=new hd([{aa:"line-solid",action:function(){od("fl",0)},ca:O("Solid Line"),selected:function(){return 0===R("fl")},disabled:a},{aa:"line-dashed",action:function(){qd([["fl",10],["nl",10]])},ca:O("Dashed Line"),selected:function(){return 2<R("nl")},disabled:a},{aa:"line-dotted",
action:function(){qd([["fl",8],["nl",0.01]])},ca:O("Dotted Line"),selected:function(){return 0<R("fl")&&2>=R("nl")},disabled:a}],n,vd(f)),Ee=new hd(d({ub:[{aa:"line-curved",T:"lc",ca:O("Toggle Line Curvature")}]}),n,vd(f)),Re=new hd([{aa:"line-edit",action:function(){N.j(T,Ed)},ca:O("Edit Line Shape"),selected:function(){return g.mode==Ed},disabled:a}],n,vd(f)),Se=[h,i,l,p,q,v,y,w,ja,x,K,De,Ee,Re];this.mc.push(function(){G(Se,function(a){a.refresh&&a.refresh()})});this.Ca=this.mode=n;Rc(N,T,function(a,
b){e.mode=a;e.Ca=b;e.refresh()})}ud.prototype.ba=function(){Rc(N,Fd,A(this.refresh,this));Rc(N,Gd,A(this.refresh,this));N.j(T,wd)};function vd(a){var b=J({e:"option-bar-input"});a.appendChild(b);return b}function Dd(a){var b=J({e:"option-bar-divider"});a.appendChild(b)}ud.prototype.nc=function(a,b){var c=R(b);c===k?(a.Ib(n),a.disable()):(a.enable(),a.Ib(c))};ud.prototype.refresh=function(){G(this.mc,function(a){a()})};function Hd(a){var b=this;this.C=a;this.ua=J({id:"betacreator",children:[{e:"fullsize viewport",create:function(a){b.viewport=a}},{e:"fullsize hitdiv",create:function(a){b.Ya=a}},{e:"bc-gui",create:function(a){b.rc=a}},{create:function(a){b.Kc=a}}]});this.m=this.C.m;this.viewport.appendChild(this.m.view.i);this.jc=new ud;this.rc.appendChild(this.jc.i);this.Tb=new Ic;this.rc.appendChild(this.Tb.i);Rc(N,jd,function(a,d,e,f){b.Tb.show(a,d,e,f)});this.qc=new Vc;this.Kc.appendChild(this.qc.i);Rc(N,Id,
function(a,d){b.qc.show(a,d)})}
Hd.prototype.ba=function(){var a=this;L(this.ua,Oc,function(){N.j(Sc)});L(this.Ya,Oc,function(b){a.m.pa(b)});L(this.Ya,Jd,function(b){a.m.xa(b)});L(this.Ya,Kd,function(b){a.m.ya(b)});L(this.Ya,Ld,function(b){a.m.Xa(b)});L(document,Lc,function(b){b.stopPropagation();if(!a.m.Ka(b)){var c=r;switch(b.keyCode){case 65:N.j(T,U,yd);break;case 66:N.j(T,U,Bd);break;case 76:N.j(T,xd);break;case 80:N.j(T,U,zd);break;case 82:N.j(T,U,Ad);break;case 84:N.j(T,Cd);break;case 86:case 27:N.j(T,wd);break;case 89:if(b.ctrlKey||
b.metaKey)c=m,Md(a.m);break;case 90:if(b.ctrlKey||b.metaKey)if(c=m,b.shiftKey)Md(a.m);else{var d=a.m;if(0!==d.Ra.length){var e=[];G(d.Ra[0],function(a){a=md(a);a!=n&&(a.zb=m,a.yb=r,e.unshift(a),Q(d,a))});d.Ra.shift();d.Na.unshift(e)}}break;case 8:case 46:c=m;a.m.Fa++;G(pd(a.m),function(b){var c=n;b.Dc?(c=Nd(b.d),c.id=b.id,Q(a.m,new P(5,c))):b.p?(c=Od(b.d),c.id=b.id,Q(a.m,new P(6,c))):b.Ec&&(c=Pd(b.d),c.id=b.id,Q(a.m,new P(7,c)))});rd(a.m);a.m.selected=n;N.j(Fd);N.j(V);break;case 189:if(b.ctrlKey||
b.metaKey)c=m,a.m.Mb();break;case 187:if(b.ctrlKey||b.metaKey)c=m,a.m.Lb()}c&&b.preventDefault()}});this.jc.ba()};function Qd(){0!=Rd&&(this.Pc=Error().stack,fa(this))}var Rd=0;function Sd(){Qd.call(this);this.ja=[];this.ob={}}B(Sd,Qd);Sd.prototype.cc=1;Sd.prototype.ib=0;function Rc(a,b,c){var d=a.ob[b];d||(d=a.ob[b]=[]);var e=a.cc;a.ja[e]=b;a.ja[e+1]=c;a.ja[e+2]=k;a.cc=e+3;d.push(e)}
Sd.prototype.j=function(a,b){var c=this.ob[a];if(c){this.ib++;for(var d=Za(arguments,1),e=0,f=c.length;e<f;e++){var g=c[e];this.ja[g+1].apply(this.ja[g+2],d)}this.ib--;if(this.gb&&0==this.ib)for(;c=this.gb.pop();)if(0!=this.ib)this.gb||(this.gb=[]),this.gb.push(c);else if(d=this.ja[c])(d=this.ob[d])&&Ya(d,c),delete this.ja[c],delete this.ja[c+1],delete this.ja[c+2]}};function Td(){}var Ud=0;s=Td.prototype;s.key=0;s.Ea=r;s.Rb=r;s.ba=function(a,b,c,d,e,f){"function"==ca(a)?this.ac=m:a&&a.handleEvent&&"function"==ca(a.handleEvent)?this.ac=r:j(Error("Invalid listener argument"));this.ab=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.Zb=f;this.Rb=r;this.key=++Ud;this.Ea=r};s.handleEvent=function(a){return this.ac?this.ab.call(this.Zb||this.src,a):this.ab.handleEvent.call(this.ab,a)};!C||Ra(9);var Vd=!C||Ra(9),Wd=C&&!E("9");!D||E("528");Fa&&E("1.9b")||C&&E("8")||Ea&&E("9.5")||D&&E("528");Fa&&!E("8")||C&&E("9");var yb="click",Ld="dblclick",Oc="mousedown",Kd="mouseup",Uc="mouseover",Pc="mouseout",Jd="mousemove",Lc="keydown",Kc="blur",Jc="focus",zb="change";function Xd(a,b){this.type=a;this.currentTarget=this.target=b}s=Xd.prototype;s.hb=r;s.defaultPrevented=r;s.Nc=m;s.stopPropagation=function(){this.hb=m};s.preventDefault=function(){this.defaultPrevented=m;this.Nc=r};function Yd(a){Yd[" "](a);return a}Yd[" "]=aa();function Zd(a,b){a&&this.ba(a,b)}B(Zd,Xd);s=Zd.prototype;s.target=n;s.relatedTarget=n;s.offsetX=0;s.offsetY=0;s.clientX=0;s.clientY=0;s.screenX=0;s.screenY=0;s.button=0;s.keyCode=0;s.charCode=0;s.ctrlKey=r;s.altKey=r;s.shiftKey=r;s.metaKey=r;s.Mc=r;s.Ja=n;
s.ba=function(a,b){var c=this.type=a.type;Xd.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Fa){var e;a:{try{Yd(d.nodeName);e=m;break a}catch(f){}e=r}e||(d=n)}}else c==Uc?d=a.fromElement:c==Pc&&(d=a.toElement);this.relatedTarget=d;this.offsetX=D||a.offsetX!==k?a.offsetX:a.layerX;this.offsetY=D||a.offsetY!==k?a.offsetY:a.layerY;this.clientX=a.clientX!==k?a.clientX:a.pageX;this.clientY=a.clientY!==k?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=
a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Mc=za?a.metaKey:a.ctrlKey;this.state=a.state;this.Ja=a;a.defaultPrevented&&this.preventDefault();delete this.hb};s.stopPropagation=function(){Zd.oc.stopPropagation.call(this);this.Ja.stopPropagation?this.Ja.stopPropagation():this.Ja.cancelBubble=m};
s.preventDefault=function(){Zd.oc.preventDefault.call(this);var a=this.Ja;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,Wd)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var $d={},W={},ae={},be={};
function L(a,b,c,d,e){if(b){if(da(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,d,e);return n}var d=!!d,g=W;b in g||(g[b]={ea:0,Ba:0});g=g[b];d in g||(g[d]={ea:0,Ba:0},g.ea++);var g=g[d],h=fa(a),i;g.Ba++;if(g[h]){i=g[h];for(f=0;f<i.length;f++)if(g=i[f],g.ab==c&&g.Zb==e){if(g.Ea)break;return i[f].key}}else i=g[h]=[],g.ea++;var l=ce,p=Vd?function(a){return l.call(p.src,p.key,a)}:function(a){a=l.call(p.src,p.key,a);if(!a)return a},f=p;f.src=a;g=new Td;g.ba(c,f,a,b,d,e);c=g.key;f.key=c;i.push(g);$d[c]=g;
ae[h]||(ae[h]=[]);ae[h].push(g);a.addEventListener?(a==t||!a.xc)&&a.addEventListener(b,f,d):a.attachEvent(b in be?be[b]:be[b]="on"+b,f);return c}j(Error("Invalid event type"))}
function de(a){if($d[a]){var b=$d[a];if(!b.Ea){var c=b.src,d=b.type,e=b.proxy,f=b.capture;c.removeEventListener?(c==t||!c.xc)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in be?be[d]:be[d]="on"+d,e);c=fa(c);ae[c]&&(e=ae[c],Ya(e,b),0==e.length&&delete ae[c]);b.Ea=m;if(b=W[d][f][c])b.hc=m,ee(d,f,c,b);delete $d[a]}}}
function ee(a,b,c,d){if(!d.bb&&d.hc){for(var e=0,f=0;e<d.length;e++)d[e].Ea?d[e].proxy.src=n:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.hc=r;0==f&&(delete W[a][b][c],W[a][b].ea--,0==W[a][b].ea&&(delete W[a][b],W[a].ea--),0==W[a].ea&&delete W[a])}}function fe(a,b,c,d,e){var f=1,b=fa(b);if(a[b]){a.Ba--;a=a[b];a.bb?a.bb++:a.bb=1;try{for(var g=a.length,h=0;h<g;h++){var i=a[h];i&&!i.Ea&&(f&=ge(i,e)!==r)}}finally{a.bb--,ee(c,d,b,a)}}return Boolean(f)}function ge(a,b){a.Rb&&de(a.key);return a.handleEvent(b)}
function ce(a,b){if(!$d[a])return m;var c=$d[a],d=c.type,e=W;if(!(d in e))return m;var e=e[d],f,g;if(!Vd){var h;if(!(h=b))a:{h=["window","event"];for(var i=t;f=h.shift();)if(i[f]!=n)i=i[f];else{h=n;break a}h=i}f=h;h=m in e;i=r in e;if(h){if(0>f.keyCode||f.returnValue!=k)return m;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(p){l=m}if(l||f.returnValue==k)f.returnValue=m}}l=new Zd;l.ba(f,this);f=m;try{if(h){for(var q=[],v=l.currentTarget;v;v=v.parentNode)q.push(v);g=e[m];g.Ba=g.ea;for(var y=
q.length-1;!l.hb&&0<=y&&g.Ba;y--)l.currentTarget=q[y],f&=fe(g,q[y],d,m,l);if(i){g=e[r];g.Ba=g.ea;for(y=0;!l.hb&&y<q.length&&g.Ba;y++)l.currentTarget=q[y],f&=fe(g,q[y],d,r,l)}}else f=ge(c,l)}finally{q&&(q.length=0)}return f}d=new Zd(b,this);return f=ge(c,d)};var yd=1,zd=2,Ad=3,Bd=4;function he(a){if(a)return ie[a]=m,a;a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)});return ie[a]?he():he(a)}var ie={};function je(a,b){a=a||{};this.Dc=m;this.id=he(a.id);this.d={};this.d.it=n;this.d.is=a.scale||b.is;this.d.ic=a.color||b.ic;this.d.ia=a.alpha||b.ia;this.d.lw=a.lineWidth||3;this.d.x=a.x||0;this.d.y=a.y||0;this.d.w=a.f||18;this.d.h=a.k||18;this.d.t=a.text||"";this.type=S(this.d,"it");this.scale=S(this.d,"is");this.color=S(this.d,"ic");this.alpha=S(this.d,"ia");this.lineWidth=S(this.d,"lw");this.x=S(this.d,"x");this.y=S(this.d,"y");this.f=S(this.d,"w");this.k=S(this.d,"h");this.text=S(this.d,"t");this.ka=
"is ic ia x y w h t".split(" ");this.offset=new I(0,0)}s=je.prototype;s.rb=function(){var a={};a.x=this.x()+this.offset.x;a.y=this.y()+this.offset.y;this.offset.x=0;this.offset.y=0;return a};function Nd(a){a=a||{};return{type:a.it,scale:a.is,color:a.ic,alpha:a.ia,lineWidth:a.lw,x:a.x,y:a.y,f:a.w,k:a.h,text:a.t}}s.Hb=function(a){this.offset.x=a.x;this.offset.y=a.y};s.kb=function(){var a={},b;for(b in this.d)a[b]=this.d[b];return a};
s.wb=function(){var a=this,b={};G(this.ka,function(c){b[c]=a.d[c]});return b};s.Gb=function(a){var b=this;G(this.ka,function(c){a[c]!==k&&(b.d[c]=a[c])})};function ke(a,b){a=a||{};a.f||(a.f=10);a.k||(a.k=10);je.call(this,a,b);this.type(yd)}B(ke,je);ke.prototype.ga=function(a,b){var c=this.scale(),d=this.f()*c,e=this.k()*c,c=this.lineWidth()*c/2+6;return bd(new I(a,b),new I(this.x()-d/2,this.y()-e/2),new I(this.x()+d/2,this.y()+e/2))<c||bd(new I(a,b),new I(this.x()+d/2,this.y()-e/2),new I(this.x()-d/2,this.y()+e/2))<c?m:r};function X(a,b){this.canvas=a;this.id=b}s=X.prototype;s.pa=aa();s.xa=aa();s.ya=aa();s.Xa=aa();s.Ka=aa();function le(a,b){X.call(this,a,b);this.tc=this.gc=this.F=n}B(le,X);function me(a){var b=a.canvas;b.offset.x+=b.dc||0;b.offset.y+=b.ec||0;b.dc=0;b.ec=0;de(a.gc);de(a.tc)}s=le.prototype;s.Ma=function(){this.F=n};
s.pa=function(a,b){var c=this,d=m;this.F&&this.ya(a,b);this.F=b;ne(this.canvas.c,function(a){if(a.ga(b.x,b.y,c.canvas.selected==a.id))return c.canvas.selected=a.id,N.j(Fd),N.j(V),d=r,m});if(d){this.canvas.selected=n;N.j(Fd);N.j(V);var e=this;me(this);var f=this.canvas,g=Math.round(f.c.f*f.c.scale),h=Math.round(f.c.k*f.c.scale);f.Ic=-Math.max(f.offset.x+g-f.C.H,0);f.Gc=Math.max(-f.offset.x,0);f.Jc=-Math.max(f.offset.y+h-f.C.J,0);f.Hc=Math.max(-f.offset.y,0);var i=a.clientX,l=a.clientY;this.gc=L(document.body,
Jd,function(a){var b=e.canvas,c=a.clientX-i,a=a.clientY-l,c=H(c,b.Ic,b.Gc),a=H(a,b.Jc,b.Hc);b.dc=c;b.ec=a;b.view.i.style.left=b.offset.x+c+"px";b.view.i.style.top=b.offset.y+a+"px"});this.tc=L(document.body,Kd,function(){me(e)})}};s.xa=function(a,b){var c=this;this.F&&(G(pd(this.canvas),function(a){a.Hb(new I(b.x-c.F.x,b.y-c.F.y))}),N.j(V))};
s.ya=function(a,b){var c=this;if(this.F){var d=b.x-this.F.x,e=b.y-this.F.y;(2<Math.abs(d)||2<Math.abs(e))&&G(pd(this.canvas),function(a){var b=a.rb(new I(d,e));b.id=a.id;Q(c.canvas,new P(4,b))})}this.F=n};
s.Xa=function(a,b){var c=this;ne(this.canvas.c,function(a){if(0==a.type()&&a.ga(b.x,b.y,c.canvas.selected==a.id))return N.j(T,Ed),m;if(a.type()==Bd&&a.ga(b.x,b.y,c.canvas.selected==a.id)){var e=prompt(O("Enter text for the belay:"),a.text());if(e!==n&&e!=a.text()){var f={id:a.id};f.t=e;Q(c.canvas,new P(4,f))}return m}if(5==a.type()&&a.ga(b.x,b.y,c.canvas.selected==a.id))return N.j(Id,function(b){if(b!==n&&b!=a.text()){var e={id:a.id};e.t=b;Q(c.canvas,new P(4,e))}},a.text()),m})};function oe(a,b){a=a||{};a.f||(a.f=12);a.k||(a.k=12);je.call(this,a,b);this.type(zd)}B(oe,je);oe.prototype.ga=function(a,b){var c=this.lineWidth()*this.scale()/2+1,d=this.f()*this.scale(),e=this.k()*this.scale();if(Math.abs(a-this.x())>d/2+c||Math.abs(b-this.y())>e/2+c)return r;d=this.x()-0.1*d;e=this.y()+0.1*e;return a<d-c||a>d+c&&b>e+c?r:m};function pe(a,b,c){this.wa=a;this.uc=6;this.p=m;this.Wa=this.A=this.u=this.overflow=0;this.o=n;this.A=b;this.u=c;this.Wa=this.A+this.u;this.p=m;this.overflow=0;this.o={x:0,y:0}}s=pe.prototype;s.moveTo=function(a,b){Y(this,a,b)};
s.lineTo=function(a,b){var c=a-this.o.x,d=b-this.o.y,e=Math.atan2(d,c),f=Math.cos(e),e=Math.sin(e),c=Xc(0,0,c,d);if(this.overflow){if(this.overflow>c){this.p?qe(this,a,b):Y(this,a,b);this.overflow-=c;return}this.p?qe(this,this.o.x+f*this.overflow,this.o.y+e*this.overflow):Y(this,this.o.x+f*this.overflow,this.o.y+e*this.overflow);c-=this.overflow;this.overflow=0;this.p=!this.p;if(!c)return}if(d=Math.floor(c/this.Wa)){for(var g=f*this.A,h=e*this.A,i=f*this.u,l=e*this.u,p=0;p<d;p++)this.p?(qe(this,this.o.x+
g,this.o.y+h),Y(this,this.o.x+i,this.o.y+l)):(Y(this,this.o.x+i,this.o.y+l),qe(this,this.o.x+g,this.o.y+h));c-=this.Wa*d}this.p?c>this.A?(qe(this,this.o.x+f*this.A,this.o.y+e*this.A),Y(this,a,b),this.overflow=this.u-(c-this.A),this.p=r):(qe(this,a,b),c==this.A?(this.overflow=0,this.p=!this.p):(this.overflow=this.A-c,Y(this,a,b))):c>this.u?(Y(this,this.o.x+f*this.u,this.o.y+e*this.u),qe(this,a,b),this.overflow=this.A-(c-this.u),this.p=m):(Y(this,a,b),c==this.u?(this.overflow=0,this.p=!this.p):this.overflow=
this.u-c)};
s.quadraticCurveTo=function(a,b,c,d){var e=this.o.x,f=this.o.y,g=Yc(e,f,a,b,c,d,this.uc),h=0,i=0,l;if(this.overflow){if(this.overflow>g){this.p?re(this,a,b,c,d):Y(this,c,d);this.overflow-=g;return}h=this.overflow/g;l=$c(e,f,a,b,c,d,h);this.p?re(this,l[2],l[3],l[4],l[5]):Y(this,l[4],l[5]);this.overflow=0;this.p=!this.p;if(!g)return}var p;p=Math.floor((g-g*h)/this.Wa);var q=this.A/g,v=this.u/g;if(p)for(var y=0;y<p;y++)this.p?(i=h+q,l=Zc(e,f,a,b,c,d,h,i),re(this,l[2],l[3],l[4],l[5]),h=i,i=h+v,l=Zc(e,
f,a,b,c,d,h,i),Y(this,l[4],l[5])):(i=h+v,l=Zc(e,f,a,b,c,d,h,i),Y(this,l[4],l[5]),h=i,i=h+q,l=Zc(e,f,a,b,c,d,h,i),re(this,l[2],l[3],l[4],l[5])),h=i;p=g-g*h;this.p?p>this.A?(l=Zc(e,f,a,b,c,d,h,h+q),re(this,l[2],l[3],l[4],l[5]),Y(this,c,d),this.overflow=this.u-(p-this.A),this.p=r):(l=ad(e,f,a,b,c,d,h),re(this,l[2],l[3],l[4],l[5]),g==this.A?(this.overflow=0,this.p=!this.p):(this.overflow=this.A-p,Y(this,c,d))):p>this.u?(i=h+v,l=Zc(e,f,a,b,c,d,h,i),Y(this,l[4],l[5]),l=ad(e,f,a,b,c,d,i),re(this,l[2],l[3],
l[4],l[5]),this.overflow=this.A-(p-this.u),this.p=m):(Y(this,c,d),p==this.u?(this.overflow=0,this.p=!this.p):this.overflow=this.u-p)};s.beginPath=function(){this.wa.beginPath()};s.stroke=function(){this.wa.stroke()};s.clearRect=function(a,b,c,d){this.wa.clearRect(a,b,c,d)};s.Ha=function(){this.o=this.wa=n};function Y(a,b,c){a.o={x:b,y:c};a.wa.moveTo(b,c)}function qe(a,b,c){b==a.o.x&&c==a.o.y||(a.o={x:b,y:c},a.wa.lineTo(b,c))}
function re(a,b,c,d,e){b==d&&c==e&&d==a.o.x&&e==a.o.y||(a.o={x:d,y:e},a.wa.quadraticCurveTo(b,c,d,e))};function se(a,b){a=a||{};this.p=m;this.id=he(a.id);this.d={};this.d.it=0;this.d.is=a.scale||b.is;this.d.ic=a.color||b.ic;this.d.ia=a.alpha||b.ia;this.d.lw=a.lineWidth||3;this.d.cp=a.D||[];this.d.nl=a.A||b.nl;this.d.fl=z(a.u)?a.u:b.fl;this.d.lc=a.Va||b.lc;this.type=S(this.d,"it");this.scale=S(this.d,"is");this.color=S(this.d,"ic");this.alpha=S(this.d,"ia");this.lineWidth=S(this.d,"lw");this.D=S(this.d,"cp");this.A=S(this.d,"nl");this.u=S(this.d,"fl");this.Va=S(this.d,"lc");this.ka="is ic ia lw cp nl fl lc".split(" ");
this.offset=new I(0,0);this.ra=[];te(this)}function ue(a,b,c,d,e,f){var g=[],h=Yc(a,b,c,d,e,f),i=0,l=0,p=Math.floor(h/10),h=10/h;if(p){for(var q=0;q<p;q++)l=i+h,i=Zc(a,b,c,d,e,f,i,l),g.push(new I(i[4],i[5])),i=l;g.push(new I(e,f))}return g}s=se.prototype;s.rb=function(){var a=this,b=[],c={};G(this.D(),function(c){b.push(new I(c.x+a.offset.x,c.y+a.offset.y))});this.offset.x=0;this.offset.y=0;c.cp=b;return c};
function Od(a){var a=a||{},b={type:a.it,scale:a.is,color:a.ic,alpha:a.ia,lineWidth:a.lw,A:a.nl,u:a.fl,Va:a.lc};if(a.cp&&da(a.cp)){var c=[];G(a.cp,function(a){c.push(new I(a.x,a.y))});b.D=c}return b}s.Hb=function(a){this.offset=a};s.kb=function(){var a={},b;for(b in this.d)a[b]=this.d[b];if(a.cp&&da(a.cp)){var c=[];G(a.cp,function(a){c.push({x:a.x,y:a.y})});a.cp=c}return a};s.wb=function(){var a=this,b={};G(this.ka,function(c){b[c]=a.d[c]});return b};
s.Gb=function(a){var b=this;G(this.ka,function(c){a[c]!==k&&(b.d[c]=a[c])})};s.ga=function(a,b){for(var c=this.ra,d=this.lineWidth()*this.scale()/2+6,e=0,f=c.length-1;e<f;e++)if(bd(new I(a,b),c[e],c[e+1])<d)return m;return r};
function te(a){var b=[];if(a.Va()){var c=a.D(),d=c.length;G(c,function(a,f){if(0===f)b.push(new I(a.x,a.y));else{var g=c[f-1];1==f?b.push(new I((a.x+g.x)/2,(a.y+g.y)/2)):b=b.concat(ue(b[b.length-1].x,b[b.length-1].y,g.x,g.y,(a.x+g.x)/2,(a.y+g.y)/2));f==d-1&&b.push(new I(a.x,a.y))}})}else G(a.D(),function(a){b.push(new I(a.x,a.y))});a.ra=b};function ve(a,b,c){X.call(this,a,b);this.ra=[];this.N=this.B=this.La=n;this.vc=c}B(ve,X);ve.prototype.pa=function(a,b){this.B&&this.B.D(we(this));this.ra.push(new I(b.x,b.y));if(this.B){var c={id:this.B.id};c.cp=we(this);Q(this.canvas,new P(4,c))}else 1<this.ra.length?(xe(this),c=new P(2,{D:we(this)}),Q(this.canvas,c),this.B=this.canvas.c.getItem(c.q.id)):(this.La=new I(b.x,b.y),this.N=this.vc,this.N.D(we(this,this.La)),this.N.A(this.canvas.c.d.nl),this.N.u(this.canvas.c.d.fl),N.j(V))};
ve.prototype.xa=function(a,b){var c=this.B||this.N;c&&(this.La=new I(b.x,b.y),c.D(we(this,this.La)),te(c),N.j(V))};ve.prototype.Ka=function(a){if(13==a.keyCode&&this.B)return this.Ma(),m};ve.prototype.Ma=function(){this.B&&(this.B.D(we(this)),te(this.B),N.j(V));this.ra=[];this.B=this.La=n;xe(this)};function we(a,b){return b?a.ra.concat([b]):a.ra.concat([])}function xe(a){a.N&&a.N.D([new I(0,0)]);a.N=n};function ye(a,b){a=a||{};a.lineWidth||(a.lineWidth=2);je.call(this,a,b);this.type(Bd)}B(ye,je);ye.prototype.ga=function(a,b){var c=this.lineWidth()*this.scale()/2+1;return $a(new I(a,b),new I(this.x(),this.y()))<=this.f()*this.scale()/2+c?m:r};function Z(a){this.c=a;this.padding=this.ma=10;this.S=this.R=n;this.canvas=document.createElement("CANVAS");this.canvas.width=this.c.f()+2*this.padding;this.canvas.height=this.c.k()+2*this.padding;this.canvas.style.position="absolute"}Z.prototype.M=aa();
Z.prototype.Sa=function(a){var a=a||1,b=a*this.c.scale(),c=Math.round(b*this.c.f())+2*this.padding,b=Math.round(b*this.c.k())+2*this.padding;this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c/2)+"px";this.canvas.style.top=Math.round(a*(this.c.y()+this.c.offset.y)-b/2)+"px"};
Z.prototype.ha=function(a,b){var a=a||1,c=a*this.c.scale(),d={f:this.c.f(),k:this.c.k(),color:this.c.color(),alpha:this.c.alpha(),scale:c,selected:b,text:this.c.text()},e={x:this.c.x(),y:this.c.y(),f:this.c.f(),k:this.c.k(),Wb:this.c.offset.x,Xb:this.c.offset.y,scale:c};if(!ld(d,this.R)){this.padding=this.ma*Math.max(1,c);this.R=d;var d=this.canvas.getContext("2d"),f=Math.round(c*this.c.f())+2*this.padding,g=Math.round(c*this.c.k())+2*this.padding;d.canvas.width=f;d.canvas.height=g;d.clearRect(0,
0,f,g);d.save();d.translate(this.padding,this.padding);d.scale(c,c);d.lineCap="round";b&&(d.save(),this.M(d,"rgba(255,0,0,0.75)",this.c.lineWidth()+4/c),d.restore());d.save();this.M(d,Cc(this.c.color()),this.c.lineWidth()+2/c);d.restore();this.M(d);d.restore()}ld(e,this.S)||(this.S=e,this.Sa(a))};Z.prototype.Ha=function(){this.S=this.R=this.c=n;nb(this.canvas);this.canvas=n};function ze(a,b){a=a||{};a.lineWidth||(a.lineWidth=2);je.call(this,a,b);this.type(Ad)}B(ze,je);ze.prototype.ga=function(a,b){var c=this.lineWidth()*this.scale()/2+1;return $a(new I(a,b),new I(this.x(),this.y()))<=this.f()*this.scale()/2+c?m:r};function Ae(a){Z.call(this,a);this.c=a}B(Ae,Z);Ae.prototype.M=function(a,b,c){a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();var b=this.c.f(),c=this.c.k(),d=Math.min(this.c.f(),this.c.k())/2;a.moveTo(b/2+d*Math.cos(0),c/2+d*Math.sin(0));a.arc(b/2,c/2,d,0,2*Math.PI,r);a.moveTo(b/2,0.25*c);a.lineTo(b/2,0.75*c);a.moveTo(0.25*b,c/2);a.lineTo(b/2,0.75*c);a.lineTo(0.75*b,c/2);a.stroke()};function Be(a){Z.call(this,a);this.c=a}B(Be,Z);Be.prototype.M=function(a,b,c){var d=this.c.f(),e=this.c.k(),f=0.3*e;a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(0.4*d,e);a.lineTo(0.4*d,0);a.lineTo(d-f,0);a.arc(d-f,f,f,-Math.PI/2,Math.PI/2,r);a.lineTo(0.4*d,2*f);a.stroke()};function Ce(a,b){a=a||{};this.Ec=m;this.id=he(a.id);this.d={};this.d.it=5;this.d.is=a.scale||b.is;this.d.ic=a.color||b.ic;this.d.ia=a.alpha||b.ia;this.d.x=a.x||0;this.d.y=a.y||0;this.d.t=a.text||"";this.d.ta=a.textAlign||b.ta;this.d.tb=a.sa||b.tb;this.type=S(this.d,"it");this.scale=S(this.d,"is");this.color=S(this.d,"ic");this.alpha=S(this.d,"ia");this.x=S(this.d,"x");this.y=S(this.d,"y");this.text=S(this.d,"t");this.textAlign=S(this.d,"ta");this.sa=S(this.d,"tb");this.ka="is ic ia x y t ta tb".split(" ");
this.offset=new I(0,0);this.Q=n;this.Ob=0;this.L=[]}s=Ce.prototype;s.rb=function(){var a={};a.x=this.x()+this.offset.x;a.y=this.y()+this.offset.y;this.offset.x=0;this.offset.y=0;return a};function Pd(a){a=a||{};return{type:a.it,scale:a.is,color:a.ic,alpha:a.ia,x:a.x,y:a.y,text:a.t,textAlign:a.ta,sa:a.tb}}s.Hb=function(a){this.offset.x=a.x;this.offset.y=a.y};s.kb=function(){var a={},b;for(b in this.d)a[b]=this.d[b];return a};s.wb=function(){var a=this,b={};G(this.ka,function(c){b[c]=a.d[c]});return b};
s.Gb=function(a){var b=this;G(this.ka,function(c){a[c]!==k&&(b.d[c]=a[c])})};
s.ga=function(a,b,c){if(!this.Q)return r;var d=this.scale(),e=this.textAlign(),f=new Wc(this.x(),this.y(),this.Q.x*this.scale(),this.Q.y*this.scale()),g=this.sa()||c?this.Ob:0;"c"==e?f.x-=f.f/2:"r"==e&&(f.x-=f.f);if(Math.abs(a-f.x-f.f/2)>f.f/2+g||Math.abs(b-f.y-f.k/2)>f.k/2+g)return r;if(this.sa()||c)return m;for(var g=c=0,h=this.L.length;g<h;g++)if(c=this.L[g].width*d,-1<c&&a>=f.x+("c"==e?f.f/2-c/2:"r"==e?f.f-c:0)&&a<=f.x+("c"==e?f.f/2+c/2:"r"==e?f.f:c)&&b>=f.y+this.L[g].top*d&&b<=f.y+(g+1<h?this.L[g+
1].top:this.L[g].top+this.L[g].size)*d)return m;return r};function Fe(a){this.c=a;this.padding=this.ma=15;this.Q=this.S=this.R=n;this.canvas=document.createElement("CANVAS");this.canvas.style.position="absolute"}
Fe.prototype.M=function(a,b,c){var d,e,f,g=b===k;switch(this.c.textAlign()){case "c":a.textAlign="center";break;case "r":a.textAlign="right";break;default:a.textAlign="left"}a.textBaseline="top";a.fillStyle=this.c.color();a.strokeStyle=b||this.c.color();a.lineWidth=c||0;G(this.c.L,function(b){if(d!=b.size||e!=b.bold||f!=b.Za)d=b.size,e=b.bold,f=b.Za,a.font=Ge(b.Za,b.bold,b.size);g?a.fillText(b.text,0,b.top):a.strokeText(b.text,0,b.top)})};
function Ge(a,b,c){var d="";a&&(d+="italic ");b&&(d+="bold ");return d+c+"px Arial, Helvetica, sans-serif"}
Fe.prototype.Sa=function(a){var a=a||1,b=a*this.c.scale(),c=Math.round(b*this.Q.x)+2*this.padding;Math.round(b*this.Q.y);switch(this.c.textAlign()){case "c":this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c/2)+"px";break;case "r":this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-c+this.padding)+"px";break;default:this.canvas.style.left=Math.round(a*(this.c.x()+this.c.offset.x)-this.padding)+"px"}this.canvas.style.top=Math.round(a*(this.c.y()+this.c.offset.y)-this.padding)+
"px"};
Fe.prototype.ha=function(a,b){var a=a||1,c=a*this.c.scale(),d={color:this.c.color(),alpha:this.c.alpha(),scale:c,selected:b,text:this.c.text(),textAlign:this.c.textAlign(),sa:this.c.sa()},e={x:this.c.x(),y:this.c.y(),Wb:this.c.offset.x,Xb:this.c.offset.y,scale:c,textAlign:this.c.textAlign()};if(!ld(d,this.R)){this.padding=this.ma*Math.max(1,c);this.R=d;var f=this.canvas.getContext("2d"),d=this.c,g=d.text().replace(/[\s\xa0]+$/,"").replace(/\n\r/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ").split("\n"),h=
0,i=[];G(g,function(a){i.push({text:a,top:h,size:12,width:-1,bold:r,Za:r});h+=18});d.L=i;var l=0;f.save();G(this.c.L,function(a){f.font=Ge(a.Za,a.bold,a.size);a.width=f.measureText(a.text).width;l=Math.min(2048,Math.max(a.width,l))});f.restore();this.Q=new I(l,this.c.L[this.c.L.length-1].top+this.c.L[this.c.L.length-1].size);d=this.c;g=this.padding;d.Q=this.Q;d.Ob=g;d=Math.round(c*this.Q.x)+2*this.padding;g=Math.round(c*this.Q.y)+2*this.padding;f.canvas.width=d;f.canvas.height=g;f.clearRect(0,0,d,
g);f.save();this.c.sa()&&(f.save(),f.fillStyle=Cc(this.c.color()),f.fillRect(0,0,d,g),f.restore());b&&(f.save(),f.strokeStyle="rgba(255,0,0,0.75)",f.lineWidth=1,f.strokeRect(0.5,0.5,d-1,g-1),f.restore());switch(this.c.textAlign()){case "c":f.translate(d/2,this.padding);break;case "r":f.translate(d-this.padding,this.padding);break;default:f.translate(this.padding,this.padding)}f.scale(c,c);f.lineCap="round";this.c.sa()||(f.save(),this.M(f,Cc(this.c.color()),2/c),f.restore());this.M(f);f.restore()}ld(e,
this.S)||(this.S=e,this.Sa(a))};Fe.prototype.Ha=function(){this.S=this.R=this.c=n;nb(this.canvas);this.canvas=n};function He(a){Z.call(this,a);this.c=a}B(He,Z);
He.prototype.M=function(a,b,c){var d=b===k,e=this.c.f(),f=this.c.k(),g=Math.min(e,f)/2;a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(e/2+g*Math.cos(0),f/2+g*Math.sin(0));a.arc(e/2,f/2,g,0,2*Math.PI,r);a.stroke();this.c.text()&&(a.font="12px Arial, Helvetica, sans-serif",a.textAlign="center",a.textBaseline="middle",d?(a.fillStyle=this.c.color(),a.fillText(this.c.text(),e/2,f/2)):(a.strokeStyle=b||this.c.color(),a.lineWidth=Math.min(2,(c||this.c.lineWidth())-
this.c.lineWidth()),a.strokeText(this.c.text(),e/2,f/2)))};function Ie(a,b){this.va=a;this.zc=b;this.k=b.height;this.f=b.width;this.scale=1;this.G=[0.125,1/6,0.25,1/3,0.5,2/3,1,2,3,4,5,6,7,8,12,16];this.K=[];this.d={};this.d.is=1;this.d.ic="#ffff00";this.d.ia=1;this.d.nl=10;this.d.fl=10;this.d.lc=r;this.d.ta="l";this.d.tb=r;this.N=new se({D:[new I(0,0)]},this.d);this.K.push(this.N)}Ie.prototype.removeItem=function(a){Ya(this.K,a)};
Ie.prototype.getItem=function(a){var b=this.K,c;a:{c=function(b){return b.id==a};for(var d=b.length,e=u(b)?b.split(""):b,f=0;f<d;f++)if(f in e&&c.call(k,e[f])){c=f;break a}c=-1}return 0>c?n:u(b)?b.charAt(c):b[c]};function ne(a,b){for(var c=a.K.length-1;0<=c&&!(a.K[c]!=a.N&&b(a.K[c])===m);c--);}
Ie.prototype.Mb=function(){for(var a=0,b=this.G.length;a<b;a++)if(1E-6>=Math.abs(this.G[a]-this.scale)){this.scale=this.G[H(a-1,0,b-1)];break}else if(this.scale>this.G[a]&&(!this.G[a+1]||this.scale<this.G[a+1])){this.scale=this.G[a];break}};Ie.prototype.Lb=function(){for(var a=0,b=this.G.length;a<b;a++)if(1E-6>=Math.abs(this.G[a]-this.scale)){this.scale=this.G[H(a+1,0,b-1)];break}else if(this.scale>this.G[a]&&this.G[a+1]&&this.scale<this.G[a+1]){this.scale=this.G[a+1];break}};function Je(a){Z.call(this,a);this.c=a}B(Je,Z);Je.prototype.M=function(a,b,c){a.strokeStyle=b||this.c.color();a.lineWidth=c||this.c.lineWidth();a.beginPath();a.moveTo(0,0);a.lineTo(this.c.f(),this.c.k());a.moveTo(this.c.f(),0);a.lineTo(0,this.c.k());a.stroke()};function Ke(a){this.c=a;this.padding=this.ma=10;this.S=this.R=n;this.canvas=document.createElement("canvas");this.canvas.width=2*this.padding;this.canvas.height=2*this.padding;this.canvas.style.position="absolute"}
function Le(a,b,c,d){var e=a.c.scale(),f=0<a.c.u();b.strokeStyle=c||a.c.color();b.lineWidth=d||a.c.lineWidth()*e;var g=f?new pe(b,a.c.A()*e,a.c.u()*e):b;g.beginPath();if(a.c.Va()){var h=a.c.D(),i=h.length;G(h,function(a,b){if(0===b)g.moveTo(a.x,a.y);else{var c=h[b-1];1==b?g.lineTo((a.x+c.x)/2,(a.y+c.y)/2):g.quadraticCurveTo(c.x,c.y,(a.x+c.x)/2,(a.y+c.y)/2);b==i-1&&g.lineTo(a.x,a.y)}})}else G(a.c.D(),function(a,b){0===b?g.moveTo(a.x,a.y):g.lineTo(a.x,a.y)});g.stroke();f&&g.Ha()}
Ke.prototype.M=function(a,b,c){var d=this.c.scale();a.save();a.lineCap="round";c?(a.save(),Le(this,a,"rgba(255,0,0,0.75)",this.c.lineWidth()*d+4/b)):(a.save(),Le(this,a,Cc(this.c.color()),this.c.lineWidth()*d+2/b));a.restore();Le(this,a);a.restore()};Ke.prototype.Sa=function(a){a=a||1;this.canvas.style.left=Math.round(a*(this.c.offset.x+this.c.P.x)-this.padding)+"px";this.canvas.style.top=Math.round(a*(this.c.offset.y+this.c.P.y)-this.padding)+"px"};
Ke.prototype.ha=function(a,b,c){var a=a||1,d=this.c.kb();d.scale=a;d.selected=!!b;d.mode=c||n;if(!ld(d,this.R)){this.padding=this.ma*Math.max(1,this.c.scale()*a);this.R=d;d=this.c;if(0===d.D().length)d.P=n;else{var e=Number.MAX_VALUE,f=-Number.MAX_VALUE,g=Number.MAX_VALUE,h=-Number.MAX_VALUE;G(d.D(),function(a){e=Math.min(e,a.x);f=Math.max(f,a.x);g=Math.min(g,a.y);h=Math.max(h,a.y)});d.P=new Wc(e,g,f-e,h-g)}te(this.c);var i=this.canvas.getContext("2d"),d=Math.round(a*this.c.P.f)+2*this.padding,l=
Math.round(a*this.c.P.k)+2*this.padding;i.canvas.width=d;i.canvas.height=l;i.clearRect(0,0,d,l);i.save();i.translate(this.padding-Math.round(a*this.c.P.x),this.padding-Math.round(a*this.c.P.y));i.scale(a,a);this.M(i,a,b);if(b&&c==Ed){var p=a,p=p||1,q=this.c.color(),v=Cc(q),y=7/p;i.save();G(this.c.D(),function(a){i.beginPath();i.moveTo(a.x+y,a.y);i.arc(a.x,a.y,y,0,2*Math.PI,r);i.strokeStyle=v;i.lineWidth=6/p;i.stroke();i.strokeStyle=q;i.lineWidth=4/p;i.stroke()});i.restore()}i.restore()}b={Wb:this.c.offset.x,
Xb:this.c.offset.y,x:this.c.P.x,y:this.c.P.y,f:this.c.P.f,k:this.c.P.k,scale:a*this.c.scale()};ld(b,this.S)||(this.S=b,this.Sa(a))};Ke.prototype.Ha=function(){this.S=this.R=this.c=n;nb(this.canvas);this.canvas=n};function Me(a,b){this.va=a;this.c=b;this.Fb=1;this.Bb=m;this.cb=r;this.i=mb("DIV","canvas-container");this.i.appendChild(this.c.zc);this.bc=mb("DIV","fullsize");this.i.appendChild(this.bc);this.Ta={};setInterval(A(this.Sb,this),10);Rc(N,V,A(this.Bc,this))}Me.prototype.Bc=function(a){this.Bb=m;a&&this.Sb()};Me.prototype.Sb=function(){this.Bb&&this.ha(this.c.scale);this.Bb=r};
Me.prototype.ha=function(a){for(var b={},c=0,d=this.c.K.length;c<d;c++){a:{var e=this.c.K[c],f=a,f=f||1,g=this.Ta[e.id];if(!g){switch(e.type()){case yd:g=new Je(e);break;case zd:g=new Be(e);break;case Ad:g=new Ae(e);break;case Bd:g=new He(e);break;case 5:g=new Fe(e);break;case 0:g=new Ke(e)}if(!g)break a;this.Ta[e.id]=g;this.bc.appendChild(g.canvas)}g.ha(f,this.va.selected==e.id,this.va.mode.id)}b[this.c.K[c].id]=m}for(var h in this.Ta)b[h]||(this.Ta[h].Ha(),delete this.Ta[h]);if(this.c.scale!=this.Fb||
this.cb)pb(this.i,{width:Math.round(this.c.scale*this.c.f)+"px",height:Math.round(this.c.scale*this.c.k)+"px"}),this.cb?(a=this.va,a.offset.x=Math.round(a.C.H/2-a.c.f*a.c.scale/2),a.offset.y=Math.round(a.C.J/2-a.c.k*a.c.scale/2),this.cb=r):(a=this.va,b=this.c.scale/this.Fb,c=b*(a.C.J/2-a.offset.y),d=a.c.f*a.c.scale,e=a.c.k*a.c.scale,a.offset.x=-Math.round(b*(a.C.H/2-a.offset.x)-a.C.H/2),a.offset.y=-Math.round(c-a.C.J/2),a.offset.x=d<=a.C.H?Math.round(a.C.H/2-d/2):H(a.offset.x,a.C.H-d,0),a.offset.y=
e<=a.C.J?Math.round(a.C.J/2-e/2):H(a.offset.y,a.C.J-e,0)),this.i.style.left=this.va.offset.x+"px",this.i.style.top=this.va.offset.y+"px";this.Fb=this.c.scale};function Ne(a,b){X.call(this,a,b);this.za=this.Z=this.B=this.F=n}B(Ne,X);s=Ne.prototype;s.Db=function(){var a=this;Xa(pd(this.canvas),function(b){return 0==b.type()?(a.B=b,N.j(V),m):r})};s.Ma=function(){this.za=this.Z=this.B=this.F=n;N.j(V)};s.pa=function(a,b){this.F&&this.ya(a,b);if(this.B){var c=this;Xa(this.B.D(),function(a){var e=b.x-a.x,f=b.y-a.y;return 100>e*e+f*f?(c.Z=a,c.za=a.clone(),m):r});this.Z?this.F=b:N.j(T,wd)}};
s.xa=function(a,b){this.F&&(this.B&&this.Z)&&(this.Z.x=this.za.x+b.x-this.F.x,this.Z.y=this.za.y+b.y-this.F.y,te(this.B),N.j(V))};s.ya=function(a,b){this.xa(a,b);if(this.F&&this.B&&this.Z){var c=[];G(this.B.D(),function(a){c.push(a.clone())});this.Z.x=this.za.x;this.Z.y=this.za.y;var d={id:this.B.id};d.cp=c;Q(this.canvas,new P(4,d))}this.za=this.Z=this.F=n};s.Ka=function(a){if(13==a.keyCode)return N.j(T,wd),m};function Oe(a,b){X.call(this,a,b);this.Ca=n}B(Oe,X);Oe.prototype.Db=function(a){this.Ca=z(a)?a:n};Oe.prototype.pa=function(a,b){this.Ca!==n&&Q(this.canvas,new P(1,{type:this.Ca,x:b.x,y:b.y}))};function Pe(a,b){X.call(this,a,b)}B(Pe,X);Pe.prototype.pa=function(a,b){var c=this;N.j(Id,function(a){a&&Q(c.canvas,new P(3,{text:a,x:b.x,y:b.y}))},O("Enter some text"))};function Qe(a,b){var c=this;this.C=a;this.c=new Ie(this,b);this.view=new Me(this,this.c);this.offset=new I;this.selected=n;nd=this;this.oa={};this.oa[wd]=new le(this,wd);this.oa[xd]=new ve(this,xd,this.c.N);this.oa[U]=new Oe(this,U);this.oa[Cd]=new Pe(this,Cd);this.oa[Ed]=new Ne(this,Ed);var d=n;Rc(N,T,function(a,b){if(c.oa[a]){var g=c.mode!=c.oa[a]||d!=b;g&&(c.mode&&c.mode.Ma)&&c.mode.Ma();c.mode=c.oa[a];g&&c.mode.Db&&c.mode.Db(b);d=b}});this.mode=n;this.Ra=[];this.Na=[];this.Fa=0;this.pb=[];setInterval(function(){rd(c)},
100)}function rd(a){a.Fa=Math.max(0,a.Fa-1);0==a.Fa&&0<a.pb.length&&(a.Ra.unshift(a.pb),a.Na=[],a.pb=[])}function Te(a,b){var c=b.clientX,d=b.clientY,e=ub(a.C.fa.viewport);return new I(Math.round((c-e.x-a.offset.x)/a.c.scale),Math.round((d-e.y-a.offset.y)/a.c.scale))}function Md(a){if(0!==a.Na.length){var b=[];G(a.Na[0],function(c){c=md(c);c!=n&&(c.yb=m,c.zb=r,b.unshift(c),Q(a,c))});a.Na.shift();a.Ra.unshift(b)}}
function Q(a,b){var c;switch(b.type){case 1:switch(b.q.type){case yd:c=new ke(b.q,a.c.d);break;case zd:c=new oe(b.q,a.c.d);break;case Ad:c=new ze(b.q,a.c.d);break;case Bd:c=new ye(b.q,a.c.d)}if(c)b.q.id=c.id,a.c.K.push(c);else return;break;case 2:if(b.q.D&&1<b.q.D.length)c=new se(b.q,a.c.d),b.q.id=c.id,a.c.K.push(c);else return;break;case 3:if(b.q.text)c=new Ce(b.q,a.c.d),b.q.id=c.id,a.c.K.push(c);else return;break;case 4:if(c=a.c.getItem(b.q.id)){if(!b.Cb){var d=c.wb(),e={id:b.q.id},f;for(f in b.q)d[f]!==
k&&(e[f]=d[f]);b.Cb=e}c.Gb(b.q)}else return;break;case 5:case 7:case 6:if(c=a.c.getItem(b.q.id))a.c.removeItem(c);else return;break;default:return}a.Fa++;!b.zb&&!b.yb&&a.pb.unshift(b);rd(a);N.j(V);N.j(Gd)}function pd(a){return!a.selected?[]:(a=a.c.getItem(a.selected))?[a]:[]}s=Qe.prototype;s.pa=function(a){this.mode.pa(a,Te(this,a))};s.xa=function(a){this.mode.xa(a,Te(this,a))};s.ya=function(a){this.mode.ya(a,Te(this,a))};s.Xa=function(a){this.mode.Xa(a,Te(this,a))};s.Ka=function(a){return this.mode.Ka(a)};
s.Mb=function(){N.j(V);this.c.Mb()};s.Lb=function(){N.j(V);this.c.Lb()};function Ue(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}j(Error("Invalid JSON string: "+a))}function Ve(a){this.jb=a}Ve.prototype.serialize=function(a){var b=[];We(this,a,b);return b.join("")};
function We(a,b,c){switch(typeof b){case "string":Xe(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==n){c.push("null");break}if(da(b)){a.serializeArray(b,c);break}c.push("{");var d="",e;for(e in b)if(Object.prototype.hasOwnProperty.call(b,e)){var f=b[e];"function"!=typeof f&&(c.push(d),Xe(e,c),c.push(":"),We(a,a.jb?a.jb.call(b,e,f):f,c),d=",")}c.push("}");break;case "function":break;default:j(Error("Unknown type: "+
typeof b))}}var Ye={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Ze=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function Xe(a,b){b.push('"',a.replace(Ze,function(a){if(a in Ye)return Ye[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Ye[a]=e+b.toString(16)}),'"')}
Ve.prototype.serializeArray=function(a,b){var c=a.length;b.push("[");for(var d="",e=0;e<c;e++)b.push(d),d=a[e],We(this,this.jb?this.jb.call(a,String(e),d):d,b),d=",";b.push("]")};function $e(a,b){var c=this,b=b||{};this.q={f:b.width||n,k:b.height||n,zoom:b.zoom||"contain",parent:b.parent||n,qa:b.onChange||n};this.minWidth=556;this.lb=a;var d=document.createElement("img");this.Ac=L(d,"load",function(){c.ba(d)});d.src=this.lb.src;b.qa&&Rc(N,Gd,function(){b.qa()})}
$e.prototype.ba=function(a){de(this.Ac);this.m=new Qe(this,a);this.fa=new Hd(this);this.H=this.q.f||a.width;this.J=this.q.k||a.height;z(this.H)&&this.H<this.minWidth&&(this.H=this.minWidth);pb(this.fa.ua,{position:"relative",display:"inherit"==this.lb.style.display?"inline-block":this.lb.style.display||"inline-block",width:z(this.H)?this.H+"px":this.H,height:z(this.J)?this.J+29+"px":this.J});if(this.q.parent)this.q.parent.appendChild(this.fa.ua);else{var a=this.lb,b=a.parentNode;b&&b.replaceChild(this.fa.ua,
a)}z(this.H)||(this.H=(new ab(this.fa.ua.offsetWidth,this.fa.ua.offsetHeight)).width-2);z(this.J)||(this.J=(new ab(this.fa.ua.offsetWidth,this.fa.ua.offsetHeight)).height-29-2);this.fa.ba();b=this.m;a=this.q.zoom;a=z(a)?a/100:"cover"==a?Math.max(b.C.H/b.c.f,b.C.J/b.c.k):Math.min(b.C.H/b.c.f,b.C.J/b.c.k);b=b.c;b.scale=H(a,b.G[0],b.G[b.G.length-1]);N.j(V);this.m.view.cb=m};
$e.prototype.Fc=function(a){var b=this;ne(this.m.c,function(a){b.m.c.removeItem(a)});G(a.items||[],function(a){var d=n;switch(a.it){case yd:d=new ke(Nd(a),b.m.c.d);break;case zd:d=new oe(Nd(a),b.m.c.d);break;case Ad:d=new ze(Nd(a),b.m.c.d);break;case Bd:d=new ye(Nd(a),b.m.c.d);break;case 0:d=new se(Od(a),b.m.c.d);break;case 5:d=new Ce(Pd(a),b.m.c.d)}d&&b.m.c.K.push(d)});N.j(V)};
$e.prototype.getData=function(a){var b=[];ne(this.m.c,function(a){b.push(a.kb())});if(a){a=(new Ve(k)).serialize({items:b});a=String(a);if(a.quote)a=a.quote();else{for(var c=['"'],d=0;d<a.length;d++){var e=a.charAt(d),f=e.charCodeAt(0),g=c,h=d+1,i;if(!(i=ta[e])){if(!(31<f&&127>f))if(e in ua)e=ua[e];else if(e in ta)e=ua[e]=ta[e];else{f=e;i=e.charCodeAt(0);if(31<i&&127>i)f=e;else{if(256>i){if(f="\\x",16>i||256<i)f+="0"}else f="\\u",4096>i&&(f+="0");f+=i.toString(16).toUpperCase()}e=ua[e]=f}i=e}g[h]=
i}c.push('"');a=c.join("")}a:for(c=0;1>c;c++)if('"'==a.charAt(0)&&'"'==a.charAt(a.length-1)){a=a.substring(1,a.length-1);break a}}else a=(new Ve(k)).serialize({items:b});return a};$e.prototype.yc=function(){return""};var N=new Sd,V="cr",Fd="sc",jd="scp",Id="sta",Sc="ho",T="m",Gd="a",wd=0,xd=1,U=2,Cd=3,Ed=4;
ba("BetaCreator",function(a,b){var c=new $e(a,b),d=b.onError||function(a){alert(a)};return{loadData:function(a){try{a=Ue(a),c.Fc(a)}catch(b){d(O("Invalid data."))}},getData:function(a){return c.getData(a)},getImage:function(a){return c.yc(a)}}});})();
